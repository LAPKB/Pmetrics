<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Plots PMsim objects with the option to perform a visual and numerical predictive check"><title>Plot Pmetrics Simulation Objects — plot.PMsim • Pmetrics</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Plot Pmetrics Simulation Objects — plot.PMsim"><meta property="og:description" content="Plots PMsim objects with the option to perform a visual and numerical predictive check"><meta property="og:image" content="https://lapkb.github.io/Pmetrics/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">Pmetrics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/pmetrics.html">Start Here</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/intro.html">Introduction</a>
    <a class="dropdown-item" href="../articles/overview.html">Overview</a>
    <a class="dropdown-item" href="../articles/workflow.html">Workflow</a>
    <a class="dropdown-item" href="../articles/data.html">Data Inputs</a>
    <a class="dropdown-item" href="../articles/models.html">Model Inputs</a>
    <a class="dropdown-item" href="../articles/simulation.html">Simulation</a>
    <a class="dropdown-item" href="../articles/plotly.html">Plotly plots</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/LAPKB/Pmetrics/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plot Pmetrics Simulation Objects</h1>
      <small class="dont-index">Source: <a href="https://github.com/LAPKB/Pmetrics/blob/HEAD/R/plotPMsim.R" class="external-link"><code>R/plotPMsim.R</code></a></small>
      <div class="d-none name"><code>plot.PMsim.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plots <em>PMsim</em> objects with the option to perform a visual and numerical predictive check</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for PMsim</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  mult <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  log <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  binSize <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  outeq <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pch <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  join <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  x.qlab <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>  cex.qlab <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  pos.qlab <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  ci <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  cex.lab <span class="op">=</span> <span class="fl">1.2</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Time (h)"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Output"</span>,</span>
<span>  <span class="va">xlim</span>,</span>
<span>  <span class="va">ylim</span>,</span>
<span>  <span class="va">obs</span>,</span>
<span>  <span class="va">grid</span>,</span>
<span>  ocol <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>  add <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  out <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>The name of an <em>PMsim</em> data object generated by <code><a href="SIMparse.html">SIMparse</a></code></p></dd>


<dt>mult</dt>
<dd><p>Multiplication factor for y axis, e.g. to convert mg/L to ng/mL</p></dd>


<dt>log</dt>
<dd><p>Boolean operator to plot in log-log space; the default is <code>False</code></p></dd>


<dt>probs</dt>
<dd><p>Vector of quantiles to plot; if set to <code>NA</code>, all simulated profiles will be plotted,
and numerical predictive checking will be suppressed</p></dd>


<dt>binSize</dt>
<dd><p>Width of binning interval for simulated concentrations, in time units, e.g. hours.  For example,
a <code>binSize</code> of 0.5 will pull all simulated concentrations +/- 0.5 hours into the same time.  This is useful
for plotting PMsim objects made during <code><a href="makeValid.html">makeValid</a></code>. The default is 0, i.e. no binning.</p></dd>


<dt>outeq</dt>
<dd><p>Which output equation to plot if more than 1</p></dd>


<dt>pch</dt>
<dd><p>Controls the plotting symbol for observations; default is NA which results in no symbol.
Use 0 for open square, 1 for open circle, 2 for open triangle, 3 for cross, 4 for X, or 5 for a diamond.
Other alternatives are “*” for asterisks, “.” for tiny dots, or “+” for a smaller,
bolder cross.  These plotting symbols are standard for R (see <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>).</p></dd>


<dt>join</dt>
<dd><p>Boolean operator to join observations by a straight line; the default is <code>True</code>.</p></dd>


<dt>x.qlab</dt>
<dd><p>Proportionate value of x-axis at which to draw the quantile labels; 0 is left, 1 is right.
The default is 0.4.</p></dd>


<dt>cex.qlab</dt>
<dd><p>Size of the quantile labels.</p></dd>


<dt>pos.qlab</dt>
<dd><p>This allows more refined positioning of the quantile labels.  It takes standard R
values: 1, below; 2, left; 3, above; 4, right.</p></dd>


<dt>ci</dt>
<dd><p>Width of confidence interval bands around simulated quantiles, from 0 to 1.  If 0, or <em>nsim</em>&lt;100, will not plot.
Default is 0.95, i.e. 95th percentile with tails of 2.5 percent above and below excluded.</p></dd>


<dt>cex.lab</dt>
<dd><p>Size of the plot labels.</p></dd>


<dt>xlab</dt>
<dd><p>Label for x-axis; default is “Time”</p></dd>


<dt>ylab</dt>
<dd><p>Label for y-axis; default is “Output”</p></dd>


<dt>xlim</dt>
<dd><p>Limits of the x-axis as a vector, e.g. <code>c(0,1)</code>.  It does not need to be specified, but can be.</p></dd>


<dt>ylim</dt>
<dd><p>Analogous to <code>xlim</code></p></dd>


<dt>obs</dt>
<dd><p>The name of an <em>makeOP</em> data object generated by <code><a href="makeOP.html">makeOP</a></code>.  If specified,
the observations will be overlaid upon the simulation plot enabling a visual predicitve check.  In this case,
a list object will be returned with two items: $npc containing the quantiles and probability that the observations
are below each quantile (binomial test); and $simsum, the times of each observation and the
value of the simulated quantile with upper and lower confidence intervals at that time.</p></dd>


<dt>grid</dt>
<dd><p>Either a boolean operator to plot a reference grid, or a list with elements x and y,
each of which is a vector specifying the native coordinates to plot grid lines; the default is <code>False</code>.
For example, grid=list(x=seq(0,24,2),y=1:10).  Defaults for missing x or y will be calculated by <code><a href="https://rdrr.io/r/graphics/axTicks.html" class="external-link">axTicks</a></code>.</p></dd>


<dt>ocol</dt>
<dd><p>Color for observations</p></dd>


<dt>add</dt>
<dd><p>Boolean operator, if <code>True</code> will add lines to existing plot</p></dd>


<dt>out</dt>
<dd><p>Direct output to a PDF, EPS or image file.  Format is a named list whose first argument,
<code>type</code> is one of the following character vectors: “pdf”, “eps” (maps to <code>postscript</code>),
“<code>png</code>”, “<code>tiff</code>”, “<code>jpeg</code>”, or “<code>bmp</code>”.  Other named items in the list
are the arguments to each graphic device. PDF and EPS are vector images acceptable to most journals
in a very small file size, with scalable (i.e. infinite) resolution.  The others are raster images which may be very
large files at publication quality dots per inch (DPI), e.g. 800 or 1200. Default value is <code>NA</code> which means the
output will go to the current graphic device (usually the monitor). For example, to output an eps file,
out=list(“eps”) will generate a 7x7 inch (default) graphic.</p></dd>


<dt>...</dt>
<dd><p>Other parameters as found in <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot.default</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Plots the simulation object.  If <code>obs</code> is included, a list will be returned with
the folowing items:</p>
<dl><dt>npc</dt>
<dd><p>A dataframe with three columns: quantile, prop.less, pval.  <em>quantile</em> are those specified
by the <code>prob</code> argument to the plot call; <em>prop.less</em> are the proportion of simulated
observations at all times less than the quantile; <em>pval</em> is the P-value of the difference in the
prop.less and quantile by the beta-binomial test.</p></dd>

<dt>simsum</dt>
<dd><p>A dataframe with the quantile concentration at each simulated time,
with lower and upper confidence intervals</p></dd>

<dt>obs</dt>
<dd><p>A dataframe similar to an PMop object made by <code><a href="makeOP.html">makeOP</a></code>
with the addition of the quantile for each observation</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Simulated observations are plotted as quantiles on the y-axis vs. time on the x.axis.  If measured
observations are included, a visual and numerical predictive check will be performed.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="SIMparse.html">SIMparse</a></code>, <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></code>, <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>, <code><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Michael Neely</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Michael Neely, Julián Otálvaro.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

