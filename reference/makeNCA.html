<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Non-compartmental analysis — makeNCA • Pmetrics</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Non-compartmental analysis — makeNCA"><meta name="description" content="Performs a non-compartmental analysis from observed concentrations in the raw data
file or from an individual Bayesian posterior predicted
time-observation profiles in PM_post generated automatically after an NPAG run
and loaded with PM_load."><meta property="og:description" content="Performs a non-compartmental analysis from observed concentrations in the raw data
file or from an individual Bayesian posterior predicted
time-observation profiles in PM_post generated automatically after an NPAG run
and loaded with PM_load."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Pmetrics</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">3.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/pmetrics.html">Start Here</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/intro.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/overview.html">Overview</a></li>
    <li><a class="dropdown-item" href="../articles/workflow.html">Workflow</a></li>
    <li><a class="dropdown-item" href="../articles/data.html">Data Objects</a></li>
    <li><a class="dropdown-item" href="../articles/models.html">Model Objects</a></li>
    <li><a class="dropdown-item" href="../articles/running.html">Running the fit</a></li>
    <li><a class="dropdown-item" href="../articles/objects.html">Created Objects</a></li>
    <li><a class="dropdown-item" href="../articles/simulation.html">Simulation</a></li>
    <li><a class="dropdown-item" href="../articles/pta.html">Probability of Target Attainment</a></li>
    <li><a class="dropdown-item" href="../articles/plotly.html">Plotly plots</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/LAPKB/Pmetrics_rust/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Non-compartmental analysis</h1>
      <small class="dont-index">Source: <a href="https://github.com/LAPKB/Pmetrics_rust/blob/main/R/makeNCA.R" class="external-link"><code>R/makeNCA.R</code></a></small>
      <div class="d-none name"><code>makeNCA.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Performs a non-compartmental analysis from observed concentrations in the raw data
file or from an individual Bayesian posterior predicted
time-observation profiles in <a href="PM_post.html">PM_post</a> generated automatically after an NPAG run
and loaded with <a href="PM_load.html">PM_load</a>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">makeNCA</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  postPred <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  <span class="va">include</span>,</span>
<span>  <span class="va">exclude</span>,</span>
<span>  input <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  icen <span class="op">=</span> <span class="st">"median"</span>,</span>
<span>  outeq <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  block <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  start <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  end <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  first <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  last <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  terminal <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Data to analyze.  This can be specified in a number of ways.</p><ul><li><p>It can be the run number, e.g. 3, that has been previously loaded with <a href="PM_load.html">PM_load</a>.
Either the mdata file from the run (NPAG or IT2B) can be used (default) or
the post object can be used (NPAG only) by specifying <code>postPred = T</code> below.  If <a href="https://ggplot2.tidyverse.org/reference/aes_position.html" class="external-link">ggplot2::x</a> is a run number that corresponds
to both an NPAG and IT2B run which have been previously loaded into memory with <a href="PM_load.html">PM_load</a>, the NPAG run will be used.</p></li>
<li><p>It can be the run number of a run that has <em>not</em> been previously loaded with <a href="PM_load.html">PM_load</a>.
In this case, the current working directory should be the Runs folder as makeNCA will call <a href="PM_load.html">PM_load</a>.</p></li>
<li><p>It can be the specific name of an mdata.x file already loaded into memory with <a href="PM_load.html">PM_load</a>, e.g. mdata.3.  Note
that quotation marks are not necessary since mdata.3 is an object, not a label/character vector.</p></li>
<li><p>Finally, it can be the name of a Pmetrics data file in the current working directory, which will be loaded with
<a href="PMreadMatrix.html">PMreadMatrix</a> and analyzed, e.g. "data.csv".  In this case, quotation marks are reqired, because <code>x</code>
is now a character vector specifying the filename of the file to load.</p></li>
</ul></dd>


<dt id="arg-postpred">postPred<a class="anchor" aria-label="anchor" href="#arg-postpred"></a></dt>
<dd><p>Boolean switch to use the posterior predictions rather than the observed.
concentrations.  Default is <code>FALSE</code>. Ignored if an IT2B run is
used to supply the raw data file.</p></dd>


<dt id="arg-include">include<a class="anchor" aria-label="anchor" href="#arg-include"></a></dt>
<dd><p>A vector of subject IDs to include in the NCA, e.g. c(1:3,5,15)</p></dd>


<dt id="arg-exclude">exclude<a class="anchor" aria-label="anchor" href="#arg-exclude"></a></dt>
<dd><p>A vector of subject IDs to exclude in the NCA, e.g. c(4,6:14,16:20).
When <code>postPred</code> is <code>TRUE</code>, any subject(s) excluded from the IT2B/NPAG run will be excluded as well.</p></dd>


<dt id="arg-input">input<a class="anchor" aria-label="anchor" href="#arg-input"></a></dt>
<dd><p>The number of the input (e.g. drug) to analyze; default 1.</p></dd>


<dt id="arg-icen">icen<a class="anchor" aria-label="anchor" href="#arg-icen"></a></dt>
<dd><p>If <code>postPred</code> is <code>TRUE</code>, use predictions based on median or mean of each
subject's Bayesian posterior parameter distribution.  Default is "median", but could be "mean".</p></dd>


<dt id="arg-outeq">outeq<a class="anchor" aria-label="anchor" href="#arg-outeq"></a></dt>
<dd><p>The number of the output equation to analyze; default 1</p></dd>


<dt id="arg-block">block<a class="anchor" aria-label="anchor" href="#arg-block"></a></dt>
<dd><p>The number of the observation block within subjects, with each block delimited by EVID=4 in the data file; default 1</p></dd>


<dt id="arg-start">start<a class="anchor" aria-label="anchor" href="#arg-start"></a></dt>
<dd><p>The beginning of the time interval to look for doses and observations, e.g. 120.  It can be
a vector to allow for individual start times per subject, e.g. c(120,120,144,168).  If the length of <code>start</code>
is less than the number of subjects, the last value will be recycled as needed.  If the <code>start</code> time is not 0 (default),
then it is assumed that steady state (multiple dose) conditions apply.</p></dd>


<dt id="arg-end">end<a class="anchor" aria-label="anchor" href="#arg-end"></a></dt>
<dd><p>Analogous to <code>start</code>, set this equal to the end of the dosing interval. It too can be a vector, with the last value
recycled as necessary.  Default is <code>Inf</code>, i.e. all data used.</p></dd>


<dt id="arg-first">first<a class="anchor" aria-label="anchor" href="#arg-first"></a></dt>
<dd><p>Alternative way to specify time interval for NCA by choosing dose number, e.g. 1 or 3.  May be a numeric vector, like <code>start</code> and <code>end</code>,
e.g. c(1,1,1,3,1,...) to allow for individualization by subject.  The last value will be recycled to ensure length equal to the
number of subjects.  Default is <code>NA</code>, which means <code>start</code> will be used.</p></dd>


<dt id="arg-last">last<a class="anchor" aria-label="anchor" href="#arg-last"></a></dt>
<dd><p>The complement to <code>first</code>, specifying the last dose to end the time interval.  If <code>NA</code>,
which is the default, then the maximum time per subject will be the upper bound of the time interval.
Like <code>first</code>, <code>last</code> can be a vector, with the last value recycled as necessary.  Use <code>NA</code> in the vector
to signify maximum time for that subject.</p></dd>


<dt id="arg-terminal">terminal<a class="anchor" aria-label="anchor" href="#arg-terminal"></a></dt>
<dd><p>Number of observations to use for terminal curve fitting (i.e. to estimate <em>k</em>).  Default is 3.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A dataframe of class <em>PMnca</em> with columns</p>
<dl><dt>id </dt>
<dd><p>Subject identification</p></dd>

<dt>auc </dt>
<dd><p>Area under the time-observation curve, using the trapezoidal approximation, from time 0 until the second dose,
or if only one dose, until the last observation</p></dd>

<dt>aumc </dt>
<dd><p>Area under the first moment curve</p></dd>

<dt>k </dt>
<dd><p>Slope by least-squares linear regression of the final 3 log-transformed observations vs. time.
If the final 3 concentrations are not decreasing such that linear regression results in a positive slope,
this value and all others that depend on <code>k</code> will be suppressed.</p></dd>

<dt>auclast </dt>
<dd><p>Area under the curve from the time of the last observation to infinity, calculated as \(Final obs\)/k.
This value will be suppressed if start != 0.</p></dd>

<dt>aumclast </dt>
<dd><p>Area under the first moment curve from the time of the last observation to infinity.
This value will be suppressed if start!=0.</p></dd>

<dt>aucinf </dt>
<dd><p>Area under the curve from time 0 to infinity, caluculated as auc + auclast</p></dd>

<dt>aumcinf </dt>
<dd><p>Area under the first moment curve from time 0 to infinity</p></dd>

<dt>mrt </dt>
<dd><p>Mean residence time, calculated as 1/k</p></dd>

<dt>cmax </dt>
<dd><p>Maximum predicted concentration after the first dose</p></dd>

<dt>tmax </dt>
<dd><p>Time to cmax</p></dd>

<dt>cl </dt>
<dd><p>Clearance, calculated as dose/aucinf</p></dd>

<dt>vdss </dt>
<dd><p>Volume of distribution at steady state, calculated as cl*mrt</p></dd>

<dt>thalf </dt>
<dd><p>Half life of elimination, calculated as ln(2)/k</p></dd>

<dt>dose </dt>
<dd><p>Dose for each subject</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If concentrations from multiple dose intervals are included in the <code>start</code> to <code>end</code> time interval,
the function will superpose the concentrations using the time after dose.  An error will be generated if
different doses are within this interval as superposition would no longer be valid.</p>
<p>A minimum of 5 concentrations must be available to perform NCA for any given subject.  Fewer than this will
suppress all results for that subject.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Michael Neely</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">makeNCA</span><span class="op">(</span><span class="va">NPex</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    id      auc      aumc           k   auclast   aumclast    aucinf    aumcinf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   1 361.8704 4133.5637 0.026673314 471.25753  28968.509  833.1280  33102.072</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   2 121.0778 1286.2205 0.030510262 123.23723   6996.899  244.3150   8283.120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   3 120.8402 1365.0443 0.035395480 107.92338   5647.867  228.7636   7012.912</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   4  87.1521  866.1199 0.051809452  37.83093   1638.893  124.9830   2505.013</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   5  75.7889  787.1226 0.035508428  62.23874   3246.518  138.0276   4033.640</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   6 240.5456 2757.7293 0.039321570 168.35543   8487.022  408.9010  11244.751</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   7 200.5504 2309.1628 0.037776577 168.62301   8515.703  369.1734  10824.866</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   8 238.9118 2785.1228 0.028829268 271.59898  15933.890  510.5108  18719.013</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   9 148.2174 1676.0129 0.029518224 152.78697   8839.853  301.0044  10515.866</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 10 160.8878 1658.3495 0.045183937  91.84680   4237.054  252.7346   5895.404</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 11 121.3709 1271.6191 0.060039952  43.80417   1786.578  165.1751   3058.197</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 12 207.0078 2408.1546 0.009635465 818.84995 104635.319 1025.8577 107043.473</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 13 235.1283 2862.7292 0.032369319 249.00122  13668.536  484.1295  16531.266</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 14 114.1000 1153.1800 0.046519111  57.61073   2621.089  171.7107   3774.269</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 15 179.8273 1999.4247 0.025417183 225.83148  14316.240  405.6587  16315.664</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 16 185.4531 1945.0044 0.042009360 118.06893   5640.651  303.5221   7585.655</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 17 137.0686 1447.8541 0.042034527  85.40598   4088.381  222.4746   5536.236</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 18 241.9302 2740.7573 0.026364520 318.61001  19721.885  560.5402  22462.642</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 19 333.7126 3911.8963 0.032526897 335.72216  18378.702  669.4348  22290.598</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 20 209.1043 2306.7428 0.036994164 174.35183   8839.863  383.4562  11146.605</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          mrt  cmax  tmax        cl      vdss    thalf dose</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   39.73228 20.15  9.00 0.7201775  28.61429 25.98654  600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   33.90344  6.56  9.02 2.4558457  83.26162 22.71849  600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   30.65572  7.98  6.08 2.6227951  80.40366 19.58293  600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   20.04282  5.21  2.02 4.8006516  96.21860 13.37878  600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   29.22342  4.80  2.00 4.3469553 127.03292 19.52064  600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   27.49993 13.72  6.00 1.4673477  40.35197 17.62766  600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   29.32190 12.19  6.02 1.6252527  47.65550 18.34860  600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   36.66722 13.03  5.98 1.1752934  43.09474 24.04318  600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   34.93593  7.48 12.00 1.9933265  69.63871 23.48201  600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  23.32647 11.02  6.00 2.3740324  55.37779 15.34057  600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  18.51488  7.71  5.98 3.6325084  67.25545 11.54477  600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 104.34534 11.16  6.00 0.5848764  61.02913 71.93708  600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  34.14637 12.84  9.02 1.2393378  42.31889 21.41371  600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  21.98039  7.28  6.00 3.4942487  76.80495 14.90027  600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  40.22017  9.96  6.00 1.1093068  44.61651 27.27081  450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16  24.99210 10.57  6.00 1.9767920  49.40419 16.49983  600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17  24.88480  9.11  6.00 2.6969373  67.11275 16.48995  600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18  40.07320 14.01  9.17 0.8027970  32.17065 26.29091  450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19  33.29764 20.07  5.98 0.8962785  29.84396 21.30997  600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20  29.06879 12.35  5.67 1.5647160  45.48439 18.73666  600</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Neely, Julián Otálvaro, Markus Hößvd.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.9000.</p>
</div>

    </footer></div>





  </body></html>

