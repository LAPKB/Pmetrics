<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Optimal Sample Times — PM_opt • Pmetrics</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Optimal Sample Times — PM_opt"><meta name="description" content="
Contains optimal sampling times for a given model and dosage regimen."><meta property="og:description" content="
Contains optimal sampling times for a given model and dosage regimen."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Pmetrics</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">3.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/pmetrics.html">Start Here</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/intro.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/overview.html">Overview</a></li>
    <li><a class="dropdown-item" href="../articles/workflow.html">Workflow</a></li>
    <li><a class="dropdown-item" href="../articles/data.html">Data Objects</a></li>
    <li><a class="dropdown-item" href="../articles/models.html">Model Objects</a></li>
    <li><a class="dropdown-item" href="../articles/running.html">Running the fit</a></li>
    <li><a class="dropdown-item" href="../articles/objects.html">Created Objects</a></li>
    <li><a class="dropdown-item" href="../articles/simulation.html">Simulation</a></li>
    <li><a class="dropdown-item" href="../articles/pta.html">Probability of Target Attainment</a></li>
    <li><a class="dropdown-item" href="../articles/plotly.html">Plotly plots</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/LAPKB/Pmetrics_rust/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Optimal Sample Times</h1>
      <small class="dont-index">Source: <a href="https://github.com/LAPKB/Pmetrics_rust/blob/main/R/PM_opt.R" class="external-link"><code>R/PM_opt.R</code></a></small>
      <div class="d-none name"><code>PM_opt.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="figures/lifecycle-stable.svg" alt="[Stable]"></a></p>
<p>Contains optimal sampling times for a given model and dosage regimen.</p>
    </div>


    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This object contains
the methods to create and results from optimal sampling algorithms.
Currently the only option multiple-model optimization.
This algorithm calculates the
requested number of sample times where the concentration time profiles
are the most separated, thereby minimizing the risk of choosing the incorrect
Bayesian posterior for an individual. Future updates will add D-optimal
sampling times.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Bayard, David S. &amp; and Neely, Michael. (2017). Experiment
Design for Nonparametric
Models Based on Minimizing Bayes Risk: Application to Voriconazole.
<em>Journal of Pharmacokinetics and Pharmacodynamics</em>, <b>44</b>(2): 95–111.
<a href="https://doi.org/10.1007/s10928-016-9498-5" class="external-link">https://doi.org/10.1007/s10928-016-9498-5</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Michael Neely</p>
    </div>
    <div class="section level2">
    <h2 id="public-fields">Public fields<a class="anchor" aria-label="anchor" href="#public-fields"></a></h2>
    <p></p><div class="r6-fields"><dl><dt><code>sampleTime</code></dt>
<dd><p>The optimal sample times, based on requested <code>type</code>
argument to <code>$new</code> creation method.</p></dd>


<dt><code>bayesRisk</code></dt>
<dd><p>Only present for MM-optimal sampling.
The Bayesian risk of mis-classifying a subject based on
the sample times.  This is more useful for comparisons between sampling
strategies, with minimization the goal.</p></dd>


<dt><code>simdata</code></dt>
<dd><p>A <a href="PM_sim.html">PM_sim</a> object with the simulated profiles</p></dd>


<dt><code>mmInt</code></dt>
<dd><p>A list with the <code>mmInt</code> values, <code>NULL</code> if <code>mmInt</code> argument
to <code>$new</code> is missing.</p></dd>


</dl><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>

<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-PM_opt-new"><code>PM_opt$new()</code></a></p></li>
<li><p><a href="#method-PM_opt-plot"><code>PM_opt$plot()</code></a></p></li>
<li><p><a href="#method-PM_opt-print"><code>PM_opt$print()</code></a></p></li>
<li><p><a href="#method-PM_opt-clone"><code>PM_opt$clone()</code></a></p></li>
</ul></div><p></p><hr><a id="method-PM_opt-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="figures/lifecycle-stable.svg" alt="[Stable]"></a></p>
<p>Determine optimal sample times which are the most informative about the
model parameters.</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/PM_opt.html">PM_opt</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  <span class="va">poppar</span>,</span>
<span>  <span class="va">model</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  nsamp <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>none <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  predInt <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  <span class="va">mmInt</span>,</span>
<span>  algorithm <span class="op">=</span> <span class="st">"mm"</span>,</span>
<span>  outeq <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>poppar</code></dt>
<dd><p>There are several choices for the population parameters.</p><ul><li><p>A <a href="PM_result.html">PM_result</a> loaded with <a href="PM_load.html">PM_load</a>, in which case the <code>$final</code> field
will be used, e.g. <code>run1 &lt;- PM_load(1)</code> and <code>poppar = run1</code>.</p></li>
<li><p>A <a href="PM_final.html">PM_final</a> object, typically as a field in a <a href="PM_result.html">PM_result</a>, e.g.,
<code>poppar = run1$final</code>.</p></li>
<li><p>A list containing three items in this order,
but of any name: vector of weights, vector of mean parameter values, and a
covariance matrix. If only one distribution is to be specified the
<code>weights</code> vector should be of length 1 and contain a 1. If multiple
distributions are to be sampled, the <code>weights</code> vector should be of
length equal to the number of distributions and its values should sum to 1,
e.g. <code>c(0.25,0.05,0.7)</code>.  The means matrix may be a vector for a
single distribution, or a matrix with <code>length(weights)</code> rows and
number of columns equal to the number of parameters.</p></li>
</ul></dd>


<dt><code>model</code></dt>
<dd><p>One of three choices:</p><ul><li><p><a href="PM_model.html">PM_model</a> object</p></li>
<li><p>Character vector with the filename of a Pmetrics model in the working directory.</p></li>
<li><p>If <code>model</code> is missing, there are two possibilities:
**  When <code>poppar</code> is a <a href="PM_result.html">PM_result</a> with a valid <code>$model</code> field,
the model in <code>poppar</code> will be used.
** In the absence of a <code>poppar</code> with a valid model field,
look for a file called "model.txt" in the working directory.</p></li>
</ul></dd>


<dt><code>data</code></dt>
<dd><p>One of three choices:</p><ul><li><p><a href="PM_data.html">PM_data</a> object</p></li>
<li><p>Character vector with the filename of a Pmetrics data in the working directory.</p></li>
<li><p>If <code>data</code> is missing, there are two possibilities:
**  When <code>poppar</code> is a <a href="PM_result.html">PM_result</a> with a valid <code>$data</code> field,
the data in <code>poppar</code> will be used.
** In the absence of a <code>poppar</code> with a valid data field,
look for a file called "data.csv" in the working directory.
In either choice, the value for outputs
can be coded as any number(s) other than -99.
The number(s) will be replaced in the simulator output with the simulated values.</p></li>
</ul></dd>


<dt><code>nsamp</code></dt>
<dd><p>The number of MM-optimal sample times to compute; default
is 1, but can be any number.  Values &gt;4 will take an exponentially longer time.</p></dd>


<dt><code>weight</code></dt>
<dd><p>List whose names indicate the type of weighting, and
values indicate the relative weight. Values should sum to 1.
Names can be any of the following:</p><ul><li><p><strong>none</strong> The default. MMopt times will be chosen to maximally discriminate all responses at all times.</p></li>
<li><p><strong>AUC</strong> MMopt times will be chosen to maximally discriminate AUC, regardless of the shape of the response profile.</p></li>
<li><p><strong>max</strong> MMopt times will be chosen to maximally discriminate maximum, regardless of the shape of the response profile.</p></li>
<li><p><strong>min</strong> MMopt times will be chosen to maximally discriminate minimum, regardless of the shape of the response profile.</p></li>
</ul><p>Any combination of AUC, max, and min can be chosen.  If "none" is specified, other
weight types will be ignored and the relative value will be set to 1.
For example,<code>list(auc = 0.5,max = 0.5)</code> or <code>list(auc = 0.2, min = 0.8)</code>.
The default is <code>list(none = 1)</code>.</p></dd>


<dt><code>predInt</code></dt>
<dd><p>The interval in fractional hours for simulated predicted outputs at times other than those specified in the template <code>data</code>.
The default is 0.5, which means there will be simulated outputs every 30 minutes from time 0 up
to the maximal time in the template file.  You may also specify <code>predInt</code>
as a vector of 3 values, e.g. <code>c(1,4,1)</code>, similar to the R command <a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a>, where the
first value is the start time, the second is the stop time, and the third is the
step value.  Outputs for times specified in the template file will also be simulated.
To simulate outputs <em>only</em> at the output times in the template data (i.e. EVID=0 events), use <code>predInt = 0</code>.
Note that the maximum number of predictions total is 594, so the interval must be sufficiently large to accommodate this for a given
number of output equations and total time to simulate over.  If <code>predInt</code> is set so that this cap is exceeded, predictions will be truncated.</p></dd>


<dt><code>mmInt</code></dt>
<dd><p>Specify the time intervals from which MMopt times can be selected.
These should only include simulated times specified by <code>predInt</code>.</p></dd>


<dt><code>algorithm</code></dt>
<dd><p>Optimal sampling algorithm. Currently not modifiable and
the only option is "mm".</p></dd>


<dt><code>outeq</code></dt>
<dd><p>Output equation to optimize</p></dd>


<dt><code>...</code></dt>
<dd><p>Other parameters to pass to <a href="PM_sim.html">PM_sim</a>$new(). Most are not necessary,
but <code>usePost = TRUE</code> can be used to calculate individual MMopt times.
In this case, the number of posterior distributions contained in
<code>poppar$final$postPoints</code> needs to match the number of subjects in <code>data</code>.
You can also pass <code>include</code> and <code>exclude</code> to limit the subjects used in
<code>data</code>. This will work whether <code>usePost</code> is <code>TRUE</code> or <code>FALSE</code>.
Note that the following arguments to <a href="PM_sim.html">PM_sim</a>$new cannot be modified.</p><ul><li><p><code>nsim</code> is zero</p></li>
<li><p><code>outname</code> is "MMsim"</p></li>
<li><p><code>combine</code> is <code>TRUE</code></p></li>
</ul></dd>


<dt><code>clean</code></dt>
<dd><p>Boolean parameter to specify whether temporary files made in the
course of the simulation run should be deleted. Defaults to <code>TRUE</code>.
This is primarily used for debugging.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="details-1">Details<a class="anchor" aria-label="anchor" href="#details-1"></a></h4>
<p>Currently, the only option is the multiple-model optimization algorithm.</p>
</div>


</div><p></p><hr><a id="method-PM_opt-plot"></a><div class="section">
<h3 id="method-plot-">Method <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code><a class="anchor" aria-label="anchor" href="#method-plot-"></a></h3>
<p>Plot method</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PM_opt</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>...</code></dt>
<dd><p>Arguments passed to <a href="plot.PM_opt.html">plot.PM_opt</a></p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="details-2">Details<a class="anchor" aria-label="anchor" href="#details-2"></a></h4>
<p>See <a href="plot.PM_opt.html">plot.PM_opt</a>.</p>
</div>


</div><p></p><hr><a id="method-PM_opt-print"></a><div class="section">
<h3 id="method-print-">Method <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code><a class="anchor" aria-label="anchor" href="#method-print-"></a></h3>
<p>Print method</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PM_opt</span><span class="op">$</span><span class="fu">print</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns">Returns<a class="anchor" aria-label="anchor" href="#returns"></a></h4>
<p>Prints the optimal sampling times and Bayes Risk.</p>
</div>

</div><p></p><hr><a id="method-PM_opt-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PM_opt</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Neely, Julián Otálvaro, Markus Hößvd.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.9000.</p>
</div>

    </footer></div>





  </body></html>

