<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Final Cycle Population Values — PM_final • Pmetrics</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Final Cycle Population Values — PM_final"><meta name="description" content="
Contains final cycle information from run."><meta property="og:description" content="
Contains final cycle information from run."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Pmetrics</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">3.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/pmetrics.html">Start Here</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/intro.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/overview.html">Overview</a></li>
    <li><a class="dropdown-item" href="../articles/workflow.html">Workflow</a></li>
    <li><a class="dropdown-item" href="../articles/data.html">Data Objects</a></li>
    <li><a class="dropdown-item" href="../articles/models.html">Model Objects</a></li>
    <li><a class="dropdown-item" href="../articles/running.html">Running the fit</a></li>
    <li><a class="dropdown-item" href="../articles/objects.html">Created Objects</a></li>
    <li><a class="dropdown-item" href="../articles/simulation.html">Simulation</a></li>
    <li><a class="dropdown-item" href="../articles/pta.html">Probability of Target Attainment</a></li>
    <li><a class="dropdown-item" href="../articles/plotly.html">Plotly plots</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/LAPKB/Pmetrics_rust/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Final Cycle Population Values</h1>
      <small class="dont-index">Source: <a href="https://github.com/LAPKB/Pmetrics_rust/blob/main/R/PM_final.R" class="external-link"><code>R/PM_final.R</code></a></small>
      <div class="d-none name"><code>PM_final.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="figures/lifecycle-stable.svg" alt="[Stable]"></a></p>
<p>Contains final cycle information from run.</p>
    </div>


    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The PM_final object is both a data field within a <a href="PM_result.html">PM_result</a>, and itself an R6 object
comprising data fields and associated methods suitable for analysis and plotting of
final cycle parameters.</p>
<p>Because PM_final objects are automatically added to the <a href="PM_result.html">PM_result</a> at the end of a
successful run, it is generally not necessary for users to generate PM_final objects
themselves.</p>
<p>The main results are contained in the <code>$data</code> field,
and it is this field which is passed to the <code>$plot</code> and <code>$summary</code> methods.
You can use this <code>$data</code> field for custom manipulations, e.g. <code>probs &lt;- run1$final$data$popPoints %&gt;% select(prob)</code>.
This will select the probabilities of the support points.
If you are unfamiliar with the <code>%&gt;%</code> pipe function, please type <code>help("%&gt;%", "magrittr")</code>
into the R console and look online for instructions/tutorials in tidyverse, a
powerful approach to data manipulation upon which Pmetrics is built.</p>
<p>To provide a more traditional experience in R,
the <code>$data</code> field is also separated by list items into the other data fields within the R6 object,
e.g. <code>popMean</code> or <code>nsub</code>. This
allows you to access them in an S3 way, e.g. <code>run1$final$popMean</code> if <code>run1</code> is a
<a href="PM_result.html">PM_result</a> object.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Michael Neely, Julian Otalvaro</p>
    </div>
    <div class="section level2">
    <h2 id="public-fields">Public fields<a class="anchor" aria-label="anchor" href="#public-fields"></a></h2>
    <p></p><div class="r6-fields"><dl><dt><code>data</code></dt>
<dd><p>A list with the following elements, which can also be extracted by name.</p><ul><li><p><strong>popPoints</strong> (NPAG only) Data frame of the final cycle joint population density of grid points
with column names equal to the name of each random parameter plus <em>prob</em> for the
associated probability of that point</p></li>
<li><p><strong>popMean</strong> The final cycle mean for each random parameter distribution</p></li>
<li><p><strong>popSD</strong> The final cycle standard deviation for each random parameter distribution</p></li>
<li><p><strong>popCV</strong> The final cycle coefficient of variation (SD/Mean) for each random parameter distribution</p></li>
<li><p><strong>popVar</strong> The final cycle variance for each random parameter distribution</p></li>
<li><p><strong>popCov</strong> The final cycle random parameter covariance matrix</p></li>
<li><p><strong>popCor</strong> The final cycle random parameter correlation matrix</p></li>
<li><p><strong>popMed</strong> The final cycle median values for each random parameter,
i.e. those that have unknown mean and unknown variance, both of which are
fitted during the run</p></li>
<li><p><strong>popRanFix</strong> The final cycle median values for each parameter that is
random but fixed to be the same for all subjects, i.e. unknown mean, zero
variance, with only mean fitted in the run</p></li>
<li><p><strong>postPoints</strong> (NPAG only) Data frame of posterior population points for each of the first 100 subject,
with columns id, point, parameters and probability.  The first column is the subject, the second column has the population
point number, followed by the values for the parameters in that point and the probability.</p></li>
<li><p><strong>postMean</strong> A <em>nsub</em> x <em>npar</em> data frame containing
the means of the posterior distributions for each parameter.</p></li>
<li><p><strong>postSD</strong> A <em>nsub</em> x <em>npar</em> data frame containing
the SDs of the posterior distributions for each parameter.</p></li>
<li><p><strong>postVar</strong> A <em>nsub</em> x <em>npar</em> data frame containing
the variances of the posterior distributions for each parameter.</p></li>
<li><p><strong>postCov</strong> NPAG only: An list of length <em>nsub</em>, each element with an <em>npar</em> x <em>npar</em> data frame
that contains the posterior parameter value covariances for that subject.</p></li>
<li><p><strong>postCor</strong> NPAG only: An list of length <em>nsub</em>, each element with an <em>npar</em> x <em>npar</em> data frame
that contains the posterior parameter value correlations for that subject.</p></li>
<li><p><strong>postMed</strong> A <em>nsub</em> x <em>npar</em> data frame containing
the medians of the posterior distributions for each parameter.</p></li>
<li><p><strong>shrinkage</strong> A data frame with the shrinkage for each parameter.</p></li>
<li><p><strong>gridpts</strong> (NPAG only) Initial number of support points</p></li>
<li><p><strong>nsub</strong> Number of subjects</p></li>
<li><p><strong>ab</strong> Tibble/data frame of boundaries for random parameter values with columns: name, lower, upper.</p></li>
</ul></dd>


</dl><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="active-bindings">Active bindings<a class="anchor" aria-label="anchor" href="#active-bindings"></a></h2>
    <p></p><div class="r6-active-bindings"><dl><dt><code>popPoints</code></dt>
<dd><p>(NPAG only) Data frame of the final cycle joint population density of grid points
with column names equal to the name of each random parameter plus <em>prob</em> for the
associated probability of that point</p></dd>


<dt><code>popMean</code></dt>
<dd><p>The final cycle mean for each random parameter distribution</p></dd>


<dt><code>popSD</code></dt>
<dd><p>The final cycle standard deviation for each random parameter distribution</p></dd>


<dt><code>popCV</code></dt>
<dd><p>The final cycle coefficient of variation (SD/Mean) for each random parameter distribution</p></dd>


<dt><code>popVar</code></dt>
<dd><p>The final cycle variance for each random parameter distribution</p></dd>


<dt><code>popCov</code></dt>
<dd><p>The final cycle random parameter covariance matrix</p></dd>


<dt><code>popCor</code></dt>
<dd><p>The final cycle random parameter correlation matrix</p></dd>


<dt><code>popMed</code></dt>
<dd><p>The final cycle median values for each random parameter,
i.e. those that have unknown mean and unknown variance, both of which are
fitted during the run</p></dd>


<dt><code>popRanFix</code></dt>
<dd><p>The final cycle median values for each parameter that is
random but fixed to be the same for all subjects, i.e. unknown mean, zero
variance, with only mean fitted in the run</p></dd>


<dt><code>postPoints</code></dt>
<dd><p>(NPAG only) Data frame of posterior population points for each of the first 100 subject,
with columns id, point, parameters and probability.  The first column is the subject, the second column has the population
point number, followed by the values for the parameters in that point and the probability.</p></dd>


<dt><code>postMean</code></dt>
<dd><p>A <em>nsub</em> x <em>npar</em> data frame containing
the means of the posterior distributions for each parameter.</p></dd>


<dt><code>postSD</code></dt>
<dd><p>A <em>nsub</em> x <em>npar</em> data frame containing
the SDs of the posterior distributions for each parameter.</p></dd>


<dt><code>postVar</code></dt>
<dd><p>A <em>nsub</em> x <em>npar</em> data frame containing
the variances of the posterior distributions for each parameter.</p></dd>


<dt><code>postCov</code></dt>
<dd><p>NPAG only: An list of length <em>nsub</em>, each element with an <em>npar</em> x <em>npar</em> data frame
that contains the posterior parameter value covariances for that subject.</p></dd>


<dt><code>postCor</code></dt>
<dd><p>NPAG only: An list of length <em>nsub</em>, each element with an <em>npar</em> x <em>npar</em> data frame
that contains the posterior parameter value correlations for that subject.</p></dd>


<dt><code>postMed</code></dt>
<dd><p>A <em>nsub</em> x <em>npar</em> data frame containing
the medians of the posterior distributions for each parameter.*</p></dd>


<dt><code>shrinkage</code></dt>
<dd><p>A data frame with the shrinkage for each parameter.
The total population variance for a parameter
is comprised of variance(EBE) plus average variance(EBD),
where each subject's EBE is the Empirical Bayes Estimate or mean posterior value
for the parameter. EBD is the Empirical Bayes Distribution, or
the full Bayesian posterior parameter value distribution for each subject.</p>
<p>The typical definition of \(\eta\) shrinkage is
\([1 - \frac{SD(\eta)}{\omega}]\) or \([1 - \frac{var(\eta)}{\omega^2}]\),
where \(\eta\) is the EBE and \(\omega^2\) is the population variance of \(\eta\).</p>
<p>In parametric modeling approaches \(\eta\) is the interindividual variability around
the typical (mean) value of the parameter in the population, usually referred to
as \(\theta\). In nonparametric approaches, there is no assumption of normality, so
\(\eta\) simply becomes each subject's mean parameter value estimate.</p>
<p>Here is how Pmetrics derives and then calculates shrinkage for a given parameter.
$$popVar = var(EBE) + mean(var(EBD))$$
$$1 = \frac{var(EBE)}{popVar} + \frac{mean(var(EBD)}{popVar}$$
$$1 - \frac{var(EBE)}{popVar} = \frac{mean(var(EBD))}{popVar}$$
$$shrinkage = \frac{mean(var(EBD))}{popVar}$$
Shrinkage is therefore a fraction between 0 and 1. If Bayesian posterior distributions are wide
for a given parameter and \(mean(var(EBD))\) is high due to sparse or uninformative sampling,
then most of the population variance is due
to this variance and shrinkage is high, i.e., individual posterior estimates (EBE)
shrink towards the population mean. Be aware, however, that a Bayesian posterior
parameter value distribution for a given subject who is sparsely sampled may also
be a single support point with no variance. Therefore EBD under nonparametric
assumptions is not always large with uninformative sampling. This means that shrinkage
is not as readily interpretable in nonparametric population modeling.</p>
<p>An alternative is to consider the number of support points relative to the number
of subjects. Highly informed, distinct subjects will result in the maximum possible
number of support points, <em>N</em>, which is the same as the number of subjects.
In contrast, badly undersampled subjects can result in only one support point.
There is no formal criterion for this statistic, but it can be used in combination
with shrinkage to assess the information content of the data.</p></dd>


<dt><code>gridpts</code></dt>
<dd><p>(NPAG only) Initial number of support points</p></dd>


<dt><code>nsub</code></dt>
<dd><p>Number of subjects</p></dd>


<dt><code>ab</code></dt>
<dd><p>Matrix of boundaries for random parameter values</p></dd>


</dl><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>

<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-PM_final-new"><code>PM_final$new()</code></a></p></li>
<li><p><a href="#method-PM_final-plot"><code>PM_final$plot()</code></a></p></li>
<li><p><a href="#method-PM_final-summary"><code>PM_final$summary()</code></a></p></li>
<li><p><a href="#method-PM_final-clone"><code>PM_final$clone()</code></a></p></li>
</ul></div><p></p><hr><a id="method-PM_final-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>Create new object populated with final cycle information</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/PM_final.html">PM_final</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>PMdata <span class="op">=</span> <span class="cn">NULL</span>, path <span class="op">=</span> <span class="st">"."</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>PMdata</code></dt>
<dd><p>include Saved, parsed output of prior run, used when source files are not available.
.</p></dd>


<dt><code>path</code></dt>
<dd><p>include Path to the folder containing the raw results of the run. Default is the current working directory.
.</p></dd>


<dt><code>...</code></dt>
<dd><p>Not currently used.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="details-1">Details<a class="anchor" aria-label="anchor" href="#details-1"></a></h4>
<p>Creation of new <code>PM_final</code> object is automatic and not generally necessary
for the user to do.</p>
</div>


</div><p></p><hr><a id="method-PM_final-plot"></a><div class="section">
<h3 id="method-plot-">Method <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code><a class="anchor" aria-label="anchor" href="#method-plot-"></a></h3>
<p>Plot method</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PM_final</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>...</code></dt>
<dd><p>Arguments passed to <a href="plot.PM_final.html">plot.PM_final</a></p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="details-2">Details<a class="anchor" aria-label="anchor" href="#details-2"></a></h4>
<p>See <a href="plot.PM_final.html">plot.PM_final</a>.</p>
</div>


</div><p></p><hr><a id="method-PM_final-summary"></a><div class="section">
<h3 id="method-summary-">Method <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code><a class="anchor" aria-label="anchor" href="#method-summary-"></a></h3>
<p>Summary method</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PM_final</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>...</code></dt>
<dd><p>Arguments passed to <a href="summary.PM_final.html">summary.PM_final</a></p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="details-3">Details<a class="anchor" aria-label="anchor" href="#details-3"></a></h4>
<p>See <a href="summary.PM_final.html">summary.PM_final</a>.</p>
</div>


</div><p></p><hr><a id="method-PM_final-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PM_final</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-3">Arguments<a class="anchor" aria-label="anchor" href="#arguments-3"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Neely, Julián Otálvaro, Markus Hößvd.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.9000.</p>
</div>

    </footer></div>





  </body></html>

