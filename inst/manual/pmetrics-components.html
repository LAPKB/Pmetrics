<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Pmetrics Components | Pmetrics User Manual</title>
  <meta name="description" content="<p>This is the manual for the Pmetrics population modeling and simulation
package for R.</p>" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Pmetrics Components | Pmetrics User Manual" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="<p>This is the manual for the Pmetrics population modeling and simulation
package for R.</p>" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Pmetrics Components | Pmetrics User Manual" />
  
  <meta name="twitter:description" content="<p>This is the manual for the Pmetrics population modeling and simulation
package for R.</p>" />
  

<meta name="author" content="LAPKB" />


<meta name="date" content="2022-02-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction.html"/>
<link rel="next" href="general-workflow.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#usage"><i class="fa fa-check"></i><b>1.1</b> Usage</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#render-book"><i class="fa fa-check"></i><b>1.2</b> Render book</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#preview-book"><i class="fa fa-check"></i><b>1.3</b> Preview book</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#r6-architecture"><i class="fa fa-check"></i><b>2.1</b> R6 architecture</a></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#citing-pmetrics"><i class="fa fa-check"></i><b>2.2</b> Citing Pmetrics</a></li>
<li class="chapter" data-level="2.3" data-path="introduction.html"><a href="introduction.html#disclaimer"><i class="fa fa-check"></i><b>2.3</b> Disclaimer</a></li>
<li class="chapter" data-level="2.4" data-path="introduction.html"><a href="introduction.html#system-requirements-and-installation"><i class="fa fa-check"></i><b>2.4</b> System Requirements and Installation</a></li>
<li class="chapter" data-level="2.5" data-path="introduction.html"><a href="introduction.html#what-this-manual-is-not"><i class="fa fa-check"></i><b>2.5</b> What This Manual Is Not</a></li>
<li class="chapter" data-level="2.6" data-path="introduction.html"><a href="introduction.html#getting-help-and-updates"><i class="fa fa-check"></i><b>2.6</b> Getting Help and Updates</a></li>
<li class="chapter" data-level="2.7" data-path="introduction.html"><a href="introduction.html#customizing-pmetrics-options"><i class="fa fa-check"></i><b>2.7</b> Customizing Pmetrics Options</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="pmetrics-components.html"><a href="pmetrics-components.html"><i class="fa fa-check"></i><b>3</b> Pmetrics Components</a>
<ul>
<li class="chapter" data-level="3.1" data-path="pmetrics-components.html"><a href="pmetrics-components.html#software-engines"><i class="fa fa-check"></i><b>3.1</b> Software engines</a></li>
<li class="chapter" data-level="3.2" data-path="pmetrics-components.html"><a href="pmetrics-components.html#pmetrics-control-functions"><i class="fa fa-check"></i><b>3.2</b> Pmetrics control functions</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="pmetrics-components.html"><a href="pmetrics-components.html#run-functions"><i class="fa fa-check"></i><b>3.2.1</b> Run functions</a></li>
<li class="chapter" data-level="3.2.2" data-path="pmetrics-components.html"><a href="pmetrics-components.html#parse-functions"><i class="fa fa-check"></i><b>3.2.2</b> Parse functions</a></li>
<li class="chapter" data-level="3.2.3" data-path="pmetrics-components.html"><a href="pmetrics-components.html#saving-and-loading-functions"><i class="fa fa-check"></i><b>3.2.3</b> Saving and loading functions</a></li>
<li class="chapter" data-level="3.2.4" data-path="pmetrics-components.html"><a href="pmetrics-components.html#report-generation"><i class="fa fa-check"></i><b>3.2.4</b> Report generation</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="pmetrics-components.html"><a href="pmetrics-components.html#data-manipulation-functions"><i class="fa fa-check"></i><b>3.3</b> Data manipulation functions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="general-workflow.html"><a href="general-workflow.html"><i class="fa fa-check"></i><b>4</b> General Workflow</a></li>
<li class="chapter" data-level="5" data-path="pmetrics-input-files.html"><a href="pmetrics-input-files.html"><i class="fa fa-check"></i><b>5</b> Pmetrics Input Files</a>
<ul>
<li class="chapter" data-level="5.1" data-path="pmetrics-input-files.html"><a href="pmetrics-input-files.html#data.csv-files"><i class="fa fa-check"></i><b>5.1</b> Data.csv Files</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="pmetrics-input-files.html"><a href="pmetrics-input-files.html#data-file-format"><i class="fa fa-check"></i><b>5.1.1</b> Data file format</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Pmetrics User Manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="pmetrics-components" class="section level1" number="3">
<h1><span class="header-section-number">Chapter 3</span> Pmetrics Components</h1>
<div id="software-engines" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Software engines</h2>
<p>There are three main software engines that Pmetrics controls.</p>
<ul>
<li><p><strong>IT2B</strong> is the ITerative 2-stage Bayesian parametric population PK modeling
program. It is generally used to estimate parameter ranges to pass to
NPAG. It will estimate values for population model parameters under the
assumption that the underlying distributions of those values are normal
or transformed to normal.</p></li>
<li><p><strong>NPAG</strong> is the Non-parametric Adaptive Grid software. It will create a
non-parametric population model consisting of discrete support points,
each with a set of estimates for all parameters in the model plus an
associated probability (weight) of that set of estimates. There can be
at most one point for each subject in the study population. There is no
need for any assumption about the underlying distribution of model
parameter values.</p></li>
<li><p>The <strong>Simulator</strong> is a semi-parametric Monte Carlo simulation software
program that can use the output of IT2B or NPAG to build randomly
generated response profiles (e.g. time-concentration curves) for a given
population model, parameter estimates, and data input. Simulation from a
non-parametric joint density model, i.e. NPAG output, is possible, with
each point serving as the mean of a multivariate normal distribution,
weighted according to the weight of the point. The covariance matrix of
the entire set of support points is divided equally among the points for
the purposes of simulation.</p></li>
</ul>
</div>
<div id="pmetrics-control-functions" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Pmetrics control functions</h2>
<p><span class="r6">R6</span></p>
<p>Pmetrics uses <code>PM_model</code> to create model objects and <code>PM_fit</code> to create
objects that combine the model with the data, ready to be run (fitted),
generating probability distributions for primary model parameters.</p>
<p>These functions replace the following Legacy functions: <code>ITrun</code>, <code>ERRrun</code>,
<code>NPrun</code>.</p>
<p><code>PMload</code> is aliased as <code>PM_load</code> for consistency with the above functions.
Similar to the Legacy version, it loads the results of a run into R to be
accessible to the user for analysis, plotting, etc. Different from the Legacy
version, it loads the results into another R6 object, <code>PM_result</code> instead of
the current environment.</p>
<p>Invoking the simulator in R6 is unchanged, i.e. use <code>SIMrun</code>.</p>
<p><span class="legacy">Legacy</span></p>
<p>Pmetrics has groups of R functions named logically to run each of these
programs and to extract the output. Again, these are extensively
documented within R by using the <code>help(command)</code> or <code>?command syntax</code>.</p>
<ul>
<li><p><code>ITrun</code>, <code>ITparse</code>, <code>ERRrun</code></p></li>
<li><p><code>NPrun</code>, <code>NPparse</code></p></li>
<li><p><code>PMload</code>, <code>PMsave</code>, <code>PMreport</code></p></li>
<li><p><code>SIMrun</code>, <code>SIMparse</code></p></li>
</ul>
<div id="run-functions" class="section level3" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Run functions</h3>
<p><span class="r6">R6</span></p>
<p>Once a <code>PM_fit</code> object is created, which combines a model with a data file,
it can be run by using the syntax <code>$run()</code> to access the appropriate function
defined for the <code>PM_fit</code> object.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="pmetrics-components.html#cb5-1" aria-hidden="true" tabindex="-1"></a>run1 <span class="ot">&lt;-</span> <span class="fu">PM_fit</span>(model,data)</span>
<span id="cb5-2"><a href="pmetrics-components.html#cb5-2" aria-hidden="true" tabindex="-1"></a>run1<span class="sc">$</span><span class="fu">run</span>(options)</span></code></pre></div>
<p><span class="r6">R6</span> <span class="legacy">Legacy</span></p>
<p>For IT2B and NPAG, the “run” functions generate batch files, which when
executed, launch the software programs to do the analysis. <code>$run(engine="err")</code>
or <code>ERRrun()</code> is a special implementation of IT2B designed to estimate
the assay error polynomial coefficients from the data, when they cannot be calculated from assay validation data (using <code>makeErrorPoly()</code>) supplied by the
analytical laboratory. The batch files contain all the information
necessary to complete a run, tidy the output into a date/time stamped
directory with meaningful subdirectories, extract the information,
generate a report, and a saved Rdata file of parsed output which can be
quickly and easily loaded into R. On Mac (Unix) and Linux systems,
the batch file automatically launches in a Terminal window.
Prior to v1.9, on Windows systems, the batch file was launched manually,
but as of v1.9, this manual step is no longer necessary. The execution of
the program to do the actual model parameter estimation is independent
of R, so that the user is free to use R for other purposes.</p>
<p>For the Simulator, the <code>SIMrun</code> function will execute the program
directly within R.</p>
</div>
<div id="parse-functions" class="section level3" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Parse functions</h3>
<p><span class="r6">R6</span> <span class="legacy">Legacy</span></p>
<p>For all programs, the “parse” functions will extract the primary output
from the program into meaningful R data objects. For IT2B and NPAG, this
is done automatically at the end of a successful run, and the objects
are saved in the output subdirectory as IT2Bout.Rdata or NPAGout.Rdata,
respectively. These functions generally run automatically and are not
necessary for the user to access.</p>
</div>
<div id="saving-and-loading-functions" class="section level3" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Saving and loading functions</h3>
<p><span class="r6">R6</span></p>
<p>After a successful IT2B or NPAG run, <code>PMload</code> or <code>PM_load</code> creates a
<code>PM_result</code> object rather than loading run results into the current
environment and suffixed with the run number.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="pmetrics-components.html#cb6-1" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">PM_load</span>(<span class="dv">1</span>)</span>
<span id="cb6-2"><a href="pmetrics-components.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit1<span class="sc">$</span>op)</span></code></pre></div>
<p><span class="legacy">Legacy</span></p>
<p>For IT2B and NPAG, the <code>PM_load</code> function can be used to load either
of the above .Rdata files after a successful run. Objects will be loaded
into the current environment in R and suffixed with “.run,” where “run” is
the run number.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="pmetrics-components.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">PM_load</span>(<span class="dv">1</span>)</span>
<span id="cb7-2"><a href="pmetrics-components.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(op<span class="fl">.1</span>)</span></code></pre></div>
<p><span class="update">Update</span>
<code>PMsave</code> is the
companion to <code>PMload</code> and can re-save modified objects to the .Rdata file.</p>
</div>
<div id="report-generation" class="section level3" number="3.2.4">
<h3><span class="header-section-number">3.2.4</span> Report generation</h3>
<p><span class="r6">R6</span> <span class="legacy">Legacy</span></p>
<p>The <code>PMreport</code> function is automatically run at the end of a successful
NPAG and IT2B run, and it will generate an HTML page with summaries of
the run, as well as the .Rdata files and other objects. The default
browser will be automatically launched for viewing of the HTML report
page. <!--It will also generate a .tex file suitable for processing by a
LATEX engine to generate a pdf report.--> See the <a href="#outputs">Pmetrics
Outputs</a> section.</p>
</div>
</div>
<div id="data-manipulation-functions" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Data manipulation functions</h2>
<p><span class="r6">R6</span> <span class="legacy">Legacy</span></p>
<p>Within Pmetrics there are also functions to manipulate data .csv files
and process and plot extracted data.</p>
<ul>
<li><p>Manipulate data .csv files: <code>PMreadMatrix</code>, <code>PMcheck</code>, <code>PMwriteMatrix</code>,
<code>PMmatrixRelTime</code>, <code>PMwrk2csv</code>, <code>NM2PM</code>, <code>PMmb2csv</code></p></li>
<li><p>Process data: <code>makeAUC</code>, <code>makeCov</code>, <code>makeCycle</code>, <code>makeFinal</code>, <code>makeOP</code>, <code>makePTA</code>,
<code>makeErrorPoly</code></p></li>
<li><p>Plot data: <code>plot.PMcov</code>, <code>plot.PMcycle</code>, <code>plot.PMfinal</code>, <code>plot.PMmatrix</code>,
<code>plot.PMop</code>,<code>plot.PMsim</code>, <code>plot.PMvalid</code>, <code>plot.PMpta</code></p></li>
<li><p>Model selection and diagnostics: <code>PMcompare</code>, <code>plot.PMop</code> (with residual
option), <code>makeValid</code>, <code>plot.PMvalid</code>, <code>PMstep</code></p></li>
<li><p>Pmetrics function defaults: <code>setPMoptions</code>, <code>getPMoptions</code></p></li>
</ul>
<p>Again, all functions have extensive help files and examples which can be
examined in R by using the <code>help(command)</code> or <code>?command</code> syntax.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="general-workflow.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/02-Components.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
