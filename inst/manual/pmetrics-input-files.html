<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Pmetrics Input Files | Pmetrics User Manual</title>
  <meta name="description" content="<p>This is the manual for the Pmetrics population modeling and simulation
package for R.</p>" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Pmetrics Input Files | Pmetrics User Manual" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="<p>This is the manual for the Pmetrics population modeling and simulation
package for R.</p>" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Pmetrics Input Files | Pmetrics User Manual" />
  
  <meta name="twitter:description" content="<p>This is the manual for the Pmetrics population modeling and simulation
package for R.</p>" />
  

<meta name="author" content="LAPKB" />


<meta name="date" content="2022-02-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="general-workflow.html"/>
<link rel="next" href="how-to-use-r-and-pmetrics.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#a-brief-history"><i class="fa fa-check"></i><b>1.1</b> A brief history</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#people"><i class="fa fa-check"></i><b>1.2</b> People</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#citing-pmetrics"><i class="fa fa-check"></i><b>1.3</b> Citing Pmetrics</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#donate"><i class="fa fa-check"></i><b>1.4</b> Donate</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#r6-architecture"><i class="fa fa-check"></i><b>2.1</b> R6 architecture</a></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#disclaimer"><i class="fa fa-check"></i><b>2.2</b> Disclaimer</a></li>
<li class="chapter" data-level="2.3" data-path="introduction.html"><a href="introduction.html#system-requirements-and-installation"><i class="fa fa-check"></i><b>2.3</b> System Requirements and Installation</a></li>
<li class="chapter" data-level="2.4" data-path="introduction.html"><a href="introduction.html#what-this-manual-is-not"><i class="fa fa-check"></i><b>2.4</b> What This Manual Is Not</a></li>
<li class="chapter" data-level="2.5" data-path="introduction.html"><a href="introduction.html#getting-help-and-updates"><i class="fa fa-check"></i><b>2.5</b> Getting Help and Updates</a></li>
<li class="chapter" data-level="2.6" data-path="introduction.html"><a href="introduction.html#customizing-pmetrics-options"><i class="fa fa-check"></i><b>2.6</b> Customizing Pmetrics Options</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="pmetrics-overview.html"><a href="pmetrics-overview.html"><i class="fa fa-check"></i><b>3</b> Pmetrics Overview</a>
<ul>
<li class="chapter" data-level="3.1" data-path="pmetrics-overview.html"><a href="pmetrics-overview.html#software-engines"><i class="fa fa-check"></i><b>3.1</b> Software engines</a></li>
<li class="chapter" data-level="3.2" data-path="pmetrics-overview.html"><a href="pmetrics-overview.html#pmetrics-control-functions"><i class="fa fa-check"></i><b>3.2</b> Pmetrics control functions</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="pmetrics-overview.html"><a href="pmetrics-overview.html#run-functions"><i class="fa fa-check"></i><b>3.2.1</b> Run functions</a></li>
<li class="chapter" data-level="3.2.2" data-path="pmetrics-overview.html"><a href="pmetrics-overview.html#parse-functions"><i class="fa fa-check"></i><b>3.2.2</b> Parse functions</a></li>
<li class="chapter" data-level="3.2.3" data-path="pmetrics-overview.html"><a href="pmetrics-overview.html#saving-and-loading-functions"><i class="fa fa-check"></i><b>3.2.3</b> Saving and loading functions</a></li>
<li class="chapter" data-level="3.2.4" data-path="pmetrics-overview.html"><a href="pmetrics-overview.html#report-generation"><i class="fa fa-check"></i><b>3.2.4</b> Report generation</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="pmetrics-overview.html"><a href="pmetrics-overview.html#data-manipulation-functions"><i class="fa fa-check"></i><b>3.3</b> Data manipulation functions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="general-workflow.html"><a href="general-workflow.html"><i class="fa fa-check"></i><b>4</b> General Workflow</a></li>
<li class="chapter" data-level="5" data-path="pmetrics-input-files.html"><a href="pmetrics-input-files.html"><i class="fa fa-check"></i><b>5</b> Pmetrics Input Files</a>
<ul>
<li class="chapter" data-level="5.1" data-path="pmetrics-input-files.html"><a href="pmetrics-input-files.html#data.csv-files"><i class="fa fa-check"></i><b>5.1</b> Data.csv Files</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="pmetrics-input-files.html"><a href="pmetrics-input-files.html#data-file-format"><i class="fa fa-check"></i><b>5.1.1</b> Data file format</a></li>
<li class="chapter" data-level="5.1.2" data-path="pmetrics-input-files.html"><a href="pmetrics-input-files.html#manipulation-of-csv-files"><i class="fa fa-check"></i><b>5.1.2</b> Manipulation of CSV files</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="pmetrics-input-files.html"><a href="pmetrics-input-files.html#specifying-models-in-r6"><i class="fa fa-check"></i><b>5.2</b> Specifying Models in R6</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="pmetrics-input-files.html"><a href="pmetrics-input-files.html#priR6"><i class="fa fa-check"></i><b>5.2.1</b> PRImary variables</a></li>
<li class="chapter" data-level="5.2.2" data-path="pmetrics-input-files.html"><a href="pmetrics-input-files.html#covR6"><i class="fa fa-check"></i><b>5.2.2</b> COVariates</a></li>
<li class="chapter" data-level="5.2.3" data-path="pmetrics-input-files.html"><a href="pmetrics-input-files.html#secR6"><i class="fa fa-check"></i><b>5.2.3</b> SECondary variables</a></li>
<li class="chapter" data-level="5.2.4" data-path="pmetrics-input-files.html"><a href="pmetrics-input-files.html#bolR6"><i class="fa fa-check"></i><b>5.2.4</b> BOLus inputs</a></li>
<li class="chapter" data-level="5.2.5" data-path="pmetrics-input-files.html"><a href="pmetrics-input-files.html#iniR6"><i class="fa fa-check"></i><b>5.2.5</b> INItial conditions</a></li>
<li class="chapter" data-level="5.2.6" data-path="pmetrics-input-files.html"><a href="pmetrics-input-files.html#FaR6"><i class="fa fa-check"></i><b>5.2.6</b> FA (bioavailability)</a></li>
<li class="chapter" data-level="5.2.7" data-path="pmetrics-input-files.html"><a href="pmetrics-input-files.html#lagR6"><i class="fa fa-check"></i><b>5.2.7</b> LAG time</a></li>
<li class="chapter" data-level="5.2.8" data-path="pmetrics-input-files.html"><a href="pmetrics-input-files.html#outR6"><i class="fa fa-check"></i><b>5.2.8</b> OUTputs</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="pmetrics-input-files.html"><a href="pmetrics-input-files.html#specifying-models-in-legacy"><i class="fa fa-check"></i><b>5.3</b> Specifying Models in Legacy</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="pmetrics-input-files.html"><a href="pmetrics-input-files.html#pri"><i class="fa fa-check"></i><b>5.3.1</b> Primary variables</a></li>
<li class="chapter" data-level="5.3.2" data-path="pmetrics-input-files.html"><a href="pmetrics-input-files.html#cov"><i class="fa fa-check"></i><b>5.3.2</b> Covariates</a></li>
<li class="chapter" data-level="5.3.3" data-path="pmetrics-input-files.html"><a href="pmetrics-input-files.html#sec"><i class="fa fa-check"></i><b>5.3.3</b> Secondary variables</a></li>
<li class="chapter" data-level="5.3.4" data-path="pmetrics-input-files.html"><a href="pmetrics-input-files.html#bol"><i class="fa fa-check"></i><b>5.3.4</b> Bolus inputs</a></li>
<li class="chapter" data-level="5.3.5" data-path="pmetrics-input-files.html"><a href="pmetrics-input-files.html#ini"><i class="fa fa-check"></i><b>5.3.5</b> Initial conditions</a></li>
<li class="chapter" data-level="5.3.6" data-path="pmetrics-input-files.html"><a href="pmetrics-input-files.html#Fa"><i class="fa fa-check"></i><b>5.3.6</b> Fa (bioavailability)</a></li>
<li class="chapter" data-level="5.3.7" data-path="pmetrics-input-files.html"><a href="pmetrics-input-files.html#lag"><i class="fa fa-check"></i><b>5.3.7</b> Lag time</a></li>
<li class="chapter" data-level="5.3.8" data-path="pmetrics-input-files.html"><a href="pmetrics-input-files.html#dif"><i class="fa fa-check"></i><b>5.3.8</b> Differential equations</a></li>
<li class="chapter" data-level="5.3.9" data-path="pmetrics-input-files.html"><a href="pmetrics-input-files.html#out"><i class="fa fa-check"></i><b>5.3.9</b> Outputs</a></li>
<li class="chapter" data-level="5.3.10" data-path="pmetrics-input-files.html"><a href="pmetrics-input-files.html#err"><i class="fa fa-check"></i><b>5.3.10</b> Error</a></li>
<li class="chapter" data-level="5.3.11" data-path="pmetrics-input-files.html"><a href="pmetrics-input-files.html#extra"><i class="fa fa-check"></i><b>5.3.11</b> Extra</a></li>
<li class="chapter" data-level="5.3.12" data-path="pmetrics-input-files.html"><a href="pmetrics-input-files.html#reserved"><i class="fa fa-check"></i><b>5.3.12</b> Reserved Names</a></li>
<li class="chapter" data-level="5.3.13" data-path="pmetrics-input-files.html"><a href="pmetrics-input-files.html#completeEx"><i class="fa fa-check"></i><b>5.3.13</b> Complete Example</a></li>
<li class="chapter" data-level="5.3.14" data-path="pmetrics-input-files.html"><a href="pmetrics-input-files.html#brief-fortran-tutorial"><i class="fa fa-check"></i><b>5.3.14</b> Brief Fortran Tutorial</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="how-to-use-r-and-pmetrics.html"><a href="how-to-use-r-and-pmetrics.html"><i class="fa fa-check"></i><b>6</b> How to use R and Pmetrics</a>
<ul>
<li class="chapter" data-level="6.1" data-path="how-to-use-r-and-pmetrics.html"><a href="how-to-use-r-and-pmetrics.html#setting-up-a-pmetrics-project"><i class="fa fa-check"></i><b>6.1</b> Setting up a Pmetrics project</a></li>
<li class="chapter" data-level="6.2" data-path="how-to-use-r-and-pmetrics.html"><a href="how-to-use-r-and-pmetrics.html#getting-the-required-inputs-to-run-pmetrics"><i class="fa fa-check"></i><b>6.2</b> Getting the required inputs to run Pmetrics</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="how-to-use-r-and-pmetrics.html"><a href="how-to-use-r-and-pmetrics.html#r6"><i class="fa fa-check"></i><b>6.2.1</b> R6</a></li>
<li class="chapter" data-level="6.2.2" data-path="how-to-use-r-and-pmetrics.html"><a href="how-to-use-r-and-pmetrics.html#legacy"><i class="fa fa-check"></i><b>6.2.2</b> Legacy</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="how-to-use-r-and-pmetrics.html"><a href="how-to-use-r-and-pmetrics.html#using-scripts-to-control-pmetrics"><i class="fa fa-check"></i><b>6.3</b> Using scripts to control Pmetrics</a></li>
<li class="chapter" data-level="6.4" data-path="how-to-use-r-and-pmetrics.html"><a href="how-to-use-r-and-pmetrics.html#loading-results-after-a-completed-run"><i class="fa fa-check"></i><b>6.4</b> Loading results after a completed run</a></li>
<li class="chapter" data-level="6.5" data-path="how-to-use-r-and-pmetrics.html"><a href="how-to-use-r-and-pmetrics.html#using-shiny-to-control-pmetrics"><i class="fa fa-check"></i><b>6.5</b> Using Shiny to control Pmetrics</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Pmetrics User Manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="pmetrics-input-files" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> Pmetrics Input Files</h1>
<div id="data.csv-files" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Data.csv Files</h2>
<p>Pmetrics accepts input as a spreadsheet “matrix” format. It is designed
for input of multiple records in a concise way. <strong>Please keep the number
of characters in the file name ≤ 8.</strong></p>
<div id="data-file-format" class="section level3" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> Data file format</h3>
<p>Files are in comma-separated-values (.csv) format. Examples of programs
that can save .csv files are any text editor (e.g. TextEdit on Mac,
Notepad on Windows) or spreadsheet program (e.g. Excel). Click on
hyperlinked items to see an explanation.</p>
<p><strong>IMPORTANT</strong>: The order, capitalization and names of the header and the
first 12 columns are fixed. All entries must be numeric, with the
exception of ID and “.” for non-required placeholder entries.</p>
<p><strong><em>POPDATA DEC_11</em></strong></p>
<table style="width:100%;">
<colgroup>
<col width="6%" />
<col width="6%" />
<col width="7%" />
<col width="5%" />
<col width="6%" />
<col width="6%" />
<col width="3%" />
<col width="7%" />
<col width="6%" />
<col width="7%" />
<col width="6%" />
<col width="5%" />
<col width="7%" />
<col width="7%" />
<col width="6%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">#ID</th>
<th align="right">EVID</th>
<th align="right">TIME</th>
<th align="right">DUR</th>
<th align="right">DOSE</th>
<th align="right">ADDL</th>
<th align="right">II</th>
<th align="right">INPUT</th>
<th align="left">OUT</th>
<th align="right">OUTEQ</th>
<th align="right">C0</th>
<th align="right">C1</th>
<th align="right">C2</th>
<th align="right">C3</th>
<th align="right">COV</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">GH</td>
<td align="right">1</td>
<td align="right">0.00</td>
<td align="right">0.0</td>
<td align="right">400</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">1</td>
<td align="left">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">10.0</td>
</tr>
<tr class="even">
<td align="left">GH</td>
<td align="right">0</td>
<td align="right">0.50</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="left">0.42</td>
<td align="right">1</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
</tr>
<tr class="odd">
<td align="left">GH</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="left">0.46</td>
<td align="right">1</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
</tr>
<tr class="even">
<td align="left">GH</td>
<td align="right">0</td>
<td align="right">2.00</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="left">2.47</td>
<td align="right">1</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
</tr>
<tr class="odd">
<td align="left">GH</td>
<td align="right">4</td>
<td align="right">0.00</td>
<td align="right">0.0</td>
<td align="right">150</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">1</td>
<td align="left">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
</tr>
<tr class="even">
<td align="left">GH</td>
<td align="right">1</td>
<td align="right">3.50</td>
<td align="right">0.5</td>
<td align="right">150</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">1</td>
<td align="left">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
</tr>
<tr class="odd">
<td align="left">GH</td>
<td align="right">0</td>
<td align="right">5.12</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="left">0.55</td>
<td align="right">1</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
</tr>
<tr class="even">
<td align="left">GH</td>
<td align="right">0</td>
<td align="right">24.00</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="left">0.52</td>
<td align="right">1</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
</tr>
<tr class="odd">
<td align="left">1423</td>
<td align="right">1</td>
<td align="right">0.00</td>
<td align="right">1.0</td>
<td align="right">400</td>
<td align="right">-1</td>
<td align="right">12</td>
<td align="right">1</td>
<td align="left">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">34.5</td>
</tr>
<tr class="even">
<td align="left">1423</td>
<td align="right">1</td>
<td align="right">0.10</td>
<td align="right">0.0</td>
<td align="right">100</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">2</td>
<td align="left">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
</tr>
<tr class="odd">
<td align="left">1423</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="left">-99</td>
<td align="right">1</td>
<td align="right">0.01</td>
<td align="right">0.1</td>
<td align="right">0.00</td>
<td align="right">0.000</td>
<td align="right">.</td>
</tr>
<tr class="even">
<td align="left">1423</td>
<td align="right">0</td>
<td align="right">2.00</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="left">0.38</td>
<td align="right">1</td>
<td align="right">0.01</td>
<td align="right">0.1</td>
<td align="right">0.00</td>
<td align="right">0.000</td>
<td align="right">.</td>
</tr>
<tr class="odd">
<td align="left">1423</td>
<td align="right">0</td>
<td align="right">2.00</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="right">.</td>
<td align="left">1.6</td>
<td align="right">2</td>
<td align="right">0.05</td>
<td align="right">0.2</td>
<td align="right">-0.11</td>
<td align="right">0.002</td>
<td align="right">.</td>
</tr>
</tbody>
</table>
<ul>
<li><p><strong><em>POPDATA DEC_11</em></strong> This is the fixed header for the file and must be
in the first line. It identifies the version. It is not the date of your
data file.</p></li>
<li><p><strong><em>#ID</em></strong> This field must be preceded by the “#” symbol to confirm
that this is the header row. It can be numeric or character and
identifies each individual. All rows must contain an ID, and all
records from one individual must be contiguous. Any subsequent row
that begins with “#” will be ignored, which is helpful if you want to
exclude data from the analysis, but preserve the integrity of the
original dataset, or to add comment lines. IDs should be 11 characters
or less but may be any alphanumeric combination. <strong>There can be at
most 800 subjects per run.</strong></p></li>
<li><p><strong><em>EVID</em></strong> This is the event ID field. It can be 0, 1, or 4. Every row
must have an entry.</p>
<ul>
<li><p>0 = observation</p></li>
<li><p>1 = input (e.g. dose)</p></li>
<li><p>2, 3 are currently unused</p></li>
<li><p>4 = reset, where all compartment values are set to 0 and the time
counter is reset to 0. This is useful when an individual has multiple
sampling episodes that are widely spaced in time with no new
information gathered. This is a dose event, so dose information needs
to be complete.</p></li>
</ul></li>
<li><p><strong><em>TIME</em></strong> This is the elapsed time in decimal hours since the first
event. It is not clock time (e.g. 09:30), although the <code>PMmatrixRelTime</code>
function can convert dates and clock times to decimal hours.
Every row must have an entry, and within a given ID, rows
must be sorted chronologically, earliest to latest.</p></li>
<li><p><strong><em>DUR</em></strong> This is the duration of an infusion in hours. If EVID=1,
there must be an entry, otherwise it is ignored. For a bolus (i.e. an
oral dose), set the value equal to 0.</p></li>
<li><p><strong><em>DOSE</em></strong> This is the dose amount. If EVID=1, there must be an entry,
otherwise it is ignored.</p></li>
<li><p><strong><em>ADDL</em></strong> This specifies the number of additional doses to give at
interval II. It may be missing for dose events (EVID=1 or 4), in which
case it is assumed to be 0. It is ignored for observation (EVID=0)
events. Be sure to adjust the time entry for the subsequent row, if
necessary, to account for the extra doses. If set to -1, the dose is
assumed to be given under steady-state conditions. ADDL=-1 can only be
used for the first dose event for a given subject, or an EVID=4 event,
as you cannot suddenly be at steady state in the middle of dosing
record, unless all compartments/times are reset to 0 (as for an EVID=4
event). To clarify further, when ADDL=-1, all compartments in the
model will contain the predicted amounts of drug at the end of the
100th II interval.</p></li>
<li><p><strong><em>II</em></strong> This is the interdose interval and is only relevant if ADDL
is not equal to 0, in which case it cannot be missing. If ADDL=0 or is
missing, II is ignored.</p></li>
<li><p><strong><em>INPUT</em></strong> This defines which input (i.e. drug) the DOSE corresponds
to. Inputs are defined in the model file.</p></li>
<li><p><strong><em>OUT</em></strong> This is the observation, or output value. If EVID=0, there
must be an entry; if missing, this must be coded as -99. It will be
ignored for any other EVID and therefore can be “.”. There can be at
most 150 observations for a given subject.</p></li>
<li><p><strong><em>OUTEQ</em></strong> This is the output equation number that corresponds to the
OUT value. Output equations are defined in the model file.</p></li>
<li><p><strong><em>C0, C1, C2, C3</em></strong> These are the coefficients for the assay error
polynomial for that observation. Each subject may have up to one set
of coefficients per output equation. If more than one set is detected
for a given subject and output equation, the last set will be used. If
there are no available coefficients, these cells may be left blank or
filled with “.” as a placeholder.</p></li>
<li><p><strong><em>COV</em></strong>... Any column after the assay error coefficients is assumed
to be a covariate, one column per covariate. The first row for any subject
must have a value for all covariates, since the first row is always a dose.
Covariate values are applied at the time of doses.</p></li>
</ul>
</div>
<div id="manipulation-of-csv-files" class="section level3" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> Manipulation of CSV files</h3>
<p>There are several functions in Pmetrics which are useful for either
converting other formats into Pmetrics data files, or checking Pmetrics
data files for errors and fixing some of them automatically.</p>
<ul>
<li><p><code>PMreadMatrix(filename,...)</code> This function simply reads <em>filename</em> and
creates a PMmatrix object in memory which can be plotted (see
<code>?plot.PMmatrix</code>) or otherwise analyzed.</p></li>
<li><p><code>PMcheck(filename / PMmatrix, model,...)</code> This function will check a .csv
file named <em>filename</em> or a PMmatrix data frame containing a previously
loaded .csv file (the output of <code>PMreadMatrix</code>) for errors which would
cause the analysis to fail. If a model file is provided, and the data
file has no errors, it will also check the model file for errors. If it
finds errors, it will generate a new errors.xlsx file with all errors
highlighted and commented so that you can find and correct them easily.
See <code>?PMcheck</code> for details in R.</p></li>
<li><p><code>PMwriteMatrix(data.frame, filename,...)</code> This function writes an
appropriate data.frame as a new .csv file. It will first check the
data.frame for errors via the <code>PMcheck()</code> function above, and writing will
fail if errors are detected. This can be overridden with <code>override=T</code>.</p></li>
<li><p><code>PMmatrixRelTime()</code> This function converts dates and clock times of
specified formats into relative times for use in the NPAG, IT2B and
Simulator engines. See <code>?PMmatrixRelTime</code> for details.</p></li>
<li><p><code>PMwrk2csv()</code> This function will convert old-style, single-drug USC*PACK
.wrk formatted files into Pmetrics data .csv files. Details are
available with <code>?PMwrk2csv</code> in R.</p></li>
<li><p><code>PMmb2csv()</code> This function will convert USC*PACK .mb files into Pmetrics
data .csv files. Details are available with <code>?PMmb2csv</code> in R.</p></li>
<li><p><code>NM2PM()</code> Although the structure of Pmetrics data files are similar to
NONMEM, there are some differences. This function attempts to
automatically convert to Pmetrics format. It has been tested on several
examples, but there are probably NONMEM files which will cause it to
crash. Running <code>PMcheck()</code> afterwards is a good idea. Details can be found
with <code>?NM2PM</code> in R.</p></li>
</ul>
</div>
</div>
<div id="specifying-models-in-r6" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Specifying Models in R6</h2>
<p><span class="r6">R6</span></p>
<p>In R6 Pmetrics, use the <code>PM_model</code> function to create models directly
in R. See <code>?PM_model</code> for help on this object class. Blocks in the legacy model.txt files which were delimited with the “#” character become lists or character vectors in R6.</p>
<p>The R6 model components are:</p>
<ul>
<li><a href="pmetrics-input-files.html#priR6">PRImary</a> (list)</li>
<li><a href="pmetrics-input-files.html#covR6">COVariate</a> (character vector)</li>
<li><a href="pmetrics-input-files.html#secR6">SECondary</a> (character vector)</li>
<li><a href="pmetrics-input-files.html#bolR6">BOLus</a> (character vector)</li>
<li><a href="pmetrics-input-files.html#iniR6">INItial conditions</a> (character vector)</li>
<li><a href="pmetrics-input-files.html#FaR6">F (bioavailability)</a> (character vector)</li>
<li><a href="pmetrics-input-files.html#lagR6">LAG time</a> (character vector)</li>
<li><a href="#diffR6">DIFferential equations</a> (list)</li>
<li><a href="pmetrics-input-files.html#outR6">OUTputs</a> (list)</li>
</ul>
<div id="priR6" class="section level3" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> PRImary variables</h3>
<p>Primary variables are the model parameters that are to be estimated by
Pmetrics or are designated as fixed parameters with user specified
values. It should be a list of variable names, one name to a line.
Variable names should be 11 characters or fewer. Some variable names are
<a href="pmetrics-input-files.html#reserved">reserved</a> for use by Pmetrics and cannot be used as
primary variable names. <strong>The number of primary variables must be
between 2 and 32, with at most 30 random or 20 fixed.</strong></p>
<p>Each variable can be specified by <code>range</code> or <code>msd</code>. The first defines the absolute search space for that parameter for NPAG/NPOD. For IT2B/RPEM, it defines the mean of the piror as the midpoint of the range, and the range covers 6 standard deviations, e.g. ±3 SD above and below the mean, or 99.7% of the piror distribution. <code>msd</code> is the companion function that specifies a mean and SD in IT2B and RPEM. For NPAG/NPOD, it will be converted in to a range in the reverse fashion as described for <code>range</code>. For both specifying functions, <code>gtz</code> is an argument to force the parameter value to be positive, i.e. <code>gtz=T</code>, which is the default. To allow negative parameters, set <code>gtz=F</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="pmetrics-input-files.html#cb6-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">PM_model</span>(<span class="fu">list</span>(</span>
<span id="cb6-2"><a href="pmetrics-input-files.html#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">pri =</span> <span class="fu">list</span>(</span>
<span id="cb6-3"><a href="pmetrics-input-files.html#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ke =</span> <span class="fu">range</span>(<span class="dv">0</span>,<span class="dv">5</span>),</span>
<span id="cb6-4"><a href="pmetrics-input-files.html#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">V =</span> <span class="fu">msd</span>(<span class="dv">100</span>,<span class="dv">20</span>),</span>
<span id="cb6-5"><a href="pmetrics-input-files.html#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">eff =</span> <span class="fu">range</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>,<span class="at">gtz=</span>F)</span>
<span id="cb6-6"><a href="pmetrics-input-files.html#cb6-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-7"><a href="pmetrics-input-files.html#cb6-7" aria-hidden="true" tabindex="-1"></a>))</span></code></pre></div>
</div>
<div id="covR6" class="section level3" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> COVariates</h3>
<p>Covariates are subject specific data, such as body weight, contained in
the data .csv file. The covariate names, which are the column names in
the data file, must be declared, even if not used in the model object. Once declared, they can be used in secondary variable
and differential equations. The order and names should be the same as in the data file.</p>
<p>Covariates are applied at each dose event. The first dose event for each
subject must have a value for every covariate in the data file.</p>
<p><span class="update">Update</span> By default, missing covariate values for subsequent dose events are linearly interpolated between existing values, or carried forward if the first value is the only non-missing entry.</p>
<p>To specify a new covariate value at a time other than a dose, enter a dose event in the data file with 0 dose amount and the new covariate value.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="pmetrics-input-files.html#cb7-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">PM_model</span>(<span class="fu">list</span>(</span>
<span id="cb7-2"><a href="pmetrics-input-files.html#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">pri =</span> <span class="fu">list</span>(...),</span>
<span id="cb7-3"><a href="pmetrics-input-files.html#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cov =</span> <span class="fu">c</span>(<span class="st">&quot;wt&quot;</span>,<span class="st">&quot;age&quot;</span>)</span>
<span id="cb7-4"><a href="pmetrics-input-files.html#cb7-4" aria-hidden="true" tabindex="-1"></a>))</span></code></pre></div>
</div>
<div id="secR6" class="section level3" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> SECondary variables</h3>
<p>Secondary variables are those that are defined by equations that are
combinations of primary, covariates, and other secondary variables. If
using other secondary variables, define them first within this block.
Equation syntax must be Fortran. Specify each variable equation as a character vector. It is permissible to have conditional
statements, but because expressions in this block are translated into
variable declarations in Fortran, expressions other than of the form "X = function(Y)" must be on a new line, prefixed by "&amp;" and contain only variables which have been previously defined in the Primary, Covariate, or Secondary blocks.</p>
<p>In the example below, V0 is the primary parameter which will be estimated, but internally, the model uses V as V0*wt, unless age is &gt;18, in which case weight is capped at 75 kg.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="pmetrics-input-files.html#cb8-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">PM_model</span>(<span class="fu">list</span>(</span>
<span id="cb8-2"><a href="pmetrics-input-files.html#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">pri =</span> <span class="fu">list</span>(</span>
<span id="cb8-3"><a href="pmetrics-input-files.html#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ke =</span> <span class="fu">range</span>(<span class="dv">0</span>,<span class="dv">5</span>),</span>
<span id="cb8-4"><a href="pmetrics-input-files.html#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">V0 =</span> <span class="fu">msd</span>(<span class="dv">10</span>,<span class="dv">3</span>),</span>
<span id="cb8-5"><a href="pmetrics-input-files.html#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">eff =</span> <span class="fu">range</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>,<span class="at">gtz=</span>F)</span>
<span id="cb8-6"><a href="pmetrics-input-files.html#cb8-6" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb8-7"><a href="pmetrics-input-files.html#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">cov =</span> <span class="fu">c</span>(<span class="st">&quot;wt&quot;</span>,<span class="st">&quot;age&quot;</span>),</span>
<span id="cb8-8"><a href="pmetrics-input-files.html#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">sec =</span> <span class="fu">c</span>(</span>
<span id="cb8-9"><a href="pmetrics-input-files.html#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;V = V0*wt&quot;</span>,</span>
<span id="cb8-10"><a href="pmetrics-input-files.html#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;&amp;IF(age &gt;18) V = V0 * 75&quot;</span></span>
<span id="cb8-11"><a href="pmetrics-input-files.html#cb8-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-12"><a href="pmetrics-input-files.html#cb8-12" aria-hidden="true" tabindex="-1"></a>))</span></code></pre></div>
</div>
<div id="bolR6" class="section level3" number="5.2.4">
<h3><span class="header-section-number">5.2.4</span> BOLus inputs</h3>
<p>By default, inputs with DUR (duration) of 0 in the data .csv file are
"delivered" instantaneously to the model compartment equal to the
input number, i.e. input 1 goes to compartment 1, input 2 goes to
compartment 2, etc. This can be overridden with NBOLUS(input number) =
compartment number.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="pmetrics-input-files.html#cb9-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">PM_model</span>(<span class="fu">list</span>(</span>
<span id="cb9-2"><a href="pmetrics-input-files.html#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">bol =</span> <span class="st">&quot;NBCOMP(1) = 2&quot;</span></span>
<span id="cb9-3"><a href="pmetrics-input-files.html#cb9-3" aria-hidden="true" tabindex="-1"></a>))</span></code></pre></div>
</div>
<div id="iniR6" class="section level3" number="5.2.5">
<h3><span class="header-section-number">5.2.5</span> INItial conditions</h3>
<p>By default, all model compartments have zero amounts at time 0. This can be changed by specifying the compartment amount as X(.) = expression, where "." is the compartment number. Primary and secondary variables and covariates may be used in the expression, as can conditional statements in Fortran code. An "&amp;" continuation prefix is not necessary in this block for any statement, although if present, will be ignored.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="pmetrics-input-files.html#cb10-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">PM_model</span>(<span class="fu">list</span>(</span>
<span id="cb10-2"><a href="pmetrics-input-files.html#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">pri =</span> <span class="at">pri =</span> <span class="fu">list</span>(</span>
<span id="cb10-3"><a href="pmetrics-input-files.html#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ke =</span> <span class="fu">range</span>(<span class="dv">0</span>,<span class="dv">5</span>),</span>
<span id="cb10-4"><a href="pmetrics-input-files.html#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">V =</span> <span class="fu">msd</span>(<span class="dv">100</span>,<span class="dv">30</span>),</span>
<span id="cb10-5"><a href="pmetrics-input-files.html#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">IC3 =</span> <span class="fu">range</span>(<span class="dv">0</span>,<span class="dv">1000</span>)</span>
<span id="cb10-6"><a href="pmetrics-input-files.html#cb10-6" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb10-7"><a href="pmetrics-input-files.html#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">cov =</span> <span class="fu">c</span>(<span class="st">&quot;wt&quot;</span>,<span class="st">&quot;age&quot;</span>,<span class="st">&quot;IC2&quot;</span>),</span>
<span id="cb10-8"><a href="pmetrics-input-files.html#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">ini =</span> <span class="fu">c</span>(</span>
<span id="cb10-9"><a href="pmetrics-input-files.html#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;X(2) = IC2*V&quot;</span>,</span>
<span id="cb10-10"><a href="pmetrics-input-files.html#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;X(3) = IC3&quot;</span></span>
<span id="cb10-11"><a href="pmetrics-input-files.html#cb10-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-12"><a href="pmetrics-input-files.html#cb10-12" aria-hidden="true" tabindex="-1"></a>))</span></code></pre></div>
<p>In the example above, IC is a covariate with the measured trough
concentration prior to an observed dose and IC3 is a fitted primary parameter specifying an initial amount in unobserved compartment 3.</p>
<p>In the first case, the initial condition for compartment 2 becomes the
value of the IC covariate (defined in <code>cov</code> list) multiplied by
the current estimate of V during each iteration. This is useful when a
subject has been taking a drug as an outpatient, and comes in to the lab for PK sampling, with measurement of a concentration immediately prior to a witnessed dose, which is in turn followed by more sampling. In this case, IC or any other covariate can be set to the initial measured concentration, and if V is the volume of compartment 2, the initial condition (amount) in compartment 2 will now be set to the measured concentration of drug multiplied by the estimated volume for each iteration until convergence.</p>
<p>In the second case, the initial condition for compartment 3 becomes
another variable, IC3 defined in the <code>pri</code> list, to fit in the
model, given the observed data.</p>
</div>
<div id="FaR6" class="section level3" number="5.2.6">
<h3><span class="header-section-number">5.2.6</span> FA (bioavailability)</h3>
<p>Specify the bioavailability term, if present. Use the form FA(.) =
expression, where "." is the input number. Primary and secondary
variables and covariates may be used in the expression, as can
conditional statements in Fortran code. An "&amp;" continuation prefix is not necessary in this block for any statement, although if present, will be ignored.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="pmetrics-input-files.html#cb11-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">PM_model</span>(<span class="fu">list</span>(</span>
<span id="cb11-2"><a href="pmetrics-input-files.html#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">pri =</span> <span class="at">pri =</span> <span class="fu">list</span>(</span>
<span id="cb11-3"><a href="pmetrics-input-files.html#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ke =</span> <span class="fu">range</span>(<span class="dv">0</span>,<span class="dv">5</span>),</span>
<span id="cb11-4"><a href="pmetrics-input-files.html#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">V =</span> <span class="fu">msd</span>(<span class="dv">100</span>,<span class="dv">30</span>),</span>
<span id="cb11-5"><a href="pmetrics-input-files.html#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">FA1 =</span> <span class="fu">range</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb11-6"><a href="pmetrics-input-files.html#cb11-6" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb11-7"><a href="pmetrics-input-files.html#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">fa =</span> <span class="st">&quot;FA(1) = FA1&quot;</span></span>
<span id="cb11-8"><a href="pmetrics-input-files.html#cb11-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-9"><a href="pmetrics-input-files.html#cb11-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="lagR6" class="section level3" number="5.2.7">
<h3><span class="header-section-number">5.2.7</span> LAG time</h3>
<p>Specify the lag term, if present, which is the delay after an absorbed
dose before observed concentrations. Use the form TLAG(.) = expression, where "." is the input number. Primary and secondary variables and covariates may be used in the expression, as can conditional statements in Fortran code. An "&amp;" continuation prefix is not necessary in this block for any statement, although if present, will be ignored.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="pmetrics-input-files.html#cb12-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">PM_model</span>(<span class="fu">list</span>(</span>
<span id="cb12-2"><a href="pmetrics-input-files.html#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">pri =</span> <span class="at">pri =</span> <span class="fu">list</span>(</span>
<span id="cb12-3"><a href="pmetrics-input-files.html#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ke =</span> <span class="fu">range</span>(<span class="dv">0</span>,<span class="dv">5</span>),</span>
<span id="cb12-4"><a href="pmetrics-input-files.html#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">V =</span> <span class="fu">msd</span>(<span class="dv">100</span>,<span class="dv">30</span>),</span>
<span id="cb12-5"><a href="pmetrics-input-files.html#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">lag1 =</span> <span class="fu">range</span>(<span class="dv">0</span>,<span class="dv">4</span>)</span>
<span id="cb12-6"><a href="pmetrics-input-files.html#cb12-6" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb12-7"><a href="pmetrics-input-files.html#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">lag =</span> <span class="st">&quot;TLAG(1) = lag1&quot;</span></span>
<span id="cb12-8"><a href="pmetrics-input-files.html#cb12-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-9"><a href="pmetrics-input-files.html#cb12-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div id="differential-equations" class="section level4" number="5.2.7.1">
<h4><span class="header-section-number">5.2.7.1</span> Differential equations</h4>
<p>Specify a model in terms of ordinary differential equations, in Fortran format. XP(.) is the notation for dX(.)/dt, where "." is the
compartment number. X(.) is the amount in the compartment. <strong>There can
be a maximum of 20 such equations.</strong></p>
<p>Specify equations as elements in a list, with XP(1) replaced by XP1, for example, to name the list, and the list value a character vector in Fortran.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="pmetrics-input-files.html#cb13-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">PM_model</span>(<span class="fu">list</span>(</span>
<span id="cb13-2"><a href="pmetrics-input-files.html#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">pri =</span> <span class="at">pri =</span> <span class="fu">list</span>(</span>
<span id="cb13-3"><a href="pmetrics-input-files.html#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ka =</span> <span class="fu">range</span>(<span class="dv">0</span>,<span class="dv">5</span>),</span>
<span id="cb13-4"><a href="pmetrics-input-files.html#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ke =</span> <span class="fu">range</span>(<span class="dv">0</span>,<span class="dv">5</span>),</span>
<span id="cb13-5"><a href="pmetrics-input-files.html#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">V =</span> <span class="fu">msd</span>(<span class="dv">100</span>,<span class="dv">30</span>),</span>
<span id="cb13-6"><a href="pmetrics-input-files.html#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Kcp =</span> <span class="fu">range</span>(<span class="dv">0</span>,<span class="dv">5</span>),</span>
<span id="cb13-7"><a href="pmetrics-input-files.html#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Kpc =</span> <span class="fu">range</span>(<span class="dv">0</span>,<span class="dv">5</span>)</span>
<span id="cb13-8"><a href="pmetrics-input-files.html#cb13-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb13-9"><a href="pmetrics-input-files.html#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">diff =</span> <span class="fu">list</span>(</span>
<span id="cb13-10"><a href="pmetrics-input-files.html#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">xp1 =</span> <span class="st">&quot;-Ka * X(1)&quot;</span>,</span>
<span id="cb13-11"><a href="pmetrics-input-files.html#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">xp2 =</span> <span class="st">&quot;RATEIV(1) + Ka * X(1) - (Ke + Kcp) * X(2) + Kpc * X(3)&quot;</span>,</span>
<span id="cb13-12"><a href="pmetrics-input-files.html#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">xp3 =</span> <span class="st">&quot;Kcp * X(2) - Kpc * X(3)&quot;</span></span>
<span id="cb13-13"><a href="pmetrics-input-files.html#cb13-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-14"><a href="pmetrics-input-files.html#cb13-14" aria-hidden="true" tabindex="-1"></a>))</span></code></pre></div>
<p>RATEIV(1) is the notation to indicate an infusion of input 1 (typically drug 1). The duration of the infusion and total dose is defined in the data.csv file. <strong>Up to 7 inputs are currently
allowed.</strong> These can be used in the model file as RATEIV(1), RATEIV(2), etc. The compartments for receiving the inputs of oral (bolus) doses are defined in the <code>bol</code> list, but can be accessed by using the B(1), B(2), etc notation in equations.</p>
</div>
</div>
<div id="outR6" class="section level3" number="5.2.8">
<h3><span class="header-section-number">5.2.8</span> OUTputs</h3>
<p>Output equations are in Fortran format. Outputs are of the form Y(.) =
expression, where "." is the output equation number. Primary and
secondary variables and covariates may be used in the expression, as can conditional statements in Fortran code. An "&amp;" continuation prefix is not necessary in this block for any statement, although if present, will be ignored. <strong>There can be a maximum of 6 outputs.</strong></p>
<p>They are referred
to as Y(1), Y(2), etc. These equations may also define a model
explicitly as a function of primary and secondary variables and
covariates.</p>
<p>The <code>out</code> list is a series of nested lists. The outer list defines all the outputs. The next level defines each output equation. Within the equation list is the equation and the error model. Within the error model for that output, is the last list comprising model and assay error specifications.</p>
<ul>
<li>To name output equations, Y(1) is replaced by Y1</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="pmetrics-input-files.html#cb14-1" aria-hidden="true" tabindex="-1"></a>out <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb14-2"><a href="pmetrics-input-files.html#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y1 =</span> <span class="fu">list</span>(...)</span>
<span id="cb14-3"><a href="pmetrics-input-files.html#cb14-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<ul>
<li>The output equation is a character vector followed by an error list.</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="pmetrics-input-files.html#cb15-1" aria-hidden="true" tabindex="-1"></a>out <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb15-2"><a href="pmetrics-input-files.html#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y1 =</span> <span class="fu">list</span>(</span>
<span id="cb15-3"><a href="pmetrics-input-files.html#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;X(1)/V&quot;</span>,</span>
<span id="cb15-4"><a href="pmetrics-input-files.html#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">err =</span> <span class="fu">list</span>(...)</span>
<span id="cb15-5"><a href="pmetrics-input-files.html#cb15-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-6"><a href="pmetrics-input-files.html#cb15-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<ul>
<li>The error model for an output equation has two elements. The first is the <code>model</code> error, which can be one of three functions: <code>proportional</code>, <code>additive</code>, or <code>combination</code>. The arguments to these functions are a number and optionally <code>fixed</code>, which defaults to <code>FALSE</code>. If <code>fixed</code> is <code>FALSE</code>, the number serves as the starting estimate for the model error. If <code>fixed</code> is <code>TRUE</code>, the number serves as the model error, with no estimation. Note that you can only fix <span class="math inline">\(\lambda\)</span> currently to zero.</li>
</ul>
<p>The second element is the <code>assay</code> error model. It is a vector of 4 numbers that define a polynomial equation to permit calculation of the standard deviation of an observation, based on the noise of the asaay. The four terms estimate SD according to the folowing equation: <span class="math inline">\(C0 + C1 * [obs] + C2 * [obs]^2 + C3 * [obs]^3\)</span> and <span class="math inline">\([obs]\)</span> is the observation. The values for the coefficients should ideally come from the analytic lab in the form of inter-run standard deviations or coefficients of variation at standard concentrations. You can use the Pmetrics function <code>makeErrorPoly</code> to choose the best set of coefficients that fit the data from the
laboratory. Alternatively, if you have no information about the assay,
you can use the Pmetrics ERRrun engine as an argument to the <code>run</code> function for <code>PM_fit</code> objects (i.e., <code>$run(engine="err")</code>) to estimate the coefficients
from the data. Finally, you can use a generic set of coefficients. We
recommend that as a start, <span class="math inline">\(C0\)</span> be set to half of the lowest
concentration in the dataset and <span class="math inline">\(C1\)</span> be set to 0.1. <span class="math inline">\(C2\)</span> and <span class="math inline">\(C3\)</span> can
be 0.</p>
<p>The proportional model weights each observation by <span class="math inline">\(1/(\gamma * SD)^2\)</span>, where <span class="math inline">\(\gamma\)</span> is either fixed or estimated. The additive model weights each observation by <span class="math inline">\(1/(\lambda + SD)^2\)</span>, where <span class="math inline">\(\lambda\)</span> is either fixed or estimated. The combination model uses <span class="math inline">\(1/((\gamma * SD)^2 + (\lambda + SD)^2)\)</span>.</p>
<p>In the proportional model, <span class="math inline">\(\gamma\)</span> is a scalar on assay SD. In general,
well-designed and executed studies and models with low mis-specification will have data with <span class="math inline">\(\gamma\)</span> values approaching 1. Values &lt;1 suggest over inflated assay noise. Poor quality, noisy data will result in <span class="math inline">\(\gamma\)</span> of 5 or more. A good starting value for <span class="math inline">\(\gamma\)</span> is usually 5, and sometimes 10 if data are particularly complex or noisy.</p>
<p>In the additive model, <span class="math inline">\(\lambda\)</span> is additive to assay SD. In general,
well-designed and executed studies and models with low mis-specification will have data with <span class="math inline">\(\lambda\)</span> values approaching 0. Values of 0 may suggest over inflated assay noise. Poor quality, noisy data will result in <span class="math inline">\(\lambda\)</span> of <span class="math inline">\(5*C0\)</span> or more. A good starting value for <span class="math inline">\(\lambda\)</span> is usually <span class="math inline">\(3*C0\)</span>. Note, that <span class="math inline">\(C0\)</span>
should generally not be 0, as it represents machine noise (e.g. HPLC or
mass spectrometer) that is always present.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="pmetrics-input-files.html#cb16-1" aria-hidden="true" tabindex="-1"></a>out <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb16-2"><a href="pmetrics-input-files.html#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y1 =</span> <span class="fu">list</span>(</span>
<span id="cb16-3"><a href="pmetrics-input-files.html#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;X(1)/V&quot;</span>,</span>
<span id="cb16-4"><a href="pmetrics-input-files.html#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">err =</span> <span class="fu">list</span>(</span>
<span id="cb16-5"><a href="pmetrics-input-files.html#cb16-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">model =</span> <span class="fu">proportional</span>(<span class="dv">1</span>),</span>
<span id="cb16-6"><a href="pmetrics-input-files.html#cb16-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">assay =</span> <span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.1</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb16-7"><a href="pmetrics-input-files.html#cb16-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb16-8"><a href="pmetrics-input-files.html#cb16-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-9"><a href="pmetrics-input-files.html#cb16-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="pmetrics-input-files.html#cb17-1" aria-hidden="true" tabindex="-1"></a>out <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb17-2"><a href="pmetrics-input-files.html#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y1 =</span> <span class="fu">list</span>(</span>
<span id="cb17-3"><a href="pmetrics-input-files.html#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;X(1)/V&quot;</span>,</span>
<span id="cb17-4"><a href="pmetrics-input-files.html#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">err =</span> <span class="fu">list</span>(</span>
<span id="cb17-5"><a href="pmetrics-input-files.html#cb17-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">model =</span> <span class="fu">additive</span>(<span class="dv">1</span>, <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-6"><a href="pmetrics-input-files.html#cb17-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">assay =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb17-7"><a href="pmetrics-input-files.html#cb17-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-8"><a href="pmetrics-input-files.html#cb17-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>More complete examples.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="pmetrics-input-files.html#cb18-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">PM_model</span>(<span class="fu">list</span>(</span>
<span id="cb18-2"><a href="pmetrics-input-files.html#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">pri =</span> <span class="at">pri =</span> <span class="fu">list</span>(</span>
<span id="cb18-3"><a href="pmetrics-input-files.html#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ke =</span> <span class="fu">range</span>(<span class="dv">0</span>,<span class="dv">5</span>),</span>
<span id="cb18-4"><a href="pmetrics-input-files.html#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">V =</span> <span class="fu">msd</span>(<span class="dv">100</span>,<span class="dv">30</span>),</span>
<span id="cb18-5"><a href="pmetrics-input-files.html#cb18-5" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb18-6"><a href="pmetrics-input-files.html#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">out =</span> <span class="fu">list</span>(</span>
<span id="cb18-7"><a href="pmetrics-input-files.html#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y1 =</span> <span class="fu">list</span>(</span>
<span id="cb18-8"><a href="pmetrics-input-files.html#cb18-8" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;X(1)/V&quot;</span>,</span>
<span id="cb18-9"><a href="pmetrics-input-files.html#cb18-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">err =</span> <span class="fu">list</span>(</span>
<span id="cb18-10"><a href="pmetrics-input-files.html#cb18-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">model =</span> <span class="fu">proportional</span>(<span class="dv">5</span>),</span>
<span id="cb18-11"><a href="pmetrics-input-files.html#cb18-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">assay =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb18-12"><a href="pmetrics-input-files.html#cb18-12" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb18-13"><a href="pmetrics-input-files.html#cb18-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-14"><a href="pmetrics-input-files.html#cb18-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-15"><a href="pmetrics-input-files.html#cb18-15" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb18-16"><a href="pmetrics-input-files.html#cb18-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-17"><a href="pmetrics-input-files.html#cb18-17" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">PM_model</span>(<span class="fu">list</span>(</span>
<span id="cb18-18"><a href="pmetrics-input-files.html#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">pri =</span> <span class="at">pri =</span> <span class="fu">list</span>(</span>
<span id="cb18-19"><a href="pmetrics-input-files.html#cb18-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">kin =</span> <span class="fu">range</span>(<span class="dv">0</span>,<span class="dv">5</span>),</span>
<span id="cb18-20"><a href="pmetrics-input-files.html#cb18-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">kout =</span> <span class="fu">range</span>(<span class="dv">0</span>,<span class="dv">5</span>),</span>
<span id="cb18-21"><a href="pmetrics-input-files.html#cb18-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">tpd =</span> <span class="fu">range</span>(<span class="dv">0</span>,<span class="dv">5</span>),</span>
<span id="cb18-22"><a href="pmetrics-input-files.html#cb18-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">V =</span> <span class="fu">msd</span>(<span class="dv">100</span>,<span class="dv">30</span>),</span>
<span id="cb18-23"><a href="pmetrics-input-files.html#cb18-23" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb18-24"><a href="pmetrics-input-files.html#cb18-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">sec =</span> <span class="st">&quot;RES = B(1) * KIN/(KIN-KOUT) * (EXP(-KOUT*TPD)-EXP(-KIN*TPD))&quot;</span>,</span>
<span id="cb18-25"><a href="pmetrics-input-files.html#cb18-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">out =</span> <span class="fu">list</span>(</span>
<span id="cb18-26"><a href="pmetrics-input-files.html#cb18-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">y1 =</span> <span class="fu">list</span>(</span>
<span id="cb18-27"><a href="pmetrics-input-files.html#cb18-27" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;RES/V&quot;</span>,</span>
<span id="cb18-28"><a href="pmetrics-input-files.html#cb18-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">err =</span> <span class="fu">list</span>(</span>
<span id="cb18-29"><a href="pmetrics-input-files.html#cb18-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">model =</span> <span class="fu">combination</span>(<span class="fl">0.4</span>,<span class="dv">3</span>) <span class="co">#additive, proportional</span></span>
<span id="cb18-30"><a href="pmetrics-input-files.html#cb18-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">assay =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.15</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb18-31"><a href="pmetrics-input-files.html#cb18-31" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb18-32"><a href="pmetrics-input-files.html#cb18-32" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-33"><a href="pmetrics-input-files.html#cb18-33" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-34"><a href="pmetrics-input-files.html#cb18-34" aria-hidden="true" tabindex="-1"></a>))</span></code></pre></div>
<p>This last example is known as the Bateman equation for a model with
linear absorption (KIN) into and elimination (KOUT) from a central
compartment, and a time post-dose (TPD) or lag time. Here B(1) is the
oral bolus dosing vector for drug 1, and V is the volume of the central
compartment.</p>
</div>
</div>
<div id="specifying-models-in-legacy" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Specifying Models in Legacy</h2>
<p><span class="legacy">Legacy</span></p>
<p>In legacy Pmetrics, models are text files that are ultimately translated into Fortran text files with a header version of TSMULT...</p>
<p>However, after Pmetrics version 0.30, we adopted a
very simple user format that Pmetrics will use to generate the Fortran
code automatically for you. Version 0.4 additionally eliminates the
previously separate instruction file. A model library is available on
our website at
<a href="http://www.lapk.org/pmetrics.php">http://www.lapk.org/pmetrics.php</a>.</p>
<p><strong>Naming your model files.</strong> The default model file name is “model.txt,”
but you can call them whatever you wish. However, <strong>please keep the
number of characters in the model file name ≤ 8</strong>. When you use a model
file in NPrun(), ITrun(), ERRrun(), or SIMrun(), Pmetrics will make a
Fortran model file of the same name, temporarily renaming your file. At
the end of the run, your original model file will be in the /inputs
subfolder of the run folder, and the generated Fortran model file will
be called “model.for” and moved to the /etc subfolder of the run folder.
If your model is called “mymodel.txt”, then the Fortran file will be
“mymodel.for”.</p>
<p>You can still use appropriate Fortran model files directly, but we
suggest you keep the .for extension for all Fortran files to avoid
confusion with the new format. If you use a .for file as your model, you
will have to specify its name explicitly in the NPrun(), ITrun,
ERRrun(), or SIMrun() command, since the default model name again is
“model.txt.” If you use a .for file directly, it will be in the /inputs
subfolder of the run folder, not in /etc, since you did not use the
simpler template as your model file.</p>
<p><strong>Structure of model files.</strong> The new model file is a text file with 11
blocks, each marked by "#" followed by a header tag. Only details which are different than the R6 documentation are included below.</p>
<ul>
<li><a href="pmetrics-input-files.html#pri">#PRImary variables</a></li>
<li><a href="pmetrics-input-files.html#cov">#COVariates</a></li>
<li><a href="pmetrics-input-files.html#sec">#SECcondary variables</a></li>
<li><a href="pmetrics-input-files.html#bol">#BOLus inputs</a></li>
<li><a href="pmetrics-input-files.html#ini">#INItial conditions</a></li>
<li><a href="#fa">#Fa (bioavailability)</a></li>
<li><a href="pmetrics-input-files.html#lag">#LAG time</a></li>
<li><a href="pmetrics-input-files.html#dif">#DIFferential equations</a></li>
<li><a href="pmetrics-input-files.html#out">#OUTputs</a></li>
<li><a href="pmetrics-input-files.html#err">#ERRor</a></li>
<li><a href="pmetrics-input-files.html#extra">#EXTra</a></li>
</ul>
<p>For each header, only the capital letters are required for recognition
by Pmetrics. The blocks can be in any order, and header names are
case-insensitive (i.e. the capitalization here is just to show which
letters are required). Fortran is also case-insensitive, so in variable
names and expressions case is ignored. Details of each block are next,
followed by a <a href="pmetrics-input-files.html#completeEx">complete example</a>.</p>
<p>Important: Sometimes it is important to preserve spacing and formatting in Fortran code that you might insert into blocks, particularly the #EXTRA block. If you wish to do this, insert [format] and [/format] before and after any code that you wish to reproduce verbatim with spacing in the fortran model file.</p>
<p>Comments: You can insert comments into your model text file by starting a line with a capital “C” followed by a space. These lines will be removed/ignored in the final fortran code.</p>
<div id="pri" class="section level3" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Primary variables</h3>
<p>Primary variables are the model parameters that are to be estimated by
Pmetrics or are designated as fixed parameters with user specified
values. It should be a list of variable names, one name to a line.
Variable names should be 11 characters or fewer. Some variable names are <a href="pmetrics-input-files.html#reserved">reserved</a> for use by Pmetrics and cannot be used as
primary variable names. <strong>The number of primary variables must be
between 2 and 32, with at most 30 random or 20 fixed.</strong></p>
<p>On each row, following the variable name, include the range for the
parameter that defines the search space. These ranges behave slightly
differently for NPAG, IT2B, and the simulator.</p>
<ul>
<li><p>For all engines, the format of the limits is <em>min, max</em>. A single
value will indicate that the parameter is to be fixed but unknown in
the population, i.e. the value is taken as the starting point for
the optimization, but the final value will depend on the model and
data and will be the same across the population. A single value
followed by an “!” will indicate that this value is to be held
constant (i.e. fixed and known) across the population, and not to be
estimated.</p></li>
<li><p>For <strong>NPAG</strong>, when <em>min/max</em> limits are specified, they are
absolute, i.e. the algorithm will not search outside this range.</p></li>
<li><p>For <strong>IT2B</strong>, the range defines the Bayesian prior distribution of
the parameter values for cycle 1. For each parameter, the mean of
the Bayesian prior distribution is taken as the middle of the range,
and the standard deviation is <em>xsig</em>*range (see <a href="\l"><u>IT2B
runs</u></a>). Adding a plus sign (+) to a line will
prevent that parameter from being assigned negative values. NPAG and
the simulator will ignore the pluses as the ranges are absolute for
these engines. Note that prior to version 1.5.0, this used to be an
exclamation point (!) but to be consistent throughout the model
file, the exclamation point is now used when fixed values are
desired.</p></li>
<li><p>The <strong>simulator</strong> will ignore the ranges with the default value of
NULL for the <em>limits</em> argument. If the simulator <em>limits</em> argument
is set to NA, which will mean that these ranges will be used as the
limits to truncate the simulation (see <a href="\l"><u>Simulator
Runs</u></a>).</p></li>
</ul>
Example:
<div class="script">
<p>#Pri<br />
KE, +0, 5<br />
V, 0.01, 100<br />
KA, 0, 5<br />
KCP, 5<br />
KPC, 0 , 5<br />
Tlag1, 0, 2<br />
IC3, 0, 10000<br />
FA1, 0.5!</p>
</div>
</div>
<div id="cov" class="section level3" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> Covariates</h3>
<p>By default, missing covariate values for subsequent dose events are
linearly interpolated between existing values, or carried forward if the
first value is the only non-missing entry. To suppress interpolation and
carry forward the previous value in a piece-wise constant fashion,
include an exclamation point (!) in any declaration line.</p>
<p><strong>Note</strong> that any covariate relationship to any parameter may be
described as the user wishes by mathematical equations and Fortran code,
allowing for exploration of complex, non-linear, time-dependent, and/or
conditional relationships. This is accomplished in the <a href="pmetrics-input-files.html#sec">#Sec</a> block.</p>
<p>Example:</p>
<div class="script">
<p>#Cov<br />
wt<br />
cyp<br />
IC!</p>
</div>
<p>where IC will be piece-wise constant and the other two will be linearly
interpolated for missing values.</p>
</div>
<div id="sec" class="section level3" number="5.3.3">
<h3><span class="header-section-number">5.3.3</span> Secondary variables</h3>
<p>Equation syntax must be Fortran. It is permissible to have conditional
statements, but because expressions in this block are translated into
variable declarations in Fortran, expressions other than of the form "X
= function(Y)" must be prefixed by a "&amp;" and contain only variables
which have been previously defined in the Primary, Covariate, or
Secondary blocks. Note that prior to version 1.5.0, the continuation
symbol was “+” before each line, but to avoid confusion with the use of
“+” in the Primary block for IT2B models, and to be consistent with
Fortran notation, the “&amp;” is used henceforth.</p>
<p>Example:</p>
<div class="script">
<p>#Sec<br />
CL = Ke * V * wt**0.75<br />
&amp; IF(cyp .GT. 1) CL = CL * cyp</p>
</div>
</div>
<div id="bol" class="section level3" number="5.3.4">
<h3><span class="header-section-number">5.3.4</span> Bolus inputs</h3>
<p>Example:</p>
<div class="script">
<p>#Bol<br />
NBCOMP(1) = 2</p>
</div>
</div>
<div id="ini" class="section level3" number="5.3.5">
<h3><span class="header-section-number">5.3.5</span> Initial conditions</h3>
<p>Example:</p>
<div class="script">
<p>#Ini<br />
X(2) = IC*V<br />
X(3) = IC3<br />
</p>
</div>
<p>In the first case, the initial condition for compartment 2 becomes the
value of the IC covariate (defined in #Covariate block) multiplied by
the current estimate of V during each iteration. This is useful when a
subject has been taking a drug as an outpatient, and comes in to the lab
for PK sampling, with measurement of a concentration immediately prior
to a witnessed dose, which is in turn followed by more sampling. In this
case, IC or any other covariate can be set to the initial measured
concentration, and if V is the volume of compartment 2, the initial
condition (amount) in compartment 2 will now be set to the measured
concentration of drug multiplied by the estimated volume for each
iteration until convergence.</p>
<p>In the second case, the initial condition for compartment 3 becomes
another variable, IC3 defined in the #Primary block, to fit in the
model, given the observed data.</p>
</div>
<div id="Fa" class="section level3" number="5.3.6">
<h3><span class="header-section-number">5.3.6</span> Fa (bioavailability)</h3>
<p>Specify the bioavailability term, if present. Use the form FA(.) =
expression, where "." is the input number. Primary and secondary
variables and covariates may be used in the expression, as can
conditional statements in Fortran code. An "&amp;" continuation prefix is
not necessary in this block for any statement, although if present, will
be ignored.</p>
<p>Example:</p>
<div class="script">
<p>#Fa<br />
FA(1) = FA1</p>
</div>
</div>
<div id="lag" class="section level3" number="5.3.7">
<h3><span class="header-section-number">5.3.7</span> Lag time</h3>
<p>Example:</p>
<div class="script">
<p>#Lag<br />
TLAG(1) = Tlag1</p>
</div>
</div>
<div id="dif" class="section level3" number="5.3.8">
<h3><span class="header-section-number">5.3.8</span> Differential equations</h3>
<p>Example:</p>
<div class="script">
<p>#Dif<br />
XP(1) = -KA*X(1)<br />
XP(2) = RATEIV(1) + KA*X(1) - (KE+KCP)*X(2) + KPC*X(3)<br />
XP(3) = KCP*X(2) - KPC*X(3)</p>
</div>
</div>
<div id="out" class="section level3" number="5.3.9">
<h3><span class="header-section-number">5.3.9</span> Outputs</h3>
<p>Output equations, in Fortran format. Outputs are of the form Y(.) =
expression, where "." is the output equation number. Primary and
secondary variables and covariates may be used in the expression, as can
conditional statements in Fortran code. An "&amp;" continuation prefix is
not necessary in this block for any statement, although if present, will
be ignored. <strong>There can be a maximum of 6 outputs.</strong> They are referred
to as Y(1), Y(2), etc. These equations may also define a model
explicitly as a function of primary and secondary variables and
covariates.</p>
<p>Examples:</p>
<div class="script">
<p>#Out<br />
Y(1) = X(2)/V</p>
<p>#OUT</p>
<p>RES = B(1) * KIN/(KIN-KOUT) * (EXP(-KOUT*TPD)-EXP(-KIN*TPD))</p>
<p>Y(1) = RES/VD</p>
</div>
</div>
<div id="err" class="section level3" number="5.3.10">
<h3><span class="header-section-number">5.3.10</span> Error</h3>
<p>Unlike the R6, the error block is separate from the output block. In Legacy Pmetrics, this block contains all the information Pmetrics requires for the
structure of the error model.</p>
<p>To specify the model in this block, the first line needs to be either
L=number or G=number for a <span class="math inline">\(\lambda\)</span> or <span class="math inline">\(\gamma\)</span> error model. The
number is the starting value for <span class="math inline">\(\lambda\)</span> or <span class="math inline">\(\gamma\)</span>. If you include an exclamation point (!) in the declaration,
then <span class="math inline">\(\lambda\)</span> or <span class="math inline">\(\gamma\)</span> will be fixed and not estimated. Recall that you can
only fix <span class="math inline">\(\lambda\)</span> currently to zero.</p>
<p>The next line(s) contain the values for <span class="math inline">\(C0\)</span>, <span class="math inline">\(C1\)</span>, <span class="math inline">\(C2\)</span>, and <span class="math inline">\(C3\)</span>,
separated by commas. There should be one line of coefficients for each
output equation. By default Pmetrics will use values for these
coefficients found in the data file. If none are present or if the model
declaration line contains an exclamation point (!) the values here will
be used.</p>
<p>Example 1: estimated <span class="math inline">\(\lambda\)</span>, starting at 0.4, one output, use data file
coefficients but if missing, use 0.1,0.1,0,0.</p>
<div class="script">
<p>#Err<br />
L=0.4<br />
0.1,0.1,0,0<br />
</p>
</div>
<p>Example 2: fixed <span class="math inline">\(\gamma\)</span> of 2, two outputs, use data file coefficients but
if missing, use 0.1,0.1,0,0 for the first output, but use 0.3, 0.1, 0, 0
for output 2 regardless of what is in the data file.</p>
<div class="script">
<p>#Err<br />
G=2!<br />
0.1,0.1,0,0<br />
0.3,0.1,0,0!<br />
</p>
</div>
</div>
<div id="extra" class="section level3" number="5.3.11">
<h3><span class="header-section-number">5.3.11</span> Extra</h3>
<p>This block is for advanced Fortran programmers only.
&lt;span class=“update&gt;Update</span>It is not yet implemented in R6.
Occasionally, for very complex models, additional Fortran subroutines are required. They can be placed here. The code must specify complete Fortran subroutines
which can be called from other blocks with appropriate call functions.
As stated earlier, sometimes it is important to preserve spacing and
formatting in Fortran code that you might insert into blocks,
particularly the #EXTRA block. If you wish to do this, insert [format] and [/format] in the fortran model file around the affected code.</p>
</div>
<div id="reserved" class="section level3" number="5.3.12">
<h3><span class="header-section-number">5.3.12</span> Reserved Names</h3>
<p>The following cannot be used as primary, covariate, or secondary
variable names. They can be used in equations, however.</p>
<table>
<tbody>
<tr class="odd">
<td align="left"><strong>Reserved Variable</strong></td>
<td align="left"><strong>Function in Pmetrics</strong></td>
</tr>
<tr class="even">
<td align="left">ndim</td>
<td align="left">internal</td>
</tr>
<tr class="odd">
<td align="left">t</td>
<td align="left">time</td>
</tr>
<tr class="even">
<td align="left">x</td>
<td align="left">array of compartment amounts</td>
</tr>
<tr class="odd">
<td align="left">xp</td>
<td align="left">array of first derivative of compartment amounts</td>
</tr>
<tr class="even">
<td align="left">rpar</td>
<td align="left">internal</td>
</tr>
<tr class="odd">
<td align="left">ipar</td>
<td align="left">internal</td>
</tr>
<tr class="even">
<td align="left">p</td>
<td align="left">array of primary parameters</td>
</tr>
<tr class="odd">
<td align="left">r</td>
<td align="left">input rates</td>
</tr>
<tr class="even">
<td align="left">b</td>
<td align="left">input boluses</td>
</tr>
<tr class="odd">
<td align="left">npl</td>
<td align="left">internal</td>
</tr>
<tr class="even">
<td align="left">numeqt</td>
<td align="left">output equation number</td>
</tr>
<tr class="odd">
<td align="left">ndrug</td>
<td align="left">input number</td>
</tr>
<tr class="even">
<td align="left">nadd</td>
<td align="left">covariate number</td>
</tr>
<tr class="odd">
<td align="left">rateiv</td>
<td align="left">intravenous input for inputs when DUR&gt;0 in data files</td>
</tr>
<tr class="even">
<td align="left">cv</td>
<td align="left">covariate values array</td>
</tr>
<tr class="odd">
<td align="left">n</td>
<td align="left">number of compartments</td>
</tr>
<tr class="even">
<td align="left">nd</td>
<td align="left">internal</td>
</tr>
<tr class="odd">
<td align="left">ni</td>
<td align="left">internal</td>
</tr>
<tr class="even">
<td align="left">nup</td>
<td align="left">internal</td>
</tr>
<tr class="odd">
<td align="left">nuic</td>
<td align="left">internal</td>
</tr>
<tr class="even">
<td align="left">np</td>
<td align="left">number of primary parameters</td>
</tr>
<tr class="odd">
<td align="left">nbcomp</td>
<td align="left">bolus compartment array</td>
</tr>
<tr class="even">
<td align="left">psym</td>
<td align="left">names of primary parameters</td>
</tr>
<tr class="odd">
<td align="left">fa</td>
<td align="left">biovailability</td>
</tr>
<tr class="even">
<td align="left">tlag</td>
<td align="left">lag time</td>
</tr>
<tr class="odd">
<td align="left">tin</td>
<td align="left">internal</td>
</tr>
<tr class="even">
<td align="left">tout</td>
<td align="left">internal</td>
</tr>
</tbody>
</table>
</div>
<div id="completeEx" class="section level3" number="5.3.13">
<h3><span class="header-section-number">5.3.13</span> Complete Example</h3>
<p>Here is a complete example of a model file, as of Pmetrics version 0.40
and higher:</p>
<div class="script">
<p>#Pri<br />
KE, 0, 5<br />
V0, 0.1, 100<br />
KA, 0, 5<br />
Tlag1, 0, 3<br />
</p>
<p>#Cov<br />
wt<br />
C this weight is in kg<br />
</p>
<p>#Sec<br />
V = V0*wt<br />
</p>
<p>#Lag<br />
TLAG(1) = Tlag1<br />
</p>
<p>#Out<br />
Y(1) = X(2)/V<br />
</p>
<p>#Err<br />
L=0.4<br />
0.1,0.1,0,0<br />
</p>
</div>
<p><em>Notes</em>:</p>
<p>By omitting a #Diffeq block with ODEs, Pmetrics understands that you
are specifying the model to be solved algebraically. In this case, at
least KE and V must be in the Primary or Secondary variables. KA, KCP,
and KPC are optional and specify absorption, and transfer to and from
the central to a peripheral compartment, respectively.</p>
<p>The comment line “C this weight is in kg” will be ignored.</p>
</div>
<div id="brief-fortran-tutorial" class="section level3" number="5.3.14">
<h3><span class="header-section-number">5.3.14</span> Brief Fortran Tutorial</h3>
<p>Much more detailed help is available from
<a href="http://www.cs.mtu.edu/\~shene/COURSES/cs201/NOTES/fortran.html" class="uri">http://www.cs.mtu.edu/\~shene/COURSES/cs201/NOTES/fortran.html</a>.</p>
<table>
<tbody>
<tr class="odd">
<td align="left"><strong>Arithmetic Operator</strong></td>
<td align="left"><strong>Meaning</strong></td>
</tr>
<tr class="even">
<td align="left">+</td>
<td align="left">addition</td>
</tr>
<tr class="odd">
<td align="left">-</td>
<td align="left">subtraction</td>
</tr>
<tr class="even">
<td align="left">*</td>
<td align="left">multiplication</td>
</tr>
<tr class="odd">
<td align="left">/</td>
<td align="left">division</td>
</tr>
<tr class="even">
<td align="left">**</td>
<td align="left">exponentiation</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr class="odd">
<td align="left"><strong>Relational Operator</strong></td>
<td align="left"><strong>Alternative</strong></td>
<td align="left"><strong>Meaning</strong></td>
</tr>
<tr class="even">
<td align="left">&lt;</td>
<td align="left">.LT.</td>
<td align="left">less than</td>
</tr>
<tr class="odd">
<td align="left">&lt;=</td>
<td align="left">.LE.</td>
<td align="left">less than or equal</td>
</tr>
<tr class="even">
<td align="left">&gt;</td>
<td align="left">.GT.</td>
<td align="left">greater than</td>
</tr>
<tr class="odd">
<td align="left">&gt;=</td>
<td align="left">.GE.</td>
<td align="left">greater than or equal</td>
</tr>
<tr class="even">
<td align="left">==</td>
<td align="left">.EQ.</td>
<td align="left">equal</td>
</tr>
<tr class="odd">
<td align="left">/=</td>
<td align="left">.NE.</td>
<td align="left">not equal</td>
</tr>
</tbody>
</table>
<table style="width:90%;">
<colgroup>
<col width="55%" />
<col width="34%" />
</colgroup>
<tbody>
<tr class="odd">
<td><strong>Selective Execution</strong></td>
<td><strong>Example</strong></td>
</tr>
<tr class="even">
<td>IF (logical-expression) one-statement</td>
<td>IF (T &gt;= 100) CL = 10</td>
</tr>
<tr class="odd">
<td><p>IF (logical-expression) THEN</p>
<p>statements</p>
<p>END IF</p></td>
<td><p>IF (T &gt;= 100) THEN</p>
<p>CL = 10</p>
<p>V = 10</p>
<p>END IF</p></td>
</tr>
<tr class="even">
<td><p>IF (logical-expression) THEN</p>
<p>statements-1</p>
<p>ELSE</p>
<p>statements-2</p>
<p>END IF</p></td>
<td><p>IF (T &gt;= 100) THEN</p>
<p>CL = 10</p>
<p>ELSE</p>
<p>CL = CL</p>
<p>END IF</p></td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="general-workflow.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="how-to-use-r-and-pmetrics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/04-Inputs.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
