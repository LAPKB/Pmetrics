[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Learn Pmetrics",
    "section": "",
    "text": "0.1 How to use these pages\nThese exercises will help you learn how to use Pmetrics for R. They are designed to be read in sequence, so start with the first one.\nWhen you work on a project, best practice is to use the following workflow:\nIf you have loaded Pmetrics already with library(Pmetrics), the command PMtree() will create a project folder with subfolders for you. To learn more about this function or any other in R, you can get help by typing ?function_name in the console.\nWe assume you have some familiarity with R and possibly Quarto. If not, there are many good tutorials online.\nWe have designed these pages with the idea that you can copy and paste the code chunks into your own scripts or Quarto documents to see how they work. You can hover over the code chunks to see a copy icon. Click that to copy the code to your clipboard so you can paste it into your own script or document. Alternatively, you can click the ‚ÄúCopy all code‚Äù button at the top right of every page to copy all the code chunks on that page to your clipboard.\nNote: In many cases, we do not evaluate the code chunks because the ouput is too long, so you will need to run them in your own script or document.\n# Hover over the code chunk to see the copy icon.",
    "crumbs": [
      "Home",
      "<span class='chapter-number'>1</span>¬† <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "index.html#scripting",
    "href": "index.html#scripting",
    "title": "Learn Pmetrics",
    "section": "0.2 Scripting",
    "text": "0.2 Scripting\nYou can use either an R script or a Quarto document to paste code from these pages or to write your own code. R scripts have the advantage of being simple and easy to use. Quarto documents have the advantage of being able to combine code with formatted text, images, links, etc. You can use either method to work with Pmetrics. Choose the one that works best for you.\n\n0.2.1 R script\n\nCreate a new script with File -&gt; New File -&gt; R Script (Rstudio) or R File (Positron).\nSave the script in your project directory with a name like ‚ÄúLearn.R‚Äù.\nYou can then copy and paste code chunks from these pages into your script and run them line by line or all at once.\nIt is useful to annotate your code with comments like the one above so you can remember what you did later.\n\nHere‚Äôs a toy example of an R script.\n\n# This is a comment in R. It starts with a # symbol.\n# Anything other than a comment should be R code.\na &lt;- 1 + 1\nprint(a) # This will print the value of a to the console.\n\n\n\n0.2.2 Quarto document\n\nCreate a new document with File -&gt; New File -&gt; Quarto Document (Rstudio/Positron).\nUse markdown to add headings, links, images, etc.\nInsert R chunks to paste copied code or write your own.\nExecute code from the chunks.\nRender the document to create a nicely formatted output in HTML, PDF, or Word format.\nSee Quarto documentation for more information.\n\nHere‚Äôs a toy example of a Quarto document. It mixes text formatted in markdown and R code chunks.\n---\ntitle: \"My Project\"\nformat: html\n---\n\n## Introduction\nThis is my first Quarto document. Below is some R code.\n\n```{r}\n# this is an R code chunk\nb &lt;- 2 + 2\nprint(b)\n```\n\nYou can see that the value of b is printed above.\n\nWhen rendered, the above will look like this:",
    "crumbs": [
      "Home",
      "<span class='chapter-number'>1</span>¬† <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "NPAG.html",
    "href": "NPAG.html",
    "title": "2¬† Running NPAG",
    "section": "",
    "text": "First, you must always load the Pmetrics library in your R script or Quarto document.\n\nlibrary(Pmetrics)\n\n\n\n‚Ñπ Loading Pmetrics\n\n\n\n2.0.1 Working directory\nNext, R and Pmetrics need to know which directory to work in. This is the directory where R expects to find files and where it will save output files. There are two ways to do this.\n\n2.0.1.1 Global working directory change\nYou can set your working directory with the setwd function.\n\nsetwd(\"/path/to/your/project/directory\") # Mac and Linux users\nsetwd(\"C:/path/to/your/project/directory\") # Windows users\n\nWindows users: Make sure that you separate directories with a forward slash ‚Äú/‚Äù or double backslashes ‚Äú\\‚Äù. Unfortunately, Windows is the only OS that uses backslashes ‚Äú‚Äú, so R conforms to Unix/Linux style with the forward slash. If you copy the example below, make sure to change the path to one that exists on your computer.\n\n\n2.0.1.2 Local path specification\nYou can also specify the path in a variable and use it in Pmetrics functions without changing the working directory.\n\nwd &lt;- \"/path/to/your/project/directory\" # Mac and Linux users\nwd &lt;- \"C:/path/to/your/project/directory\" # Windows users\ndat &lt;- PM_data$new(data = file.path(wd, \"data\", \"mydata.csv\"))\n\nüí° The file.path function creates file paths that are compatible with your operating system.\n\n\n\n2.0.2 Workflow\nThe typical workflow for using Pmetrics is as follows:\n\nCreate a PM_data object.\nCreate a PM_model object.\nFit the model to the data with the $fit() method of the model object. This returns a PM_result object, which is also saved to the hard drive and can be loaded later with the PM_load function.\nExamine the results with PM_result methods and functions and revise as needed to improve the model fit. This chiefly means using the $update() method to change the model or manually editing it.\n\n\n\n\n\n\nflowchart LR\n\nsubgraph RSession[\" \"]\n  direction TB\n  DATA[\"PM_data\"]\n  MODEL[\"PM_model\"]\n  RESULT[\"PM_result\"]\nend\n\nDISK[(\"Hard Drive\")]\n\nDATA --&gt; MODEL\nMODEL -- \"$fit()\" --&gt; RESULT\nRESULT -- \"$update()\" --&gt; MODEL\nDISK -- \"PM_load()\" --&gt; RESULT\nRESULT --&gt; DISK\n\nclassDef blue fill:#2f6db6,stroke:#184a8b,color:#fff;\nclassDef orange fill:#c7662b,stroke:#8a3f18,color:#fff;\nclassDef disk fill:#d2d3d7,stroke:#7f8084,color:#000;\n\nclass DATA,MODEL blue;\nclass RESULT orange;\nclass DISK disk;\n\nstyle RSession fill:#e9f0ff,stroke:#9ab0d6,stroke-width:1px,rx:2,ry:2\n\n\n\n\n\n\n\n\n\n2.0.3 Data objects\nPmetrics always needs data and a model to run, so let‚Äôs create a new data object.\n\nexData &lt;- PM_data$new(data = \"../Examples/src/ex.csv\")\n\n\n\n\n‚îÄ‚îÄ DATA STANDARDIZATION ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n\n\nEVID inferred as 0 for observations, 1 for doses.\n All doses assumed to be oral (DUR = 0).\n ADDL set to missing for all records.\n II set to missing for all records.\n All doses assumed to be INPUT = 1.\n All observations assumed to be OUTEQ = 1.\n All observations assumed to be uncensored.\n One or more error coefficients not specified. Error in model object will be used.\n\n\n\n\n\n‚îÄ‚îÄ DATA VALIDATION ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n\n\nNo data errors found.\n\n\nPmetrics standardizes the data, checks for errors, and provides an error and attempted fix report fo any found.\nYou can look at a .csv data file directly by opening it in a spreadsheet program like Excel, or a text editor.\nexData is an R6 object, which means that contains both data and methods to process that data.\n\nexData # prints the object, usually to the terminal, but in this case to a rendered \"lite\" spreadsheet\nexData$data # contains your original data\nexData$standard_data # contains the standardized and validated data\nexData$summary() # prints the summary of the data to the terminal\n\nMost Pmetrics objects are R6 objects, so you can use the $ operator to access their data and methods. Many of them have a summary() method that prints a summary of the object to the console and a plot() method that creates a plot of the object. See PM_data for more information on the PM_data class and its methods.\nNote: We recognize that many users are familiar with the ‚ÄúS3 framework‚Äù in R, which uses functions like summary(object) and plot(object). To comply with better programming standards, Pmetrics uses the R6 framework. However, we have provided S3 methods for most functions, so you can use summary(object) and plot(object) if you prefer.\n\n# S3 method to summarize data\nsummary(exData)\n\nPM_data has a plot() method that creates a plot of the data. See plot.PM_data for more information.\n\nexData$plot() \n\n\n\n\n\n\n\n\n\n2.0.4 Model objects\nYou can specify a model by reading a file or directly as a list object in R. We‚Äôll do both.\nThe following code creates the same model as in /src/model.txt file. See further model details on creating models in R compared to text files. The advantage of creating them in R is that one does not need to copy model files into folders to provide necessary inputs.\n\nmod1 &lt;- PM_model$new(\n  pri = list(\n    Ka = ab(0.1, 0.9),\n    Ke = ab(0.001, 0.1),\n    V = ab(30, 120),\n    lag1 = ab(0, 4)\n  ),\n  cov = list(\n    wt = interp(),\n    africa = interp(\"none\"),\n    age = interp(),\n    gender = interp(\"none\"),\n    height = interp()\n  ),\n  eqn = function(){\n    two_comp_bolus\n  },\n  lag = function(){\n    lag[1] = lag1\n  },\n  out = function(){\n  Y[1] = X[2]/V\n  },\n  err = list(\n    proportional(5, c(0.02, 0.05, -0.0002, 0))\n  )\n)\n\n‚Ñπ Compiling model...\n\n\nWhen you execute the above code in your own script or Quarto document, you will see a message indicating that the model has compiled.\n\nmod1 # prints the model object\n\n\n\n\n‚îÄ‚îÄ Model summary ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n\n\n\n\n\n‚îÄ‚îÄ Primary Parameters \n\n\nKa: [0.1, 0.9], ~N(0.5, 0.13)\n\n\nKe: [0.001, 0.1], ~N(0.05, 0.02)\n\n\nV: [30, 120], ~N(75, 15)\n\n\nlag1: [0, 4], ~N(2, 0.67)\n\n\n\n\n\n‚îÄ‚îÄ Covariates \n\n\nwt, africa (no interpolation), age, gender (no interpolation), and height\n\n\n\n\n\n‚îÄ‚îÄ Primary Equations \n\n\ntwo_comp_bolus\n\n\n\n\n\n‚îÄ‚îÄ Lag Time \n\n\nlag[1] = lag1\n\n\n\n\n\n‚îÄ‚îÄ Outputs \n\n\nY[1] = X[2]/V\n\n\n\n\n\n‚îÄ‚îÄ Error Model \n\n\nProportional, with initial value of 5 and coefficients 0.02, 0.05, -2e-04, and\n0.\n\n\n\nmod1$plot() \n\n\n\n\n\n\n\n\nWe have another file ‚Äúmodel.txt‚Äù that contains the old representation of the same model we coded above, let‚Äôs take a look at it.\n\nsystem(\"cat ../Examples/src/model.txt\")\n\nYou can also open it in a text editor.\nPM_model$new() also accepts the path to a model file to create the same model using the file.\n\nmod1b &lt;- PM_model$new(\"../Examples/src/model.txt\")\nmod1b # look at it\n\nPM_model provides a method to update the different elements of a model, for example:\n\nmod1b$update(\n  pri = list(\n    ka = ab(0.001, 5)\n))\n\nIt is case sensitive, so ka is different from Ka. To remove a parameter, set it to NULL.\nTo copy a model use the $clone() method.\n\nmod1b &lt;- mod1$clone()\n\nSimply using mod1b &lt;- mod1 will cause mod1b to be changed if mod1 is changed, as R6 objects use reference semantics. For more details you can refer to Advanced R, Section 14.4.\nLastly, Pmetrics has a model building app!\n\nbuild_model() #start from scratch\nbuild_model(exData) #start with data to match covariates\nbuild_model(mod1) #start with a model and update it\n\n\n\n2.0.5 Fit the model to the data\nTo keep everything tidy, we are working in a folder specifically to store the runs. We are specifying the path in the call to $fit() rather than globally changing the working directory.\n\nrun1 &lt;- mod1$fit(data = exData, run = 1, overwrite = TRUE, path = \"../Examples/Runs\") \n\nThe PM_model class has a $fit() method that fits the model to the data.\nAfter the run is complete the results are returned to the assigned object, here ‚Äòrun1‚Äô. However, if you want to load the results later, you can use the PM_load() function. Runs will be sequentially numbered as /1, /2, /3,‚Ä¶ in your working directory.\n\nrun1 &lt;- PM_load(1, path = \"../Examples/Runs\") # load the results from run 1 if returning to this script later",
    "crumbs": [
      "Home",
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Running NPAG</span>"
    ]
  },
  {
    "objectID": "NPAG_cov.html",
    "href": "NPAG_cov.html",
    "title": "4¬† NPAG with covariates",
    "section": "",
    "text": "Let‚Äôs create another run object, this time using a model that include covariates.\nFirst clone mod1.\n\nmod2 &lt;- mod1$clone()\n\nThen update it to add a variable V0, or volume that depends on weight. Remove V. Note that updating changes the object in place, so we don‚Äôt have to re-assign it back to mod2, i.e.¬†we don‚Äôt need mod2 &lt;- mod2$update(...), although if you forget, it will work the same. Note that we also have to use the sec block to let Pmetrics know how to calculate V based on V0 and WT (weight). Here we normalize weight to the population mean of 55 kg.\n\nmod2$update(\n  pri = list(\n    V0 = ab(30, 120),\n    V = NULL\n  ),\n  sec = function(x) {\n    V = V0*(WT/55)\n  }\n)\n\n‚Ñπ Compiling model...\n\n\nNow, run that new model.\n\nrun2 &lt;- mod2$fit(data = exData, run = 2, overwrite = TRUE)\n\nRight after the run, the results are in run2, but for future loading if you return to your script later, you can load it with PM_load().\n\nrun2 &lt;- PM_load(2)",
    "crumbs": [
      "Home",
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>NPAG with covariates</span>"
    ]
  },
  {
    "objectID": "Compare.html",
    "href": "Compare.html",
    "title": "5¬† Comparing models",
    "section": "",
    "text": "Let‚Äôs compare model 1 and model 2. You can compare any number of models. Type ?PM_compare for help. All models must already be loaded either with PM_load or assigning the result of $fit, e.g., run1 &lt;- mod1$fit(...).\n\nPM_compare(run1, run2)\n\nThis will open an html window in your browser with detailed comparisons between the models.",
    "crumbs": [
      "Home",
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>Comparing models</span>"
    ]
  },
  {
    "objectID": "examine.html",
    "href": "examine.html",
    "title": "3¬† Examine the results",
    "section": "",
    "text": "Recall that in the previous exercises, we loaded our run results with the following.\n\nrun1 &lt;- PM_load(1, path = \"../Examples/Runs\")\n\nrun1 is now a PM_result R6 object that contains all the results from the NPAG run. Let‚Äôs dig into it in more detail.\n\n3.0.1 Data\n\n3.0.1.1 Data plots\nYou can plot the original data using R6 with various options. Type ?plot.PM_data in the R console for help.\n\nrun1$data$plot() \n\n\n\n\n\n\n\nHere‚Äôs some nice grouping and coloring. If you use grouping, provide names in group_names and colors/symbols for each group as arguments to marker. Colors of lines will be set to the same as for marker to avoid a mess of colors.\n\nrun1$data$plot(group = \"gender\", group_names = c(\"Female\", \"Male\"), \n  marker = list(color = c(\"red\",\"blue\"), symbol = c(\"circle\",\"triangle-up\"))) \n\n\n\n\n\n\n\nThe next one splits the data by subject but will not render easily in this document. You can interact with it in your own script or Quarto document.\n\nrun1$data$plot(overlay = FALSE, xlim = c(119, 145))\n\nThe following are the older S3 method with plot(...) for the first two examples. You can use R6 or S3 for any Pmetrics object. We will focus on R6 as the more modern way.\n\nplot(run1$data)\n\n\n\n3.0.1.2 Data summaries\nHere‚Äôs a summary of the original data file; ?summary.PM_data for help.\n\nrun1$data$summary()\n\n\n\n\n3.0.2 Observed vs.¬†Predicted (OP)\n\n3.0.2.1 OP plots\nYou can plot observed vs.¬†predicted data. Type ?plot.PMop in the R console for help or check out plot.PM_op.\n\nrun1$op$plot() \n\n\n\n\n\n\n\nBelow, you can see how to change the prediction type, regression line and color, and plotting symbol and color. Most plots in Pmetrics have marker and line list arguments to customize the appearance of the plotting symbols and lines.\n\nrun1$op$plot(pred.type = \"pop\")\nrun1$op$plot(line = list(lm = FALSE, loess = list(color = \"red\")), marker = list(symbol = 3, color = \"green\"))\n\n\n\n\n\n\n\n\n\n\n\n\n\n3.0.2.2 OP summaries\nGet a summary with bias and imprecision of the population predictions; ?summary.PM_op in the console or summary.PM_op for more information. The default pred.type is ‚Äúpost‚Äù, which are the predictions based on the full Bayesian posterior distribution of parameter values for an individual. The predictions are the weighted mean or median (controlled by the icen argument in all Pmetrics functions) of the predictions from each support point in the individual‚Äôs Bayesian posterior, joint probability parameter distribution, i.e.¬†the support points in the posterior. Here we will look at the population predictions based on the means of the parameter values.\n\nrun1$op$summary(pred.type = \"pop\", icen = \"mean\")\n\n\n\n\n\nSince neither ‚Äúpop‚Äù nor ‚Äúmean‚Äù are the defaults, we have to specify them. We can also use the S3 method for the same summary below.\n\nsummary(run1$op, pred.type = \"pop\", icen = \"mean\") # S3 method\n\nAs with any object in Pmetrics, the PM_op R6 object has fields and methods. Fields contain data and methods are functions that act on the data. All fields and methods are accessed with $ added to the name of the object. For example, in a PM_op object and most other Pmetrics objects, the raw data can be accessed via the $data field.\n\nrun1$op$data\n\nHaving the raw data provides a data frame compatible with any R function, particularly those from Tidyverse (see https://www.tidyverse.org/), including piping (%&gt;%). If you‚Äôre not familiar with the pipe operator, see this article. We strongly recommend Tidvyerse for data manipulation and visualization in R, and Pmetrics works well with it. See R for Data Science for more information.\nThis allows pre-processing in ways more flexible than the default plot method.\n\nlibrary(tidyverse)\nrun1$op$data %&gt;% plot()\nrun1$op$data %&gt;%\n  filter(pred &gt; 5) %&gt;%\n  filter(pred &lt; 10) %&gt;%\n  summary()\n\nSee a header with the first 10 rows of the op object:\n\nhead(run1$op$data, 10)\n\n\n\n\n3.0.3 Final population joint density\n\n3.0.3.1 Final plots\nPlot the final population joint density. Type ?plot.PM_final in the R console for help.\n\nrun1$final$plot()\n\n# alternate methods with same result\nrun1$final$data %&gt;% plot() # tidyverse style\nplot(run1$final) # S3 method\nplot(run1$final$data) # S3 method\n\n\n\n\n\n\n\nYou can add a kernel density curve.\n\nrun1$final$plot(line = list(color = \"red\"))\n\n\n\n\n\n\n\nIt is possible to make a bivariate plot. Plotting formulae in R are of the form y~x\n\nrun1$final$plot(ke ~ v,\n  marker = list(color = \"red\", symbol = \"diamond\"))\n\n\n\n\n\n\n\n\n\n3.0.3.2 Final summaries\nSee a summary with confidence intervals around the medians and the Median Absolute Weighted Difference (MAWD); ?summary.PM_final for help and further explanation.\n\nrun1$final$summary()\n\nThe original final object can be accessed with the $data field.\n\nrun1$final$data\nnames(run1$final$data)\n\nSee the population points:\n\nrun1$final$popPoints\n\n# A tibble: 19 √ó 5\n      ka     ke     v   tlag1   prob\n   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;\n 1 0.899 0.0340  74.4 2.01    0.101 \n 2 0.898 0.0433 108.  2.09    0.0500\n 3 0.897 0.0608  32.5 3.14    0.0500\n 4 0.899 0.0564 120.  0.678   0.0502\n 5 0.363 0.0749  68.4 0.869   0.0500\n 6 0.805 0.0755  60.8 1.09    0.0500\n 7 0.899 0.0278  63.7 1.75    0.0506\n 8 0.690 0.0371  85.1 0.644   0.0504\n 9 0.102 0.0642 119.  0.00843 0.0498\n10 0.717 0.0590  64.8 0.821   0.0497\n11 0.364 0.0278  58.9 0.458   0.0494\n12 0.549 0.0450 114.  0.316   0.0521\n13 0.694 0.0456  97.9 0.853   0.0497\n14 0.748 0.0291  95.9 1.39    0.0502\n15 0.866 0.0331  74.4 1.11    0.0484\n16 0.747 0.0397 120.  0.00315 0.0485\n17 0.437 0.0698  43.2 3.99    0.0568\n18 0.727 0.0578  53.3 3.04    0.0149\n19 0.725 0.0578  53.3 3.04    0.0783\n\n\nOr drill down one more level into the raw data. The $final$popPoints field above pulls its information from the $final$data$popPoints field below, but is provided as a simpler way to access the population points.\n\nrun1$final$data$popPoints\n\nSee the population mean parameter values:\n\nrun1$final$popMean\n\n# A tibble: 1 √ó 4\n     ka     ke     v tlag1\n  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 0.694 0.0487  79.0  1.48\n\n\n\n\n\n3.0.4 Cycle information\n\n3.0.4.1 Cycle plots\nPlot cycle information; type ?plot.PM_cycle in the R console for help.\n\nrun1$cycle$plot()\n\n\n\n\n\n\n\n\n\n3.0.4.2 Cycle summaries\nSummarize the cycle information; ?summary.PM_cycle for help.\n\nrun1$cycle$summary()\n\n# alternatives\nrun1$cycle$data %&gt;% summary() # tidyverse style\nsummary(run1$cycle) # S3 method\nsummary(run1$cycle$data) # S3 method\n\n\n\n\n\n\n‚îÄ‚îÄ Cycle Summary ‚îÄ‚îÄ\n\n\n\n\n\nCycle number: 100 of 100\n\n\nStatus: Maximum cycles reached\n\n\nLog-likelihood: 440.985\n\n\nAIC:: 448.985\n\n\nBIC: 452.968\n\n\nOuteq 1: Gamma = 2.39\n\n\n\n\n\n‚îÄ‚îÄ Normalized parameter values: \n\n\n# A tibble: 3 √ó 6\n  cycle    ka    ke     v tlag1 stat  \n  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; \n1   100  1.14 0.978 0.975 0.931 mean  \n2   100  1.10 0.622 1.83  1.41  sd    \n3   100  1.13 1     0.92  0.865 median\n\n\n\n\n\n3.0.5 Covariate information\n\n3.0.5.1 Covariate plots\nPlot covariate information; type ?plot.PM_cov in the R console for help. Recall that plotting formulae in R are of the form y~x.\n\nrun1$cov$plot(v ~ wt)\n\n\n\n\n\n\n\nYou can also use the raw data in the $data field to make plots with other R functions, including those from Tidyverse. Here we will filter the data for age &gt; 25 and then plot volume vs.¬†weight.\n\nrun1$cov$data %&gt;%\n  filter(age &gt; 25) %&gt;%\n  plot(v ~ wt)\n\nChange the formatting of the plot with the line and marker list arguments.\n\nrun1$cov$plot(ke ~ age, line = list(loess = FALSE, lm = list(color = \"red\")),\n               marker = list(symbol = 3))\n\n\n\n\n\n\n\nAnother plot with mean Bayesian posterior parameter and covariate values‚Ä¶remember the icen argument?\n\nrun1$cov$plot(v ~ wt, icen = \"mean\")\n\n\n\n\n\n\n\nWhen time is the x variable, the y variable is aggregated by subject. In R plot formulae, calculations on the fly can be included using the I() function.\n\nrun1$cov$plot(I(v * wt) ~ time)\n\n\n\n\n\n\n\nThe above plots the product of volume and weight vs.¬†time for each subject.\n\n\n3.0.5.2 Covariate summaries\nJust as you have the option to plot by mean covariate and posterior parameter values, you can summarize with means; ?summary.PM_cov for help.\n\nrun1$cov$summary(icen = \"mean\")\n\n# A tibble: 20 √ó 11\n      id    ka     ke     v  tlag1 africa   age gender height    wt icen \n   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;\n 1     1 0.370 0.0278  59.0 0.473       1    21      1    160  46.7 mean \n 2     2 0.739 0.0399 120.  0.0155      1    30      1    174  66.5 mean \n 3     3 0.898 0.0433 108.  2.09        1    24      0    164  46.7 mean \n 4     4 0.899 0.0564 120.  0.678       1    25      1    165  50.8 mean \n 5     5 0.104 0.0642 119.  0.0105      1    22      1    181  65.8 mean \n 6     6 0.898 0.0340  74.4 2.01        1    23      1    177  65   mean \n 7     7 0.706 0.0586  52.7 3.11        1    27      0    161  51.7 mean \n 8     8 0.898 0.0340  74.4 2.01        1    22      1    163  51.2 mean \n 9     9 0.692 0.0456  98.1 0.845       1    23      1    174  55   mean \n10    10 0.717 0.0590  64.9 0.821       1    32      1    163  52.1 mean \n11    11 0.363 0.0749  68.4 0.869       1    34      1    165  56.5 mean \n12    12 0.749 0.0292  95.5 1.39        1    54      0    160  47.9 mean \n13    13 0.452 0.0692  43.7 3.94        1    24      1    180  60.5 mean \n14    14 0.552 0.0449 114.  0.315       1    26      1    174  59.2 mean \n15    15 0.864 0.0330  74.8 1.13        1    19      0    150  43   mean \n16    16 0.690 0.0371  85.2 0.646       1    25      1    173  64.4 mean \n17    17 0.805 0.0755  60.8 1.09        1    23      1    170  54.8 mean \n18    18 0.899 0.0278  63.7 1.74        1    20      0    164  44.3 mean \n19    19 0.897 0.0608  32.5 3.14        1    36      1    168  50   mean \n20    20 0.691 0.0592  52.1 3.16        1    31      1    170  59   mean \n\n\nThe run1$cov object looks like a data frame, but is really an R6 PM_cov object whose $print() method returns a data frame. You can access the raw data with the $data field, which is truly a data frame.\n\nrun1$cov$data[, 1:3] # for example\nrun1$cov$data %&gt;% filter(gender == 1) %&gt;% summary() # using Tidyverse\n\nThis returns a data frame with the means of the individual‚Äôs covariates over the observation period and the mean of the Bayesian posterior parameter values.\nWhen trying to find covariate-parameter relationships, it is convenient to examine at all possible covariate-parameter relationships by multiple linear regression with forward and backward elimination - type ?PM_step in the R console for help or see PM_step.\n\nrun1$step()\n\n       age gender height    wt\nka      NA     NA     NA    NA\nke      NA  0.047  0.076 0.105\nv       NA     NA  0.181 0.116\ntlag1   NA  0.162     NA    NA\nafrica  NA     NA     NA    NA\n\n\n‚Ä¶or on the cov object directly.\n\nrun1$cov$step()\n\nicen works here too.\n\nrun1$step(icen = \"mean\")\n\nIf you wish to see P values for forward elimination only:\n\nrun1$step(direction = \"forward\")\n\n         age gender height    wt\nka     0.841  0.519  0.257 0.267\nke     0.920  0.127  0.236 0.281\nv      0.784  0.694  0.084 0.149\ntlag1  0.684  0.287  0.238 0.624\nafrica    NA     NA     NA    NA",
    "crumbs": [
      "Home",
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>Examine the results</span>"
    ]
  },
  {
    "objectID": "index.html#my-project",
    "href": "index.html#my-project",
    "title": "Learn Pmetrics",
    "section": "My Project",
    "text": "My Project\n\nIntroduction\nThis is my first Quarto document. Below is some R code.\n\n# this is an R code chunk\nb &lt;- 2 + 2\nprint(b)\n\n[1] 4\n\n\nYou can see that the value of b is printed above.",
    "crumbs": [
      "Home",
      "<span class='chapter-number'>1</span>¬† <span class='chapter-title'>Introduction</span>"
    ]
  }
]