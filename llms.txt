# Pmetrics [![Pmetrics](reference/figures/Pmetrics_logo.png)](https://lapkb.github.io/Pmetrics/)

Thank you for your interest in `Pmetrics`, created by the [Laboratory of
Applied Pharmacokinetics and Bioinformatics](http://www.lapk.org).
`Pmetrics` is a library package for R to perform non-parametric and
parametric pharmacokinetic-pharmacodynamic population and individual
modeling and simulation. It is primarily designed for pharmacometric
researchers.

`Pmetrics` is based on over 40 years of research by our laboratory and
is the most mature non-parametric method available. Nevertheless,
`Pmetrics` is dynamically evolving. Best of all, it is SHAREWARE with
only a suggested donation.

## Installation

### R (required)

You can download and install [R](https://r-project.org) from the
[Comprehensive R Archive Network (CRAN)](https://cran.r-project.org/).

### Rust (required)

The simulation engine for `Pmetrics` is written in `Rust`, which is
required to fit models.

Follow the instructions on the [Rust
website](https://www.rust-lang.org/tools/install) to install Rust on
your system.

### Pmetrics

`Pmetrics` is distributed on
[r-universe](https://lapkb.r-universe.dev/Pmetrics), and built for
Windows, MacOS, and Linux. To install, you must specify `r-universe` as
the repository using

``` r
install.packages("Pmetrics", repos = "https://lapkb.r-universe.dev")
```

For updating the package and for easier future installations, you can
run the following command to add the `r-universe` repository to your
`R.profile`

``` r
write('options(repos = c(CRAN = "https://cloud.r-project.org", LAPKB = "https://lapkb.r-universe.dev"))', "~/.Rprofile", append = TRUE)
```

With this setup, you can install or update Pmetrics using the standard
command `install.packages("Pmetrics")` without specifying the repository
each time.

### IDE (optional)

In addition, we *strongly* recommend a third-party integrated
development environment (IDE) to use R and Pmetrics rather than the
rudimentary IDE that comes with R. We use all the IDEs below when
developing and working with Pmetrics.

- [RStudio](https://posit.co/download/rstudio-desktop/) is the oldest
  and most stable IDE, developed by [Posit](https://posit.co). Most
  users who only program in R use Rstudio. It has a simple interface
  with many R-specific buttons and menus. It is relatively easy to learn
  and use, but does not support other programming languages.

- [Positron](https://positron.posit.co) is a newer alternative also from
  Posit. Posit are now mostly developing Positron rather than Rstudio.
  Positron primarily supports users who work in R and Python. However,
  it is built upon [VS Code](https://code.visualstudio.com), which gives
  Positron access to thousands of extensions, including multiple AI
  tools to assist with coding and data analysis, and Positron can
  support additional programming languages. It is far more powerful than
  Rstudio, but has a steeper learning curve and currently fewer
  R-specific buttons and menus. VS Code users will find Positron
  familiar.

- [VS Code](https://code.visualstudio.com) itself can be used for R, but
  it is best suited for experienced coders who also use other
  programming languages.

## Related projects

The LAPKB has developed two packages in `Rust` to power `Pmetrics`.

[`pharmsol`](https://github.com/LAPKB/pharmsol) is a Rust library for
defining and solving pharmacokinetic models.

[`PMcore`](https://github.com/LAPKB/PMcore) depends on `pharmsol` to fit
models to data, and implements the different algorithms which are made
available in `Pmetrics`.

Pmetrics and the code that powers it is provided as open-source code.

## Contributing

We welcome contributions in the form of feature requests, raising
issues, or writing code.

## Documentation

We encourage you to visit our
[website](https://lapkb.github.io/Pmetrics/) to learn about Pmetrics.

# Package index

## R6 objects

Pmetrics R6 objects

- [`PM_data`](https://lapkb.github.io/Pmetrics/reference/PM_data.md)
  **\[stable\]** : Defines the PM_data object
- [`PM_model`](https://lapkb.github.io/Pmetrics/reference/PM_model.md)
  **\[stable\]** : Defines the PM_model class
- [`PM_cycle`](https://lapkb.github.io/Pmetrics/reference/PM_cycle.md)
  **\[stable\]** : Pmetrics Run Cycle Information
- [`PM_cov`](https://lapkb.github.io/Pmetrics/reference/PM_cov.md)
  **\[stable\]** : Contains covariate data
- [`PM_final`](https://lapkb.github.io/Pmetrics/reference/PM_final.md)
  **\[stable\]** : Final Cycle Population Values
- [`PM_op`](https://lapkb.github.io/Pmetrics/reference/PM_op.md)
  **\[stable\]** : Observed vs. predicted data
- [`PM_pop`](https://lapkb.github.io/Pmetrics/reference/PM_pop.md)
  **\[stable\]** : Population predictions at short intervals
- [`PM_opt`](https://lapkb.github.io/Pmetrics/reference/PM_opt.md)
  **\[stable\]** : Optimal Sample Times
- [`PM_post`](https://lapkb.github.io/Pmetrics/reference/PM_post.md)
  **\[stable\]** : Individual Bayesian posterior predictions at short
  intervals
- [`PM_sim`](https://lapkb.github.io/Pmetrics/reference/PM_sim.md)
  **\[stable\]** : Object to contain results of simulation
- [`PM_load()`](https://lapkb.github.io/Pmetrics/reference/PM_load.md)
  **\[stable\]** : Load Pmetrics NPAG or IT2B output
- [`PM_result`](https://lapkb.github.io/Pmetrics/reference/PM_result.md)
  **\[stable\]** : Results of a Pmetrics run
- [`PM_valid`](https://lapkb.github.io/Pmetrics/reference/PM_valid.md)
  **\[stable\]** : Pmetrics validation object

## Helpers

Helper functions for R6 object creations

- [`ab()`](https://lapkb.github.io/Pmetrics/reference/ab.md)
  **\[stable\]** : Initial range for primary parameter values
- [`additive()`](https://lapkb.github.io/Pmetrics/reference/additive.md)
  **\[stable\]** : Additive error model
- [`add_renal()`](https://lapkb.github.io/Pmetrics/reference/add_renal.md)
  **\[stable\]** : Estimate renal function using various equations
- [`cor2cov()`](https://lapkb.github.io/Pmetrics/reference/cor2cov.md)
  **\[stable\]** : Convert correlation matrix to covariance matrix
- [`model_lib()`](https://lapkb.github.io/Pmetrics/reference/model_lib.md)
  : Model Library
- [`msd()`](https://lapkb.github.io/Pmetrics/reference/msd.md)
  **\[stable\]** : Initial mean/SD for primary parameter values
- [`proportional()`](https://lapkb.github.io/Pmetrics/reference/proportional.md)
  **\[stable\]** : Proportional error model
- [`interp()`](https://lapkb.github.io/Pmetrics/reference/interp.md)
  **\[stable\]** : Model covariate declaration
- [`PM_tree()`](https://lapkb.github.io/Pmetrics/reference/PM_tree.md)
  [`PMtree()`](https://lapkb.github.io/Pmetrics/reference/PM_tree.md)
  **\[stable\]** : Create a new Pmetrics folder tree
- [`makeAUC()`](https://lapkb.github.io/Pmetrics/reference/makeAUC.md)
  **\[stable\]** : Calculation of AUCs
- [`makeErrorPoly()`](https://lapkb.github.io/Pmetrics/reference/makeErrorPoly.md)
  **\[stable\]** : Assay error polynomial coefficients
- [`makeNCA()`](https://lapkb.github.io/Pmetrics/reference/makeNCA.md) :
  Non-compartmental analysis
- [`makePTAtarget()`](https://lapkb.github.io/Pmetrics/reference/makePTAtarget.md)
  **\[stable\]** : Make a Percent Target Attainment (PTA) Target
- [`make_NCA()`](https://lapkb.github.io/Pmetrics/reference/make_NCA.md)
  : Non-compartmental analysis

## Plot

Functions for plotting Pmetrics output

- [`plot(`*`<PM_cov>`*`)`](https://lapkb.github.io/Pmetrics/reference/plot.PM_cov.md)
  **\[stable\]** : Plot Pmetrics Covariate objects
- [`plot(`*`<PM_cycle>`*`)`](https://lapkb.github.io/Pmetrics/reference/plot.PM_cycle.md)
  **\[stable\]** : Plot Cycle Information
- [`plot(`*`<PM_cycle_data>`*`)`](https://lapkb.github.io/Pmetrics/reference/plot.PM_cycle_data.md)
  **\[stable\]** : Plot PM_cycle_data objects
- [`plot(`*`<PM_data>`*`)`](https://lapkb.github.io/Pmetrics/reference/plot.PM_data.md)
  **\[stable\]** : Plot PM_data Time-Output Data
- [`plot(`*`<PM_final>`*`)`](https://lapkb.github.io/Pmetrics/reference/plot.PM_final.md)
  **\[stable\]** : Plot Pmetrics Final Cycle Parameter Value
  Distributions
- [`plot(`*`<PM_final_data>`*`)`](https://lapkb.github.io/Pmetrics/reference/plot.PM_final_data.md)
  **\[stable\]** : Plot PM_final_data objects
- [`plot(`*`<PM_model>`*`)`](https://lapkb.github.io/Pmetrics/reference/plot.PM_model.md)
  **\[stable\]** : Plot PM_model objects
- [`plot(`*`<PM_op>`*`)`](https://lapkb.github.io/Pmetrics/reference/plot.PM_op.md)
  **\[stable\]** : Plot Pmetrics Observed vs. Predicted Objects
- [`plot(`*`<PM_op_data>`*`)`](https://lapkb.github.io/Pmetrics/reference/plot.PM_op_data.md)
  **\[stable\]** : Plot PM_op_data objects
- [`plot(`*`<PM_opt>`*`)`](https://lapkb.github.io/Pmetrics/reference/plot.PM_opt.md)
  **\[stable\]** : Plot Pmetrics Multiple-Model Optimal Sampling Objects
- [`plot(`*`<PM_pop>`*`)`](https://lapkb.github.io/Pmetrics/reference/plot.PM_pop.md)
  **\[stable\]** : Plot PM_pop Prediction Data
- [`plot(`*`<PM_post>`*`)`](https://lapkb.github.io/Pmetrics/reference/plot.PM_post.md)
  **\[stable\]** : Plot PM_post Prediction Data
- [`plot(`*`<PM_pta>`*`)`](https://lapkb.github.io/Pmetrics/reference/plot.PM_pta.md)
  **\[stable\]** : Plot PM_pta Percent Target Attainment objects
- [`plot(`*`<PM_sim>`*`)`](https://lapkb.github.io/Pmetrics/reference/plot.PM_sim.md)
  **\[stable\]** : Plot Pmetrics Simulation Objects
- [`plot(`*`<PM_valid>`*`)`](https://lapkb.github.io/Pmetrics/reference/plot.PM_valid.md)
  **\[stable\]** : Plot Pmetrics Validation Objects
- [`plot(`*`<PMvalid>`*`)`](https://lapkb.github.io/Pmetrics/reference/plot.PMvalid.md)
  **\[superseded\]** : Plot Pmetrics Validation Objects
- [`plotlygg()`](https://lapkb.github.io/Pmetrics/reference/plotlygg.md)
  **\[stable\]** : Convert a plotly object to ggplot
- [`ab_line()`](https://lapkb.github.io/Pmetrics/reference/ab_line.md)
  **\[stable\]** : Add lines to plotly plot
- [`add_shapes()`](https://lapkb.github.io/Pmetrics/reference/add_shapes.md)
  **\[stable\]** : Add shapes to plotly plot
- [`add_smooth()`](https://lapkb.github.io/Pmetrics/reference/add_smooth.md)
  **\[stable\]** : Add regression to plotly plot
- [`export_plotly()`](https://lapkb.github.io/Pmetrics/reference/export_plotly.md)
  **\[stable\]** : Export plotly plot
- [`sub_plot()`](https://lapkb.github.io/Pmetrics/reference/sub_plot.md)
  **\[stable\]** : Display multiple plotly plots
- [`click_plot()`](https://lapkb.github.io/Pmetrics/reference/click_plot.md)
  **\[stable\]** : Click on plotly plot to highlight traces
- [`getPalettes()`](https://lapkb.github.io/Pmetrics/reference/getPalettes.md)
  **\[stable\]** : Get color palette
- [`getDefaultColors()`](https://lapkb.github.io/Pmetrics/reference/getDefaultColors.md)
  **\[stable\]** : Get a list of default colors
- [`rgba_to_rgb()`](https://lapkb.github.io/Pmetrics/reference/rgba_to_rgb.md)
  **\[stable\]** : Convert RGBA to RGB
- [`opposite_color()`](https://lapkb.github.io/Pmetrics/reference/opposite_color.md)
  **\[stable\]** : Find opposite color with max contrast

## Summary

Functions for summarizing Pmetrics output

- [`summary(`*`<PM_cov>`*`)`](https://lapkb.github.io/Pmetrics/reference/summary.PM_cov.md)
  **\[stable\]** : Summarize Covariates and Bayesian Posterior Parameter
  Values
- [`summary(`*`<PM_cycle>`*`)`](https://lapkb.github.io/Pmetrics/reference/summary.PM_cycle.md)
  **\[stable\]** : Summarize Final Cycle Statistics
- [`summary(`*`<PM_cycle_data>`*`)`](https://lapkb.github.io/Pmetrics/reference/summary.PM_cycle_data.md)
  **\[stable\]** : Summarize PM_cycle_data objects
- [`summary(`*`<PM_data>`*`)`](https://lapkb.github.io/Pmetrics/reference/summary.PM_data.md)
  **\[stable\]** : Summarize PM_data objects
- [`summary(`*`<PM_final>`*`)`](https://lapkb.github.io/Pmetrics/reference/summary.PM_final.md)
  **\[stable\]** : Summary Statistics for Final Cycle
- [`summary(`*`<PM_final_data>`*`)`](https://lapkb.github.io/Pmetrics/reference/summary.PM_final_data.md)
  **\[stable\]** : Summarize PM_final_data objects
- [`summary(`*`<PM_op>`*`)`](https://lapkb.github.io/Pmetrics/reference/summary.PM_op.md)
  **\[stable\]** : Summarize Observations and Predictions
- [`summary(`*`<PM_op_data>`*`)`](https://lapkb.github.io/Pmetrics/reference/summary.PM_op_data.md)
  **\[stable\]** : Summarize PM_op_data objects
- [`summary(`*`<PM_pop>`*`)`](https://lapkb.github.io/Pmetrics/reference/summary.PM_pop.md)
  **\[stable\]** : Summarize Observations and Predictions
- [`summary(`*`<PM_post>`*`)`](https://lapkb.github.io/Pmetrics/reference/summary.PM_post.md)
  **\[stable\]** : Summarize Observations and Predictions
- [`summary(`*`<PM_pta>`*`)`](https://lapkb.github.io/Pmetrics/reference/summary.PM_pta.md)
  **\[stable\]** : Summarize Percent Target Attainment
- [`summary(`*`<PM_sim>`*`)`](https://lapkb.github.io/Pmetrics/reference/summary.PM_sim.md)
  **\[stable\]** : Summarize Pmetrics Simulation Objects
- [`PM_report()`](https://lapkb.github.io/Pmetrics/reference/PM_report.md)
  **\[stable\]** : Generate a report

## Print

Functions for printing Pmetrics output

- [`print(`*`<PM_compare>`*`)`](https://lapkb.github.io/Pmetrics/reference/print.PM_compare.md)
  : Print method for PM_compare objects
- [`print(`*`<PMerr>`*`)`](https://lapkb.github.io/Pmetrics/reference/print.PMerr.md)
  **\[stable\]** : Print Data Errors
- [`print(`*`<PMnpc>`*`)`](https://lapkb.github.io/Pmetrics/reference/print.PMnpc.md)
  **\[stable\]** : Print NPC
- [`print(`*`<summary.PM_cycle>`*`)`](https://lapkb.github.io/Pmetrics/reference/print.summary.PM_cycle.md)
  **\[stable\]** : Print Summary of Cycle Statistics
- [`print(`*`<summary.PM_data>`*`)`](https://lapkb.github.io/Pmetrics/reference/print.summary.PM_data.md)
  **\[stable\]** : Print Summary of Pmetrics Data
- [`print(`*`<summary.PM_final>`*`)`](https://lapkb.github.io/Pmetrics/reference/print.summary.PM_final.md)
  **\[stable\]** : Print Summary of Parameter Values and Credibility
  Intervals
- [`print(`*`<summary.PM_op>`*`)`](https://lapkb.github.io/Pmetrics/reference/print.summary.PM_op.md)
  **\[stable\]** : Print Summary of Observations and Predictions
- [`print(`*`<summary.PM_sim>`*`)`](https://lapkb.github.io/Pmetrics/reference/print.summary.PM_sim.md)
  **\[stable\]** : Print Summary of Simulations

## Auxilliary

Auxilliary functions

- [`all_is_numeric()`](https://lapkb.github.io/Pmetrics/reference/all_is_numeric.md)
  **\[stable\]** : Check if all values are numeric
- [`build_model()`](https://lapkb.github.io/Pmetrics/reference/build_model.md)
  : Launch Model Builder app
- [`build_plot()`](https://lapkb.github.io/Pmetrics/reference/build_plot.md)
  : Launch Plot Builder app
- [`qgrowth()`](https://lapkb.github.io/Pmetrics/reference/qgrowth.md)
  **\[stable\]** : Extract CDC pediatric growth charts
- [`mtsknn.eq()`](https://lapkb.github.io/Pmetrics/reference/mtsknn.eq.md)
  **\[stable\]** : Compare discrete distributions
- [`zBMI()`](https://lapkb.github.io/Pmetrics/reference/zBMI.md)
  **\[stable\]** : Extract CDC pediatric BMI z-scores
- [`ss.PK()`](https://lapkb.github.io/Pmetrics/reference/ss.PK.md)
  **\[stable\]** : Sample size calculations for Phase 1 PK study design
- [`PM_compare()`](https://lapkb.github.io/Pmetrics/reference/PM_compare.md)
  : Compare runs
- [`PMgetCRCL()`](https://lapkb.github.io/Pmetrics/reference/PMgetCRCL.md)
  **\[deprecated\]** : Add CRCL
- [`PM_step()`](https://lapkb.github.io/Pmetrics/reference/PM_step.md)
  **\[superseded\]** : Stepwise covariate-parameter regressions
- [`getCov()`](https://lapkb.github.io/Pmetrics/reference/getCov.md)
  **\[stable\]** : Extract covariate information
- [`getDefaultColors()`](https://lapkb.github.io/Pmetrics/reference/getDefaultColors.md)
  **\[stable\]** : Get a list of default colors
- [`getFixedColNum()`](https://lapkb.github.io/Pmetrics/reference/getFixedColNum.md)
  **\[stable\]** : Number of fixed columns
- [`getPMoptions()`](https://lapkb.github.io/Pmetrics/reference/getPMoptions.md)
  **\[stable\]** : Get Pmetrics User Options
- [`getPalettes()`](https://lapkb.github.io/Pmetrics/reference/getPalettes.md)
  **\[stable\]** : Get color palette

## Datasets

Pmetrics datasets

- [`NPex`](https://lapkb.github.io/Pmetrics/reference/NPex.md) : Example
  NPAG Output with validation
- [`badData`](https://lapkb.github.io/Pmetrics/reference/badData.md) :
  Pmetrics data file with errors
- [`cdc_bmi`](https://lapkb.github.io/Pmetrics/reference/cdc_bmi.md) :
  CDC Pediatric and Adolescent BMI Table
- [`dataEx`](https://lapkb.github.io/Pmetrics/reference/dataEx.md) :
  Pmetrics data file
- [`ger_bmi`](https://lapkb.github.io/Pmetrics/reference/ger_bmi.md) :
  CDC Pediatric and Adolescent BMI Table
- [`growth`](https://lapkb.github.io/Pmetrics/reference/growth.md) : CDC
  Pediatric and Adolescent Growth Data Table
- [`locales`](https://lapkb.github.io/Pmetrics/reference/locales.md) :
  Pmetrics locales
- [`mic1`](https://lapkb.github.io/Pmetrics/reference/mic1.md) : Example
  MIC data
- [`modEx`](https://lapkb.github.io/Pmetrics/reference/modEx.md) :
  Pmetrics model object
- [`simEx`](https://lapkb.github.io/Pmetrics/reference/simEx.md) :
  Example simulator output

## Data processing

Data processing and interconversion

- [`NM2PM()`](https://lapkb.github.io/Pmetrics/reference/NM2PM.md)
  **\[stable\]** : Convert NONMEM to Pmetrics Data Files
- [`PMwrk2csv()`](https://lapkb.github.io/Pmetrics/reference/PMwrk2csv.md)
  **\[stable\]** : Convert Old .wrk Files to .csv Matrix File
- [`PMmatrixRelTime()`](https://lapkb.github.io/Pmetrics/reference/PMmatrixRelTime.md)
  **\[superseded\]** : Convert Absolute Dates and Times to Relative
  Hours
- [`PMreadMatrix()`](https://lapkb.github.io/Pmetrics/reference/PMreadMatrix.md)
  **\[superseded\]** : Read a Pmetrics data file
- [`PMwriteMatrix()`](https://lapkb.github.io/Pmetrics/reference/PMwriteMatrix.md)
  **\[superseded\]** : Write a Pmetrics .csv Matrix File

## Utility

Utility functions

- [`PM_build()`](https://lapkb.github.io/Pmetrics/reference/PM_build.md)
  **\[stable\]** : Build Pmetrics
- [`PM_help()`](https://lapkb.github.io/Pmetrics/reference/PM_help.md)
  **\[stable\]** : Get Help and Report Issues
- [`PMcheck()`](https://lapkb.github.io/Pmetrics/reference/PMcheck.md)
  **\[superseded\]** : Check Pmetrics Inputs for Errors
- [`PMpatch()`](https://lapkb.github.io/Pmetrics/reference/PMpatch.md) :
  Download and install Pmetrics patches
- [`PMtest()`](https://lapkb.github.io/Pmetrics/reference/PMtest.md)
  **\[stable\]** : Test Pmetrics
- [`PM_tutorial()`](https://lapkb.github.io/Pmetrics/reference/PM_tutorial.md)
  **\[stable\]** : Pmetrics tutorial
- [`setPMoptions()`](https://lapkb.github.io/Pmetrics/reference/setPMoptions.md)
  **\[stable\]** : Set Pmetrics User Options

## Internal

Internal and low-level functions

- [`compile_model()`](https://lapkb.github.io/Pmetrics/reference/compile_model.md)
  : Compiles the text representation of a model into a binary file.
- [`dummy_compile()`](https://lapkb.github.io/Pmetrics/reference/dummy_compile.md)
  : Dummy function to cache compilation artifacts.
- [`simulate_all()`](https://lapkb.github.io/Pmetrics/reference/simulate_all.md)
  : Simulates all subjects in the data set using the model at the given
  path.
- [`simulate_one()`](https://lapkb.github.io/Pmetrics/reference/simulate_one.md)
  : Simulates the first subject in the data set using the model at the
  given path.
- [`fit()`](https://lapkb.github.io/Pmetrics/reference/fit.md) : Fits
  the model at the given path to the data at the given path using the
  provided parameters.
- [`is_cargo_installed()`](https://lapkb.github.io/Pmetrics/reference/is_cargo_installed.md)
  : Checks if Cargo is installed on the system.
- [`model_parameters()`](https://lapkb.github.io/Pmetrics/reference/model_parameters.md)
  : Retrieves the model parameters from the compiled model at the given
  path.
- [`temporary_path()`](https://lapkb.github.io/Pmetrics/reference/temporary_path.md)
  : Retrieves the temporary path used for building models.

## Reference

Reference functions

- [`PM_manual()`](https://lapkb.github.io/Pmetrics/reference/PM_manual.md)
  :

  Open user and function manuals. **\[stable\]**

- [`Pmetrics-package`](https://lapkb.github.io/Pmetrics/reference/Pmetrics-package.md)
  [`Pmetrics`](https://lapkb.github.io/Pmetrics/reference/Pmetrics-package.md)
  : Parametric and non-parametric modeling and simulation of
  pharmacokinetic-pharmacodynamic systems.

# Articles

### All vignettes

- [Pmetrics](https://lapkb.github.io/Pmetrics/articles/pmetrics.md):
