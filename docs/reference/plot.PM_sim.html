<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Plots PM_sim objects with the option to perform a visual and numerical predictive check"><title>Plot Pmetrics Simulation Objects — plot.PM_sim • Pmetrics</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot Pmetrics Simulation Objects — plot.PM_sim"><meta property="og:description" content="Plots PM_sim objects with the option to perform a visual and numerical predictive check"><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">Pmetrics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plot Pmetrics Simulation Objects</h1>
      
      <div class="d-none name"><code>plot.PM_sim.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plots <em>PM_sim</em> objects with the option to perform a visual and numerical predictive check</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for PM_sim</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  mult <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  log <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  ci <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  binSize <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  outeq <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  marker <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Time"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Output"</span>,</span>
<span>  <span class="va">xlim</span>,</span>
<span>  <span class="va">ylim</span>,</span>
<span>  legend <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  <span class="va">obs</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>The name of an <em>PM_sim</em> data object generated by <a href="PM_sim.html">PM_sim</a></p></dd>


<dt>mult</dt>
<dd><p>Multiplication factor for y axis, e.g. to convert mg/L to ng/mL</p></dd>


<dt>log</dt>
<dd><p>Boolean operator to plot the y axis in log base 10.
This argument maps to the
the yaxis type value in the layout object in plotly.
Use the plotly <code><a href="https://rdrr.io/pkg/plotly/man/schema.html" class="external-link">plotly::schema()</a></code> command in the console and navigate
to layout &gt; layoutAttributes &gt; yaxis &gt; type.
Example: <code>log = T</code></p></dd>


<dt>probs</dt>
<dd><p>List of quantiles to plot, e.g. <code>probs = list(0.05, 0.5, 0.95)</code>.
If set to <code>NA</code>, all simulated profiles will be plotted,
and numerical predictive checking will be suppressed.
To format individual quantile lines, expand the list object for that quantile
For example, <code>probs = list(0.05, list(value = 0.5, color = "red", width = 2, dash = "dash"), 0.95)</code>.
Use the plotly <code><a href="https://rdrr.io/pkg/plotly/man/schema.html" class="external-link">plotly::schema()</a></code> command
in the console and navigate to traces &gt; scatter &gt; attributes &gt; line to see all the ways the marker
can be formatted. Most common will be:</p><ul><li><p>color Fill color and outline color if not otherwise specified</p></li>
<li><p>symbol Plotting character. See <code><a href="https://rdrr.io/pkg/plotly/man/schema.html" class="external-link">plotly::schema()</a></code>, traces &gt; scatter &gt; attributes &gt; marker &gt; symbol &gt; values.</p></li>
<li><p>size Character size in points</p></li>
<li><p>opacity Ranging between 0 (fully transparent) to 1 (fully opaque).</p></li>
</ul></dd>


<dt>ci</dt>
<dd><p>Width of confidence interval bands around simulated quantiles,
from 0 to 1.  If 0, or <em>nsim</em>&lt;100, will not plot.
Default is 0.95, i.e. 95th percentile with tails of 2.5 percent above and below excluded.</p></dd>


<dt>binSize</dt>
<dd><p>Width of binning interval for simulated concentrations, in time units, e.g. hours.
A <code>binSize</code> of 0.5 will pull all simulated concentrations +/- 0.5 hours into
the same time.  This is useful
for plotting PMsim objects made during <a href="makeValid.html">makeValid</a>. The default is 0, i.e. no binning.
If an <code>obs</code> object is provided, it will be binned similarly.</p></dd>


<dt>outeq</dt>
<dd><p>Which output equation to plot. Default is 1.</p></dd>


<dt>marker</dt>
<dd><p>Controls the plotting symbol for observations.
This argument maps to the plotly marker object.
It can be boolean or a list.
<code>TRUE</code> will plot the marker with default characteristics.
<code>FALSE</code> will suppress marker plotting.
If a list, can control many marker characteristics, including overriding defaults.
Use the plotly <code><a href="https://rdrr.io/pkg/plotly/man/schema.html" class="external-link">plotly::schema()</a></code> command in the console and navigate
to traces &gt; scatter &gt; attributes &gt; marker to see all the ways the marker
can be formatted. Most common will be:</p><ul><li><p>color Marker color.</p></li>
<li><p>symbol Plotting character. See <code><a href="https://rdrr.io/pkg/plotly/man/schema.html" class="external-link">plotly::schema()</a></code>, traces &gt; scatter &gt; attributes &gt; marker &gt; symbol &gt; values.</p></li>
<li><p>size Character size in points.</p></li>
<li><p>opacity Ranging between 0 (fully transparent) to 1 (fully opaque).</p></li>
<li><p>line A list of  additional attributes governing the outline for filled shapes, most commonly
color and width.
Example: <code>marker = list(color = "red", symbol = "triangle", opacity = 0.8, line = list(color = "black", width = 2))</code></p></li>
</ul></dd>


<dt>grid</dt>
<dd><p>Controls grid display.
This argument maps to the xaxis and yaxis layout objects in plotly.
Use the plotly <code><a href="https://rdrr.io/pkg/plotly/man/schema.html" class="external-link">plotly::schema()</a></code> command in the console and navigate
to layout &gt; layoutAttributes &gt; xaxis or yaxis &gt; gridcolor or gridwidth.
It is a Boolean operator. If <code>FALSE</code>, no grid is plotted.
If <code>TRUE</code>, the default color <em>grey50</em> and width 1 will be plotted at
major tick marks. If a list,
color and width can be customized.
Examples:</p><ul><li><p><code>grid = F</code></p></li>
<li><p><code>grid = list(gridcolor = "black", gridwidth = 2)</code></p></li>
</ul></dd>


<dt>xlab</dt>
<dd><p>Value for x axis label.
This argument maps to the the xaxis layout object in plotly.
Use the plotly <code><a href="https://rdrr.io/pkg/plotly/man/schema.html" class="external-link">plotly::schema()</a></code> command in the console and navigate
to layout &gt; layoutAttributes &gt; xaxis to see other ways to customize
this axis using lists as additional arguments to the plot function.
Example: <code>xaxis = list(title = list(text = "Time", font = list(color = "red", family = "Arial", size = 10)))</code></p></dd>


<dt>ylab</dt>
<dd><p>Value for y axis label.
This argument maps to the yaxis layout object in plotly.
Use the plotly <code><a href="https://rdrr.io/pkg/plotly/man/schema.html" class="external-link">plotly::schema()</a></code> command in the console and navigate
to layout &gt; layoutAttributes &gt; yaxis to see other ways to customize
this axis using lists as additional arguments to the plot function.
Example: <code>yaxis = list(title = list(text = "Concentration", font = list(color = "blue", family = "Times New Roman", size = 12)))</code></p></dd>


<dt>xlim</dt>
<dd><p>Limits of the x axis as a vector.
This argument maps to the
the xaxis range in the layout object in plotly.
Use the plotly <code><a href="https://rdrr.io/pkg/plotly/man/schema.html" class="external-link">plotly::schema()</a></code> command in the console and navigate
to layout &gt; layoutAttributes &gt; xaxis &gt; range.
Example: <code>xlim = c(0,1)</code></p></dd>


<dt>ylim</dt>
<dd><p>Limits of the y axis as a vector.
This argument maps to the
the yaxis range in the layout object in plotly.
Use the plotly <code><a href="https://rdrr.io/pkg/plotly/man/schema.html" class="external-link">plotly::schema()</a></code> command in the console and navigate
to layout &gt; layoutAttributes &gt; yaxis &gt; range.
Example: <code>ylim = c(0,100)</code></p></dd>


<dt>legend</dt>
<dd><p>Controls display of legend.
This argument maps to the plotly layout showlegend and legend arguments.
It is either a boolean operator (most common) or a list of parameters to be supplied to plotly.
See <code><a href="https://rdrr.io/pkg/plotly/man/schema.html" class="external-link">plotly::schema()</a></code> &gt; layout &gt; layoutAttributes &gt; legend and showlegend
for more details on the available options for formatting.
If legend is supplied as a list,  the plotly layout &gt; layoutAttributes &gt; showlegend value will
be set to <code>TRUE</code> automatically.
Examples:</p><ul><li><p><code>legend = T</code></p></li>
<li><p><code>legend = list(orientation = "h", font = list(color = "blue"))</code></p></li>
</ul></dd>


<dt>obs</dt>
<dd><p>The name of a <a href="PM_result.html">PM_result</a> data object or the PM_op field in the
PM_result object, all generated by <a href="PM_load.html">PM_load</a>.  For example, if
<code>run1 &lt;- PM_load(1)</code> and <code>sim1</code> is a PM_sim object, then
<code>sim1$plot(obs = run1)</code> or <code>sim1$plot(obs = run1$op)</code>.
If specified,
the observations will be overlaid upon the simulation plot
enabling a visual predictive check.  In this case,
a list object will be returned with two items: $npc containing the quantiles
and probability that the observations
are below each quantile (binomial test); and $simsum, the times of each
observation and the
value of the simulated quantile with upper and lower confidence intervals at that time.
Additionally, the number of observations beyond the 5th and 95th percentiles will be reported
and the binomial test P-value if this number is different than the expected 10% value.</p></dd>


<dt>quiet</dt>
<dd><p>Suppress plot if <code>TRUE</code>.</p></dd>


<dt>...</dt>
<dd><p>Other parameters which can be passed to control axis formatting. Specify as lists
named either xaxis or yaxis. See <code><a href="https://rdrr.io/pkg/plotly/man/schema.html" class="external-link">plotly::schema()</a></code> layout &gt; xaxis/yaxis for options.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Plots the simulation object.  If <code>obs</code> is included, a list will be returned with
the folowing items:</p><ul><li><p>npc A dataframe with three columns: quantile, prop_less, pval.
** quantile are those specified by the <code>probs</code> argument to the plot call
** prop_less are the proportion of simulated
observations at all times less than the quantile
** pval is the P-value of the difference in the
prop.less and quantile by the beta-binomial test.</p></li>
<li><p>simsum A dataframe with the quantile concentration at each simulated time,
with lower and upper confidence intervals</p></li>
<li><p>obs A data frame similar to an PMop object made by <a href="makeOP.html">makeOP</a> at the end of a run
with the addition of the quantile for each observation</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Simulated observations are plotted as quantiles on the y-axis vs. time on the x.axis.  If measured
observations are included, a visual and numerical predictive check will be performed.
The default plot is to omit markers, but if the marker arugment is set to <code>TRUE</code>,
the resulting marker will have the following plotly properties:
<code>list(symbol = "circle-open", color = "black", size = 8)</code>. By default a grid is
omitted. The legend is also omitted by default, but if included,
clicking on a quantile item in the legend will hide it in the plot,
and double clicking will hide all other quantiles.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="PM_sim.html">PM_sim</a>, plot_ly, schema</p>
<p>Other PMplots: 
<code><a href="plot.MMopt.html">plot.MMopt</a>()</code>,
<code><a href="plot.PM_data.html">plot.PM_data</a>()</code>,
<code><a href="plot.PM_final.html">plot.PM_final</a>()</code>,
<code><a href="plot.PM_op.html">plot.PM_op</a>()</code>,
<code><a href="plot.PM_pta.html">plot.PM_pta</a>()</code>,
<code><a href="plot.PM_valid.html">plot.PM_valid</a>()</code>,
<code><a href="plot.PMcov.html">plot.PMcov</a>()</code>,
<code><a href="plot.PMcycle.html">plot.PMcycle</a>()</code>,
<code><a href="plot.PMdopt.html">plot.PMdopt</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Michael Neely</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Michael Neely, Julián Otálvaro.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

