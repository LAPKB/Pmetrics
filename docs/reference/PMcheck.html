<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function will check a .csv file or a data frame containing a
previously loaded .csv file (the output of PMreadMatrix for errors
which would cause the analysis to fail.  If a model file is provided, and the data
file has no errors, it will also check the model file for errors."><title>Check Pmetrics Inputs for Errors — PMcheck • Pmetrics</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Check Pmetrics Inputs for Errors — PMcheck"><meta property="og:description" content="This function will check a .csv file or a data frame containing a
previously loaded .csv file (the output of PMreadMatrix for errors
which would cause the analysis to fail.  If a model file is provided, and the data
file has no errors, it will also check the model file for errors."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">Pmetrics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Check Pmetrics Inputs for Errors</h1>
      
      <div class="d-none name"><code>PMcheck.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function will check a .csv file or a data frame containing a
previously loaded .csv file (the output of <code><a href="PMreadMatrix.html">PMreadMatrix</a></code> for errors
which would cause the analysis to fail.  If a model file is provided, and the data
file has no errors, it will also check the model file for errors.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">PMcheck</span><span class="op">(</span><span class="va">data</span>, <span class="va">model</span>, fix <span class="op">=</span> <span class="cn">F</span>, quiet <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>The name of a Pmetrics .csv matrix file in the current working directory,
the full path to one not in the current working directory, or a data.frame containing
the output of a previous <code><a href="PMreadMatrix.html">PMreadMatrix</a></code> command.</p></dd>


<dt>model</dt>
<dd><p>The filename of a Pmetrics model file in the current working directory.  This parameter is optional.
If specified, and the data object has no errors, the model file will be evaluated.</p></dd>


<dt>fix</dt>
<dd><p>Boolean operator; if <code>TRUE</code>, Pmetrics will attempt to fix errors in the data file.
Default is <code>FALSE</code>.</p></dd>


<dt>quiet</dt>
<dd><p>Boolean operator to suppress printed output.  Default is false.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>If <code>fix=TRUE</code>, then <code>PMcheck</code> returns a PMmatrix data object which has been
cleaned of errors as much as possible, displaying a report on the console.
If <code>fix=FALSE</code>, then <code>PMcheck</code> creates a file in the working directory called “errors.xlsx”.
This file can be opened by Microsoft Excel or any other program that is capable of reading .xlsx files.  This file
contains highlighted areas that are erroneous, with clarifying comments.  You can correct the errors in the file
and then re-save as a .csv file.</p>


<p>When <code>fix=FALSE</code>, the function also returns a list of objects of class <em>PMerr</em>.  Each object is itself a list whose
first object (<code>$msg</code>) is a character vector with “OK” plus a brief description if there is no error, or the error.
The second object (<code>$results</code>) is a vector of the row numbers that contain that error.</p>
<dl><dt>colorder</dt>
<dd><p>The first 14 columns must be named id, evid, time, dur, dose, addl, ii, input, out, outeq, c0, c1, c2, and c3 in that order.</p></dd>

<dt>maxcharCol</dt>
<dd><p>All column names should be less than or equal to 11 characters.</p></dd>

<dt>maxcharID</dt>
<dd><p>All id values should be less than or equal to 11 characters.</p></dd>

<dt>missEVID</dt>
<dd><p>Ensure that all rows have an EVID value.</p></dd>

<dt>missTIME</dt>
<dd><p>Ensure that all rows have a TIME value.</p></dd>

<dt>doseDur</dt>
<dd><p>Make sure all dose records are complete, i.e. contain a duration.</p></dd>

<dt>doseDose</dt>
<dd><p>Make sure all dose records are complete, i.e. contain a dose.</p></dd>

<dt>doseInput</dt>
<dd><p>Make sure all dose records are complete, i.e. contain an input number.</p></dd>

<dt>obsOut</dt>
<dd><p>Make sure all observation records are complete, i.e. contain an output.</p></dd>

<dt>obsOuteq</dt>
<dd><p>Make sure all observation records are complete, i.e. contain and outeq number.</p></dd>

<dt>T0</dt>
<dd><p>Make sure each subject's first time=0.</p></dd>

<dt>covT0</dt>
<dd><p>Make sure that there is an non-missing entry for each covariate at time=0 for each subject.</p></dd>

<dt>timeOrder</dt>
<dd><p>Ensure that all times within a subject ID are monotonically increasing.</p></dd>

<dt>contigID</dt>
<dd><p>Ensure that all subject IDs are contiguous.</p></dd>

<dt>nonNum</dt>
<dd><p>Ensure that all columns except ID are numeric.</p></dd>

<dt>noObs</dt>
<dd><p>Ensure that all subjects have at least one observation, which could be missing, i.e. -99.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Either a filename or a data object in memory are accepted as <code>data</code>.
The format of the .csv matrix file is fairly rigid.
It must have the following features.  Text is case-sensitive.</p><ul><li><p>A header in row 1 with the appropriate version, currently “POPDATA DEC_11”</p></li>
<li><p>Column headers in row 2.  These headers are: #ID, EVID, TIME, DUR, DOSE, ADDL, II, INPUT, OUT, OUTEQ,
C0, C1, C2, C3.</p></li>
<li><p>No cell should be empty.  It should either contain a value or “.” as a placeholder.</p></li>
<li><p>Columns after C3 are interpreted as covariates.</p></li>
<li><p>All subject records must begin with TIME=0.</p></li>
<li><p>All dose events (EVID=1) must have entries in ID, EVID, TIME, DUR, DOSE and INPUT.  ADDL and II are optional, but if ADDL is not 0 or
missing, then II is mandatory.</p></li>
<li><p>All observation events (EVID=0) must have entries in ID, EVID, TIME, OUT, OUTEQ.
If an observation is missing, use <em>-99</em>; otherwise use a “.” as a placeholder
in cells that are not required (e.g. INPUT for an observation event).</p></li>
<li><p>If covariates are present in the data, there must be an entry for every covariate at time 0 for each subject.</p></li>
<li><p>All covariates must be numeric.</p></li>
<li><p>All times within a subject ID must be monotonically increasing.</p></li>
<li><p>All subject IDs must be contiguous.</p></li>
<li><p>All rows must have EVID and TIME values.</p></li>
<li><p>All columns must be numeric except ID which may be alpha-numeric.</p></li>
<li><p>All subjects must have at least one observation, which could be missing, i.e. -99.</p></li>
</ul><p>To use this function, see the example below.</p>
<p>After running PMcheck and looking at the errors in the errors.xlsx file, you can fix the
errors manually directly in the errors.xlsx file and resave it as a .csv file.
Alternatively, you could then try to fix the problem(s) with <code>mdata2 &lt;- PMcheck(mdata,fix=T)</code>.  Note that we are now returning
a PMmatrix data object called mdata2 (hopefully cleaned of errors) rather than the PMerr object returned when <code>fix=FALSE</code>.
Pmetrics handles each of the errors in the following ways.</p><ul><li><p>If the columns are simply out of order, they will be reordered.  If some are missing, the fix must
be done by the user, i.e. manually.</p></li>
<li><p>All id and covariate values are truncated to 11 characters.</p></li>
<li><p>Missing observations are set to -99 (not “.”).</p></li>
<li><p>Incomplete dose records are flagged for the user to fix manually.</p></li>
<li><p>Incomplete observation records are flagged for the user to fix manually.</p></li>
<li><p>Subjects without an EVID=1 as first event are flagged for the user to fix manually.</p></li>
<li><p>Subjects with TIME != 0 as first event have dummy dose=0 events inserted at time 0.</p></li>
<li><p>Subjects with a missing covariate at time 0 are flagged for the user to fix manually.</p></li>
<li><p>Non-numeric covariates are converted to numeric (via <a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a>).</p></li>
<li><p>Non-ordered times are sorted within a subject if there are no EVID=4 events; otherwise the
user must fix manually.</p></li>
<li><p>Non-contiguous subject ID rows are combined and sorted if there are no EVID=4 events; otherwise the
user must fix manually.</p></li>
<li><p>Rows missing an EVID are assigned a value of 0 if DOSE is  missing, 1 otherwise.</p></li>
<li><p>Rows missing a TIME value are flagged for the user to fix manually.</p></li>
<li><p>Columns that are non-numeric which must be numeric are flagged for the user to fix manually.
These are EVID, TIME, DUR, DOSE, ADDL, II, INPUT, OUT, OUTEQ, C0, C1, C2, and C3.
Covariate columns are fixed separately (see above).</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="PMwriteMatrix.html">PMwriteMatrix</a></code>, <code><a href="PMreadMatrix.html">PMreadMatrix</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Michael Neely and Patrick Nolain</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">badCSV</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">err</span> <span class="op">&lt;-</span> <span class="fu">PMcheck</span><span class="op">(</span><span class="va">badCSV</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#look at the errors.xlsx file in the working directory</span></span></span>
<span class="r-in"><span><span class="co">#try to automatically fix what can be fixed</span></span></span>
<span class="r-in"><span><span class="va">goodData</span> <span class="op">&lt;-</span> <span class="fu">PMcheck</span><span class="op">(</span><span class="va">badCSV</span>,fix<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">PMcheck</span><span class="op">(</span><span class="va">goodData</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#you have to fix manually problems which require data entry</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Michael Neely, Julián Otálvaro.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

