<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Pmetrics">
<title>Workflow • Pmetrics</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Workflow">
<meta property="og:description" content="Pmetrics">
<meta property="og:image" content="https://lapkb.github.io/Pmetrics/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">Pmetrics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/pmetrics.html">Start Here</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/intro.html">Introduction</a>
    <a class="dropdown-item" href="../articles/overview.html">Overview</a>
    <a class="dropdown-item" href="../articles/workflow.html">Workflow</a>
    <a class="dropdown-item" href="../articles/data.html">Data Objects</a>
    <a class="dropdown-item" href="../articles/models.html">Model Objects</a>
    <a class="dropdown-item" href="../articles/running.html">Running the fit</a>
    <a class="dropdown-item" href="../articles/objects.html">Created Objects</a>
    <a class="dropdown-item" href="../articles/simulation.html">Simulation</a>
    <a class="dropdown-item" href="../articles/plotly.html">Plotly plots</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/LAPKB/Pmetrics/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Workflow</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/LAPKB/Pmetrics/blob/HEAD/vignettes/workflow.Rmd" class="external-link"><code>vignettes/workflow.Rmd</code></a></small>
      <div class="d-none name"><code>workflow.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="general-workflow">General Workflow<a class="anchor" aria-label="anchor" href="#general-workflow"></a>
</h2>
<p><span class="r6">R6</span></p>
<p>The general Pmetrics workflow in R6 for IT2B and NPAG is shown in the
following diagram.</p>
<p><img src="Images/Slide1.png"></p>
<p>The user creates the data and model objects at the top. These can
come from the hard drive or from within R (dashed arrows). The model
file is created in R using the <code>PM_model$new()</code> function and
the data file by <code>PM_data$new()</code>. When combined using
<code>PM_fit$new()</code> and the <code>$run()</code> function on the
resulting object, the analysis is executed. At the end of the run, the
hard drive will contain a new numerically named folder, e.g., 1, 2, 3,
…, that contains the files which can be loaded into R subsequently using
<code>PM_load(x)</code>, replacing <code>x</code> with the folder
number. <code><a href="../reference/PM_load.html">PM_load()</a></code> is an alias for
<code>PM_result$new()</code> because it creates a new
<code>PM_result</code> object which contains all the results of a run,
and has many assciated methods attached to it for plotting, simulating,
etc.</p>
<p>To change model parameters, the model object is updated via
<code>PM_model$update()</code>, <code>PM_fit$new()</code> is called and
then the run is executed with <code>$run()</code>. If continuing a
previous run that did not end, simply use the <code>$run()</code> and
specify the run number you wish to continue as the <code>prior</code>
argument to <code>$run()</code>. These scenarios are illustrated
below.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Run 1 - ensure the data, model files are in the working directory</span></span>
<span><span class="va">data1</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/PM_data.html">PM_data</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"data.csv"</span><span class="op">)</span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/PM_model.html">PM_model</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"model.txt"</span><span class="op">)</span></span>
<span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/PM_fit.html">PM_fit</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">data1</span>, <span class="va">mod1</span><span class="op">)</span></span>
<span><span class="va">fit1</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">res1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PM_load.html">PM_load</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="co">#PM_load is an alias for PM_result$new()</span></span>
<span></span>
<span><span class="co">#Run 2 - update Ke range</span></span>
<span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="va">mod1</span><span class="op">$</span><span class="va">clone</span> <span class="co">#create an independent copy</span></span>
<span><span class="va">mod2</span><span class="op">$</span><span class="fu">update</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pri <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Ke <span class="op">=</span> <span class="fu">ab</span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/PM_fit.html">PM_fit</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">data1</span>, <span class="va">mod2</span><span class="op">)</span></span>
<span><span class="va">fit2</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Run 3 - continue run 2</span></span>
<span><span class="va">fit2</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span>prior <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>The great advantage of R6 over Legacy is that in R6, you no longer
need to spend time copying files from prior run folders, modifying them,
and ensuring that they are in the working directory. After the initial
creation of the data and model objects, everything can be done in R from
memory, although results are still saved to hard drive for later
retrieval.</p>
<p><span class="legacy">Legacy</span></p>
<p>The general Pmetrics workflow in Legacy for IT2B and NPAG is shown in
the following diagram. The major differences compared to R6 are:</p>
<ul>
<li>
<em>Data and model</em> The data is always a .csv file, and the
model is always a text file which must be edited to make changes. Both
must be copied from a prior folder to the current working directory for
every run.</li>
<li>
<em>Run.</em> Separate commands for NPAG and IT2B must be used,
i.e. <code><a href="../reference/NPrun.html">NPrun()</a></code> and <code><a href="../reference/ITrun.html">ITrun()</a></code>.</li>
<li>
<em>Loading.</em> Results are loaded with <code><a href="https://lapkb.github.io/Pmetrics/reference/PMcheckMatrix.html">PMload()</a></code> not
<code><a href="../reference/PM_load.html">PM_load()</a></code> because the former returns a collection of
results all suffixed with the run number, e.g. <code>op.1</code> or
<code>final.1</code> for run 1. This can lead to confusion if working on
two projects at once, or uncertainty about what is actually loaded.</li>
</ul>
<p><img src="Images/Slide2.png"></p>
<p>The user supplies the names of the data and model files as arguments
to the run functions. R is used to specify the working directory
containing these files. The analysis is executed in a terminal window by
calling <code><a href="../reference/NPrun.html">NPrun()</a></code>, <code><a href="../reference/ITrun.html">ITrun()</a></code> or
<code><a href="../reference/ERRrun.html">ERRrun()</a></code> functions. The results can be loaded into R after
the run completes using <code><a href="https://lapkb.github.io/Pmetrics/reference/PMcheckMatrix.html">PMload()</a></code>. The analgous Legacy code
to the R6 code above is shown here.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Run 1 - ensure the data, model files are in the working directory</span></span>
<span><span class="fu"><a href="../reference/NPrun.html">NPrun</a></span><span class="op">(</span><span class="st">"data.csv"</span>, <span class="st">"model.txt"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://lapkb.github.io/Pmetrics/reference/PMcheckMatrix.html">PMload</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> </span>
<span></span>
<span><span class="co">#Run 2 - update Ke range - edit file outside R, copy to working directory</span></span>
<span><span class="co">#use same data as for run 1</span></span>
<span><span class="fu"><a href="../reference/NPrun.html">NPrun</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fl">1</span>, <span class="st">"model2.txt"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Run 3 - continue run 2</span></span>
<span><span class="fu"><a href="../reference/NPrun.html">NPrun</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fl">1</span>, model <span class="op">=</span> <span class="fl">1</span>, prior <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>While there are fewer lines of R code than for R6, the edits made to
create model2.txt are not recorded anywhere in R, and must be made
outside R, with cumbersome file copying to ensure everything is in the
working directory.</p>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Michael Neely, Julián Otálvaro.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
