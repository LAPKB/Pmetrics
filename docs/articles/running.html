<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Pmetrics">
<title>Running model fits • Pmetrics</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Running model fits">
<meta property="og:description" content="Pmetrics">
<meta property="og:image" content="https://lapkb.github.io/Pmetrics/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">Pmetrics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/data.html">Data objects</a>
    <a class="dropdown-item" href="../articles/intro.html">Introduction</a>
    <a class="dropdown-item" href="../articles/models.html">Models</a>
    <a class="dropdown-item" href="../articles/objects.html">Created Objects</a>
    <a class="dropdown-item" href="../articles/overview.html">Overview</a>
    <a class="dropdown-item" href="../articles/plotly.html">How to use plotly in Pmetrics</a>
    <a class="dropdown-item" href="../articles/pmetrics.html">Pmetrics</a>
    <a class="dropdown-item" href="../articles/running.html">Running model fits</a>
    <a class="dropdown-item" href="../articles/simulation.html">Simulation</a>
    <a class="dropdown-item" href="../articles/workflow.html">Workflow</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/LAPKB/Pmetrics/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Running model fits</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/LAPKB/Pmetrics/blob/HEAD/vignettes/running.Rmd" class="external-link"><code>vignettes/running.Rmd</code></a></small>
      <div class="d-none name"><code>running.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="fitting-data-to-models">Fitting data to models<a class="anchor" aria-label="anchor" href="#fitting-data-to-models"></a>
</h2>
<p>In this section, we suggest a workflow to help you maintain organized
modeling projects.</p>
<div class="section level3">
<h3 id="setting-up-a-pmetrics-project">Setting up a Pmetrics project<a class="anchor" aria-label="anchor" href="#setting-up-a-pmetrics-project"></a>
</h3>
<p><span class="legacy">Legacy</span><span class="r6">R6</span></p>
<p>When beginning a new modeling project, it is convenient to use the
command <code><a href="../reference/PMtree.html">PMtree()</a></code>. This command will set up a new directory
in the current working directory named whatever you have included as the
“project name”.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/PMtree.html">PMtree</a></span><span class="op">(</span><span class="st">"DrugX"</span><span class="op">)</span></span></code></pre></div>
<p>In the above example, a directory called “DrugX” will be created in
the current working directory in R, which you can check with the
<code>getwd</code> function. Beneath the new DrugX directory, several
subdirectories will be also created.</p>
<ul>
<li>
<strong>Rscript</strong> contains a skeleton R script to begin
Pmetrics runs in the new project.</li>
<li>
<strong>Runs</strong> should contain all files required for a run
(described next) and it will also contain the resulting numerically
ordered run directories created after each Pmetrics NPAG or IT2B
run.</li>
<li>
<strong>Sim</strong> can contain any files related to
simulations</li>
<li>
<strong>src</strong> is a repository for original and manipulated
source data files</li>
</ul>
<p>You are free to edit this directory tree structure as you please, or
make your own entirely.</p>
</div>
<div class="section level3">
<h3 id="getting-the-required-inputs-to-run-pmetrics">Getting the required inputs to run Pmetrics<a class="anchor" aria-label="anchor" href="#getting-the-required-inputs-to-run-pmetrics"></a>
</h3>
<p><span class="r6">R6</span></p>
<p>There is a full tutorial encoded inside Pmetrics to teach new users
the basic functionality of the whole package. To start that tutorial in
R type:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lapkb.github.io/Pmetrics/">Pmetrics</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/PM_tutorial.html">PM_tutorial</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Follow the instructions prompted in the terminal.</p>
<p>To setup a R6 Pmetrics run, you must provide <code><a href="../reference/PM_data.html">PM_data()</a></code>
and <code><a href="../reference/PM_model.html">PM_model()</a></code> objects. Once created, it does not matter
where the files (if there are any) are located on your system because
Pmetrics will use those objects, not the files.</p>
<p>To bring these together, use the <code>PM_fit$new()</code> object
creator. It only needs two arguments: the name of the data file in the
working directory or in memory loaded via the Legacy
<code><a href="../reference/PMreadMatrix.html">PMreadMatrix()</a></code>and a model object. <code><a href="../reference/PM_fit.html">PM_fit()</a></code>
will accept a model object created by <code>PM_model</code> or the name
of a model file in Legacy format and in the working directory.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#Example 1 - data and model objects</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/PM_data.html">PM_data</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"data.csv"</span><span class="op">)</span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/PM_model.html">PM_model</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/PM_fit.html">PM_fit</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">dat</span>, <span class="va">mod1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Example 2 - data file and PM_model object</span></span>
<span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/PM_fit.html">PM_fit</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>data <span class="op">=</span> <span class="st">"data.csv"</span>, model <span class="op">=</span> <span class="va">mod1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Example 3 - data object and model file</span></span>
<span><span class="va">PMdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PMreadMatrix.html">PMreadMatrix</a></span><span class="op">(</span><span class="st">"data.csv"</span><span class="op">)</span></span>
<span><span class="va">fit3</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/PM_fit.html">PM_fit</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>data <span class="op">=</span> <span class="va">PMdata</span>, model <span class="op">=</span> <span class="st">"model.txt"</span><span class="op">)</span></span></code></pre></div>
<p>The fit object also contains a couple of methods attached to it.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit1</span><span class="op">$</span><span class="fu">check</span><span class="op">(</span><span class="op">)</span> <span class="co">#This will check the consistency between the model and the data</span></span>
<span></span>
<span><span class="va">fit2</span><span class="op">$</span><span class="fu">save</span><span class="op">(</span><span class="st">"fit2.rds"</span><span class="op">)</span> <span class="co">#This will save the fit to a file in your working directory</span></span>
<span></span>
<span><span class="va">fit2_again</span> <span class="op">&lt;-</span> <span class="va">PM_fit</span><span class="op">$</span><span class="fu">load</span><span class="op">(</span><span class="st">"fit2.rds"</span><span class="op">)</span> <span class="co">#This will load the fit again from disk</span></span></code></pre></div>
<p>To see the full list of methods available see
<code><a href="../reference/PM_fit.html">?PM_fit</a></code>.</p>
<p><span class="legacy">Legacy</span></p>
<p>When you wish to execute a Pmetrics run, you must ensure that
appropriate Pmetrics model.txt and data.csv files are in the working
directory, i.e. the Runs subdirectory of the project directory. R can be
used to help prepare the data.csv file by importing and manipulating
spreadsheets (e.g. <code>read.csv</code>). The Pmetrics function
<code><a href="../reference/PMcheck.html">PMcheck()</a></code> can be used to check a .csv file or an R
dataframe that is to be saved as a Pmetrics data.csv file for errors. It
can also check a model file for errors in the context of a datafile,
e.g. covariates that do not match. <code>PMcheck(...,fix=T)</code>
attempts to automatically rid data files of errors. The function
<code>PMwriteMatrix</code> can be used to write the R data object in the
correct format for use by IT2B, NPAG, or the Simulator.</p>
</div>
<div class="section level3">
<h3 id="running-the-model-to-fit-the-data">Running the model to fit the data<a class="anchor" aria-label="anchor" href="#running-the-model-to-fit-the-data"></a>
</h3>
<p><span class="r6">R6</span></p>
<p>Once the <code><a href="../reference/PM_fit.html">PM_fit()</a></code> object is created the
<code>$run()</code> method will execute the fit. Arguments for this
method can be found in the help for <code><a href="../reference/NPrun.html">NPrun()</a></code> and
<code><a href="../reference/ITrun.html">ITrun()</a></code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#default run parameters</span></span>
<span><span class="va">fit3</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#change the cycle number from default 100</span></span>
<span><span class="va">fit3</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span>cycles<span class="op">=</span><span class="fl">500</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#change the engine from default NPAG</span></span>
<span><span class="va">fit3</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span>engine <span class="op">=</span> <span class="st">"IT2B"</span><span class="op">)</span></span></code></pre></div>
<p><span class="legacy">Legacy</span></p>
<p>As you will see in the skeleton R script made by
<code><a href="../reference/PMtree.html">PMtree()</a></code> and placed in the Rscript subdirectory, if this is
a first-time run, the R commands to run IT2B or NPAG are as follows.
Recall that the “#” character is a comment character.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lapkb.github.io/Pmetrics/">Pmetrics</a></span><span class="op">)</span></span>
<span><span class="co">#Run 1 - add your run description here</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="st">"working directory"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/NPrun.html">NPrun</a></span><span class="op">(</span><span class="op">)</span> <span class="co">#for NPAG or ITrun() for IT2B</span></span></code></pre></div>
<p>The first line will load the Pmetrics library of functions. The
second line sets the working directory to the specified path. The third
line generates the batch file to run NPAG or IT2B and saves it to the
working directory.</p>
<p><strong>NOTE</strong>: On Mac systems, the batch file will be
automatically launched in a Terminal window. On Windows systems prior to
version 1.9, the batch file must be launched manually by double clicking
the <em>npscript.bat</em> or <em>itscript.bat</em> file in the working
directory. As of version 1.9, Windows users no longer need to do
this.</p>
<p><code><a href="../reference/ITrun.html">ITrun()</a></code> and <code><a href="../reference/NPrun.html">NPrun()</a></code> are described in full
detail via their help commands in R. At minimum, they require a data
file and a model file. If the default names of “data.csv” and
“model.txt” are used, they may be called with no arguments. Again, the
data and model files must be in the current working directory, usually
the Runs folder.</p>
<p>Both functions return the full path of the output directory to the
clipboard. By default, runs are placed in folders numbered sequentially,
beginning with “1”.</p>
<p>When you wish to execute a Pmetrics run, you must ensure that both of
the appropriate Pmetrics data.csv and model.txt files are in the working
directory, i.e. the Runs subdirectory of the project directory. The
names are supplied as arguments to <code>NPrun</code>,
<code>ITrun</code>, and <code>ERRrun</code>. A shorthand notation is to
supply the number of a previous run for either the data, model or both
files so that you do not have to manually copy them into the working
directory.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Using default names data.csv and model.txt</span></span>
<span><span class="fu"><a href="../reference/NPrun.html">NPrun</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Using custom names</span></span>
<span><span class="fu"><a href="../reference/ITrun.html">ITrun</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"model1.txt"</span>, data <span class="op">=</span> <span class="st">"mydata.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Grab data from run 1 and use default model.txt</span></span>
<span><span class="fu"><a href="../reference/NPrun.html">NPrun</a></span><span class="op">(</span>data<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Use model and data from run 2 and continue where run 2 ended</span></span>
<span><span class="fu"><a href="../reference/NPrun.html">NPrun</a></span><span class="op">(</span>data<span class="op">=</span><span class="fl">2</span>, model<span class="op">=</span><span class="fl">2</span>, prior<span class="op">=</span><span class="fl">2</span>, cycles<span class="op">=</span><span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p>You can also download sample data and scripts from the <a href="http://lapk.org/pmetrics.php" class="external-link">Pmetrics downloads</a> section of
our website. Edit prior versions of model files to make new model
files.</p>
</div>
</div>
<div class="section level2">
<h2 id="loading-results-after-a-completed-run">Loading results after a completed run<a class="anchor" aria-label="anchor" href="#loading-results-after-a-completed-run"></a>
</h2>
<p><span class="r6">R6</span></p>
<p>After the execution is done, you can load the output into R using
<code><a href="../reference/PM_load.html">PM_load()</a></code>. Note the underscore “_” to distinguish this
function from the Legacy <code><a href="../reference/PMload.html">PMload()</a></code>. The argument to the
function is the run number which you wish to load, corresponding to a
folder with the same number in your <strong>Runs</strong> folder (if you
made one).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_run</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PM_load.html">PM_load</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>This creates a <code><a href="../reference/PM_result.html">PM_result()</a></code> object called
<code>my_run</code>. Detailed information about the different elements
contained in the result object can be accessed via
<code><a href="../reference/PM_result.html">?PM_result</a></code> or by typing the result object into the
terminal.</p>
<p>After that, that object can be used to access the different elements
of the results, for example:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exRes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PM_load.html">PM_load</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">exRes</span><span class="op">$</span><span class="va">final</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span><span class="op">)</span> <span class="co">#see ?plot.PM_final</span></span>
<span><span class="va">exRes</span><span class="op">$</span><span class="va">op</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span>type<span class="op">=</span><span class="st">"pop"</span><span class="op">)</span> <span class="co">#see ?plot.PM_op,</span></span>
<span><span class="va">exRes</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span>overlay <span class="op">=</span> <span class="cn">F</span>, </span>
<span>                line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pred <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">exRes</span><span class="op">$</span><span class="va">post</span>, color <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span>, join <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>,</span>
<span>                marker <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>symbol <span class="op">=</span> <span class="st">"diamond-open"</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span>, </span>
<span>                log <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co"># see ?plot.PM_data</span></span></code></pre></div>
<p><span class="legacy">Legacy</span></p>
<p>Now the output of IT2B or NPAG needs to be loaded into R, so the next
command does this.</p>
<p><code>PMload(run_number)</code></p>
<p>Details of these commands and what is loaded are described in the R
documentation <code><a href="../reference/PMload.html">?PMload</a></code>. The <strong>run_number</strong>
should be included within the parentheses to be appended to the names of
loaded R objects, allowing for comparison between runs,
e.g. <code>PMload(1)</code>. Finally, at this point other Pmetrics
commands can be added to the script to process the data, such as the
following.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">final.1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cycle.1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">op.1</span>,type<span class="op">=</span><span class="st">"pop"</span><span class="op">)</span> <span class="co">#or plot(op.1$pop1)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">op.1</span><span class="op">)</span> <span class="co">#default is to plot posterior predictions for output 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">op.1</span>,type<span class="op">=</span><span class="st">"pop"</span>,resid<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p>Of course, the full power of R can be used in scripts to analyze
data, but these simple statements serve as examples.</p>
<p>If you do not use the <code>PMtree</code> structure, we suggest that
the R script for a particular project be saved into a folder called
“Rscript” or some other meaningful name in the working directory.
Folders are not be moved by the batch file. Within the script, number
runs sequentially and use comments liberally to distinguish runs, as
shown below.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lapkb.github.io/Pmetrics/">Pmetrics</a></span><span class="op">)</span></span>
<span><span class="co">#Run 1 - Ka, Kel, V, all subjects</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="st">"working directory"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/NPrun.html">NPrun</a></span><span class="op">(</span><span class="op">)</span> <span class="co">#assumes model="model.txt" and data="data.csv"</span></span>
<span><span class="fu"><a href="../reference/PMload.html">PMload</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Remember in R that the command <code>example(function)</code> will
provide examples for the specified function. Most Pmetrics functions
have examples.</p>
<!-- ## Using Shiny to control Pmetrics -->
<!-- Shiny is an R package made by the same group who produces Rstudio. While -->
<!-- you are learning to use Pmetrics, you can use a graphical user interface -->
<!-- that teaches you how to build code. Currently we have implemented Shiny -->
<!-- interfaces for NPAG, IT2B and many plots in Pmetrics. -->
<!-- To use these Shiny interfaces, type `PMcode("x")`, where x is the function -->
<!-- you wish. Currently you have two choices: "run" and "plot". -->
<!-- `PMcode("run")` will launch the following dialog window in your default -->
<!-- browser. As you make your selections, you will see R code generated -->
<!-- which you can copy back to your script and execute. Simply close the -->
<!-- browser window when you are finished. -->
<!-- You can select from an NPAG or IT2B run, and then use the Data, Model, -->
<!-- and Run tabs to navigate to different options. With a valid Pmetrics -->
<!-- model and data file loaded, you will see a summary of the model in the -->
<!-- Current Model window. -->
<!-- If you use `PMcode("plot")` you will see the dialog window below. It will -->
<!-- allow you to select various Pmetrics objects that have been already -->
<!-- loaded with `PMload`, and offer you many plot options, as well as the -->
<!-- code to generate you selected plot. -->
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Michael Neely, Julián Otálvaro.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
