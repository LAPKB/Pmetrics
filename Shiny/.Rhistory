theme(legend.position="none") +
scale_fill_grey()
mmopt
mmopt <- OP[OP$year=="Y3",]
mmopt$sampCat <- cut(mmopt$timeafter,c(0,2,10,12,100),labels=c("peak","random","trough","post-trough"))
table(mmopt$sampCat)
mmopt
prop.table(table(mmopt$sampCat))
mmopt$sampCat
p <- ggplot(mmopt,aes(x="",y=sampCat))
p + coord_polar("y")
table(mmopt$sampCat)
p <- ggplot(mmoptTable,aes(x="",y=mmoptTable,fill=names(mmoptTable)))
p + coord_polar("y")
mmoptTable <- table(mmopt$sampCat)
mmoptTable
p <- ggplot(mmoptTable,aes(x="",y=mmoptTable,fill=names(mmoptTable)))
mmoptTable <- data.frame(table(mmopt$sampCat))
mmoptTable
mmoptDF <- data.frame(table(mmopt$sampCat))
p <- ggplot(mmoptDF,aes(x="",y=Freq,fill=Var1))
p + coord_polar("y")
p <- ggplot(mmoptDF,aes(x="",y=Freq,fill=Var1))
p + geom_bar()
mmoptDF
p <- ggplot(mmoptDF,aes(x=Var1,y=Freq,fill=Var1))
p + geom_bar()
p <- ggplot(mmoptDF,aes(x=Var1,y=Freq,fill=Var1))
p + geom_bar(stat="identity")
?geom_bar
p <- ggplot(mmoptDF,aes(x=Var1,y=Freq,fill=Var1))
p + geom_bar(stat="identity") +
#labs(x="Year",y="Vancomycin AUC:MIC") +
theme(legend.position="none") +
scale_fill_grey()
p <- ggplot(mmoptDF,aes(x=Var1,y=Freq,fill=Var1))
p + geom_bar(stat="identity") +
labs(x="Sample Window",y="Number") +
theme(legend.position="none") +
scale_fill_grey()
mmoptDF
mmoptDF
p <- ggplot(mmoptDF,aes(x=Var1,y=Freq,fill=Var1))
p + geom_bar(stat="identity",label=Freq) +
labs(x="Sample Window",y="Number") +
theme(legend.position="none") +
scale_fill_grey()
p <- ggplot(mmoptDF,aes(x=Var1,y=Freq,fill=Var1))
p + geom_bar(stat="identity",label="y") +
labs(x="Sample Window",y="Number") +
theme(legend.position="none") +
scale_fill_grey()
?geom_text
p <- ggplot(mmoptDF,aes(x=Var1,y=Freq,fill=Var1))
p + geom_bar(stat="identity") +
geom_text(aes(label=y),vjust=0) +
labs(x="Sample Window",y="Number") +
theme(legend.position="none") +
scale_fill_grey()
p <- ggplot(mmoptDF,aes(x=Var1,y=Freq,fill=Var1))
p + geom_bar(stat="identity") +
geom_text(aes(label=Freq),vjust=0) +
labs(x="Sample Window",y="Number") +
theme(legend.position="none") +
scale_fill_grey()
p <- ggplot(mmoptDF,aes(x=Var1,y=Freq,fill=Var1))
p + geom_bar(stat="identity") +
geom_text(aes(label=Freq),vjust=2) +
labs(x="Sample Window",y="Number") +
theme(legend.position="none") +
scale_fill_grey()
p <- ggplot(mmoptDF,aes(x=Var1,y=Freq,fill=Var1))
p + geom_bar(stat="identity") +
geom_text(aes(label=Freq),vjust=-22) +
labs(x="Sample Window",y="Number") +
theme(legend.position="none") +
scale_fill_grey()
p <- ggplot(mmoptDF,aes(x=Var1,y=Freq,fill=Var1))
p + geom_bar(stat="identity") +
geom_text(aes(label=Freq),vjust=-2) +
labs(x="Sample Window",y="Number") +
theme(legend.position="none") +
scale_fill_grey()
p <- ggplot(mmoptDF,aes(x=Var1,y=Freq,fill=Var1))
p + geom_bar(stat="identity") +
geom_text(aes(label=Freq),vjust=-1) +
labs(x="Sample Window",y="Number") +
theme(legend.position="none") +
scale_fill_grey()
p <- ggplot(mmoptDF,aes(x=Var1,y=Freq,fill=Var1))
p + geom_bar(stat="identity") +
geom_text(aes(label=Freq),vjust=-0.5) +
labs(x="Sample Window",y="Number") +
theme(legend.position="none") +
scale_fill_grey()
mmopt$timeafter
summary(mmopt$timeafter)
mmopt <- OP[OP$year=="Y3",]
mmopt$sampCat <- cut(mmopt$timeafter,c(0,2,10,12,100),labels=c("0 to <2","2 to <10","10 to <12","12 to 32"))
mmoptDF <- data.frame(table(mmopt$sampCat))
mmoptDF
p <- ggplot(mmoptDF,aes(x=Var1,y=Freq,fill=Var1))
p + geom_bar(stat="identity") +
geom_text(aes(label=Freq),vjust=-0.5) +
labs(x="Hours After Dose",y="Number") +
theme(legend.position="none") +
scale_fill_grey()
p <- ggplot(mmoptDF,aes(x=Var1,y=Freq,fill=Var1))
p + geom_bar(stat="identity") +
geom_text(aes(label=Freq),vjust=-0.5) +
geom_text(aes(x=Var1,y=0,label=c("Peak","Random","Trough","Post-Trough")),vjust=-0.5) +
labs(x="Hours After Dose",y="Number") +
theme(legend.position="none") +
scale_fill_grey()
p <- ggplot(mmoptDF,aes(x=Var1,y=Freq,fill=Var1))
p + geom_bar(stat="identity") +
geom_text(aes(label=Freq),vjust=-0.5) +
geom_text(aes(x=Var1,y=0,label=c("Peak","Random","Trough","Post-Trough")),vjust=0.5) +
labs(x="Hours After Dose",y="Number") +
theme(legend.position="none") +
scale_fill_grey()
p <- ggplot(mmoptDF,aes(x=Var1,y=Freq,fill=Var1))
p + geom_bar(stat="identity") +
geom_text(aes(label=Freq),vjust=-0.5) +
geom_text(aes(x=Var1,y=0,label=c("Peak","Random","Trough","Post-Trough")),vjust=1) +
labs(x="Hours After Dose",y="Number") +
theme(legend.position="none") +
scale_fill_grey()
p <- ggplot(mmoptDF,aes(x=Var1,y=Freq,fill=Var1))
p + geom_bar(stat="identity") +
geom_text(aes(label=Freq),vjust=-0.5) +
geom_text(aes(x=Var1,y=0,label=c("Peak","Random","Trough","Post-Trough")),vjust=1.2) +
labs(x="Hours After Dose",y="Number") +
theme(legend.position="none") +
scale_fill_grey()
p <- ggplot(mmoptDF,aes(x=Var1,y=Freq,fill=Var1))
p + geom_bar(stat="identity") +
geom_text(aes(label=Freq),vjust=-0.5) +
geom_text(aes(x=Var1,y=0,col="grey50",label=c("Peak","Random","Trough","Post-Trough")),vjust=1.2) +
labs(x="Hours After Dose",y="Number") +
theme(legend.position="none") +
scale_fill_grey()
p <- ggplot(mmoptDF,aes(x=Var1,y=Freq,fill=Var1))
p + geom_bar(stat="identity") +
geom_text(aes(label=Freq),vjust=-0.5) +
geom_text(aes(x=Var1,y=0,col="grey80",label=c("Peak","Random","Trough","Post-Trough")),vjust=1.2) +
labs(x="Hours After Dose",y="Number") +
theme(legend.position="none") +
scale_fill_grey()
p <- ggplot(mmoptDF,aes(x=Var1,y=Freq,fill=Var1))
p + geom_bar(stat="identity") +
geom_text(aes(label=Freq),vjust=-0.5) +
geom_text(aes(x=Var1,y=0,color="grey50",label=c("Peak","Random","Trough","Post-Trough")),vjust=1.2) +
labs(x="Hours After Dose",y="Number") +
theme(legend.position="none") +
scale_fill_grey()
p <- ggplot(mmoptDF,aes(x=Var1,y=Freq,fill=Var1))
p + geom_bar(stat="identity") +
geom_text(aes(label=Freq),vjust=-0.5) +
geom_text(aes(x=Var1,y=0,colour="grey50",label=c("Peak","Random","Trough","Post-Trough")),vjust=1.2) +
labs(x="Hours After Dose",y="Number") +
theme(legend.position="none") +
scale_fill_grey()
p <- ggplot(mmoptDF,aes(x=Var1,y=Freq,fill=Var1))
p + geom_bar(stat="identity") +
geom_text(aes(label=Freq),vjust=-0.5) +
geom_label(aes(x=Var1,y=0,label=c("Peak","Random","Trough","Post-Trough")),vjust=1.2) +
labs(x="Hours After Dose",y="Number") +
theme(legend.position="none") +
scale_fill_grey()
p <- ggplot(mmoptDF,aes(x=Var1,y=Freq,fill=Var1))
p + geom_bar(stat="identity") +
geom_text(aes(label=Freq),vjust=-0.5) +
geom_label(aes(x=Var1,y=0,label=c("Peak","Random","Trough","Post-Trough")),vjust=1.2,fill="white") +
labs(x="Hours After Dose",y="Number") +
theme(legend.position="none") +
scale_fill_grey()
p <- ggplot(mmoptDF,aes(x=Var1,y=Freq,fill=Var1))
p + geom_bar(stat="identity") +
geom_text(aes(label=Freq),vjust=-0.5) +
geom_label(aes(x=Var1,y=0,label=c("Peak","Random","Trough","Post-Trough")),vjust=1.2,fill="white",color="grey50") +
labs(x="Hours After Dose",y="Number") +
theme(legend.position="none") +
scale_fill_grey()
p <- ggplot(mmoptDF,aes(x=Var1,y=Freq,fill=Var1))
p + geom_bar(stat="identity") +
geom_text(aes(label=Freq),vjust=-0.5) +
geom_label(aes(x=Var1,y=0,label=c("Peak","Random","Trough","Post-Trough")),vjust=1.2,fill="white",color="grey40") +
labs(x="Hours After Dose",y="Number") +
theme(legend.position="none") +
scale_fill_grey()
simdata
plot(simdata,probs=0.5,add=T,col="red",lwd=1)
plot(simdata,probs=0.5,col="black",lwd=1)
plot(conc~timeafter,OP,xlab="Hours after dose",ylab="Vancomycin mg/L",type="n")
plot(simdata,probs=0.5,add=T,col="red",lwd=1,x.qlab=2)
plot(conc~timeafter,OP,xlab="Hours after dose",ylab="Vancomycin mg/L",type="n")
plot(simdata,probs=0.5,add=T,col="red",lwd=1,x.qlab=2)
points(x=mmopt$timeafter,y=20)
head(mmopt)
points(x=mmopt$timeafter,y=mmopt$conc)
plot(conc~timeafter,OP,xlab="Hours after dose",ylab="Vancomycin mg/L",type="n")
plot(simdata,probs=0.5,add=T,col="black",lwd=2,x.qlab=2)
points(x=mmopt$timeafter,y=mmopt$conc)
points(x=mmopt$timeafter,y=mmopt$conc,col="grey40")
polygon(x=c(10,10,12,12),y=c(10,20,20,10),border=NA,col=alpha("grey70",0.5))
plot(conc~timeafter,OP,xlab="Hours after dose",ylab="Vancomycin mg/L",type="n")
plot(simdata,probs=0.5,add=T,col="black",lwd=2,x.qlab=2)
polygon(x=c(10,10,12,12),y=c(0,50,50,0),border=NA,col=alpha("grey70",0.5))
points(x=mmopt$timeafter,y=mmopt$conc,col="grey40")
prop.table(table(mmopt$sampCat))
save.image("~/Documents/Research and Grants/GMS 2011/Vancomycin/Data/Analysis.RData")
library(Hmisc)
library(reshape2)
library(tidyr)
library(dplyr)
library(lubridate)
library(openxlsx)
library(ggplot2)
load("~/Documents/Research and Grants/GMS 2011/Vancomycin/Data/Analysis.RData")
p <- ggplot(OP[!OP$first,],aes(year,auc,fill=year))
p + geom_violin() +
geom_hline(yintercept = c(300,400,800),lty=c(2,1,3)) +
labs(x="Year",y="Vancomycin AUC mg*h/L") +
theme(legend.position="none")
p <- ggplot(mic,aes(year,aucmic,fill=year))
p + geom_violin() +
geom_hline(yintercept = c(300,400), lty=c(2,1)) +
labs(x="Year",y="Vancomycin AUC:MIC") +
theme(legend.position="none")
var.test(auc~year,OP[!OP$first & OP$year!="Y2",]) #year 1 vs. 3
names(mic)
head(mic)
var.test(aucmic~year,mic[mic$year!="Y2",]) #year 1 vs. 3
var.test(aucmic~year,mic[mic$year!="Y1",]) #year 2 vs. 3
brkdn(aucmic~year,mic)
var.test(aucmic~year,mic[mic$year!="Y3",]) #year 1 vs. 2
summary(aov(aucmic~year,mic))
kruskal.test(aucmic~year,mic)
brkdn(aucmic~year,mic)
p <- ggplot(mic,aes(year,aucmic,fill=year))
p + geom_violin() +
geom_hline(yintercept = c(300,400), lty=c(2,1)) +
geom_hline(yintercept = 1068, col="blue") +
labs(x="Year",y="Vancomycin AUC:MIC") +
theme(legend.position="none") +
scale_fill_grey()
p <- ggplot(mic,aes(year,aucmic,fill=year))
p + geom_violin() +
geom_hline(yintercept = c(300,400), lty=c(2,1)) +
geom_hline(yintercept = 560, col="blue") +
labs(x="Year",y="Vancomycin AUC:MIC") +
theme(legend.position="none") +
scale_fill_grey()
p <- ggplot(mic,aes(year,aucmic,fill=year))
p + geom_violin() +
geom_hline(yintercept = c(300,400), lty=c(2,1)) +
geom_hline(yintercept = 465, col="blue") +
labs(x="Year",y="Vancomycin AUC:MIC") +
theme(legend.position="none") +
scale_fill_grey()
library(Shiny)
library(shiny)
setwd("~/LAPK/PmetricsSource/Shiny")
runApp("Simulator")
new <- c(18,11,11,11,4,3,7,2)
period <- 1:8
plot(new~period,type="h")
plot(new~period,type="h",lwd=15)
barplot(new~period)
?barplot
barplot(new)
library(ggplot2)
?geom_bar
?ggplot
p <- ggplot() +
geom_col(aes(x=period,y=new))
p
p <- ggplot(aes(x=period,y=new)) +
geom_col()
p <- ggplot() +
geom_col(aes(x=period,y=new,color="red"))
p
p <- ggplot() +
geom_col(aes(x=period,y=new,fill="red"))
p
p <- ggplot() +
geom_col(aes(x=period,y=new,fill="red")) +
theme(legend.position="none")
p
fte_theme <- function() {
# Generate the colors for the chart procedurally with RColorBrewer
palette <- brewer.pal("Greys", n=9)
color.background = palette[2]
color.grid.major = palette[3]
color.axis.text = palette[6]
color.axis.title = palette[7]
color.title = palette[9]
# Begin construction of chart
theme_bw(base_size=9) +
# Set the entire chart region to a light gray color
theme(panel.background=element_rect(fill=color.background, color=color.background)) +
theme(plot.background=element_rect(fill=color.background, color=color.background)) +
theme(panel.border=element_rect(color=color.background)) +
# Format the grid
theme(panel.grid.major=element_line(color=color.grid.major,size=.25)) +
theme(panel.grid.minor=element_blank()) +
theme(axis.ticks=element_blank()) +
# Format the legend, but hide by default
theme(legend.position="none") +
theme(legend.background = element_rect(fill=color.background)) +
theme(legend.text = element_text(size=7,color=color.axis.title)) +
# Set title and axis labels, and format these and tick marks
theme(plot.title=element_text(color=color.title, size=10, vjust=1.25)) +
theme(axis.text.x=element_text(size=7,color=color.axis.text)) +
theme(axis.text.y=element_text(size=7,color=color.axis.text)) +
theme(axis.title.x=element_text(size=8,color=color.axis.title, vjust=0)) +
theme(axis.title.y=element_text(size=8,color=color.axis.title, vjust=1.25)) +
# Plot margins
theme(plot.margin = unit(c(0.35, 0.2, 0.3, 0.35), "cm"))
}
p <- ggplot() +
geom_col(aes(x=period,y=new,fill="red")) +
fte_theme()
library(scales)
library(grid)
library(RColorBrewer)
p <- ggplot() +
geom_col(aes(x=period,y=new,fill="red")) +
fte_theme()
p
p <- ggplot() +
geom_col(aes(x=period,y=new,fill="red")) +
fte_theme()
p
p <- ggplot() +
geom_col(aes(x=period,y=new,fill="red",alpha=0.5)) +
fte_theme()
p
p <- ggplot() +
geom_col(aes(x=period,y=new,fill="red",alpha=0.75)) +
fte_theme()
p
p <- ggplot() +
geom_col(aes(x=period,y=new,fill="red",alpha=0.9)) +
fte_theme()
p
p <- ggplot() +
geom_col(aes(x=period,y=new,fill="red",alpha=1)) +
fte_theme()
p
p <- ggplot() +
geom_col(aes(x=period,y=new,fill="red")) +
fte_theme()
p
p <- ggplot() +
geom_col(aes(x=period,y=new,fill="#c0392b",alpha=0.75)) +
fte_theme()
p
p <- ggplot() +
geom_col(aes(x=period,y=new,fill="#c0392b",alpha=0.9)) +
fte_theme()
p
p <- ggplot() +
geom_col(aes(x=period,y=new,fill="#c0392b")) +
fte_theme()
p
p <- ggplot() +
geom_col(aes(x=period,y=new,fill="#c0392b")) +
p
p <- ggplot() +
geom_col(aes(x=period,y=new,fill="#c0392b")) +
theme(legend.pos="none")
p
p <- ggplot() +
geom_col(aes(x=period,y=new,fill="#c0392b")) +
theme(legend.pos="none") +
scale_x_discrete(labels=c("1" = "80-84",
"2" = "85-90",
"3" = "91-94",
"4" = "95-99",
"5" = "00-04",
"6" = "05-09",
"7" = "10-14",
"6" = "15-17"))
p
p <- ggplot() +
geom_col(aes(x=period,y=new,fill="#c0392b")) +
theme(legend.pos="none") +
scale_x_discrete(labels=c("1" = "80-84",
"2" = "85-90",
"3" = "91-94",
"4" = "95-99",
"5" = "00-04",
"6" = "05-09",
"7" = "10-14",
"8" = "15-17"))
p
p <- ggplot() +
geom_col(aes(x=period,y=new,fill="#c0392b")) +
theme(legend.pos="none") +
scale_x_discrete(labels=c("80-84","85-90","91-94","95-99","05-09","10-14","15-17"))
p
p <- ggplot() +
geom_col(aes(x=period,y=new,fill="#c0392b")) +
theme(legend.pos="none") +
scale_x_discrete(labels=c("80-84","85-90","91-94","95-99","05-09","10-14","15-17"))
p
?scale_x_discrete
p <- ggplot() +
geom_col(aes(x=period,y=new,fill="#c0392b")) +
theme(legend.pos="none",axis.text.x = element_text(size=8) +
scale_x_discrete(labels=c("80-84","85-90","91-94","95-99","05-09","10-14","15-17"))
p
p <- ggplot() +
geom_col(aes(x=period,y=new,fill="#c0392b")) +
theme(legend.pos="none",axis.text.x = element_text(size=8)) +
scale_x_discrete(labels=c("80-84","85-90","91-94","95-99","05-09","10-14","15-17"))
p
p <- ggplot() +
geom_col(aes(x=period,y=new,fill="#c0392b")) +
theme(legend.pos="none",axis.text.x = element_text(size=8)) +
scale_x_continuous(labels=c("80-84","85-90","91-94","95-99","05-09","10-14","15-17"))
p
p <- ggplot() +
geom_col(aes(x=period,y=new,fill="#c0392b")) +
theme(legend.pos="none",axis.text.x = element_text(size=8)) +
scale_x_continuous(labels=c("80-84","85-90","91-94","95-99","00-04","05-09","10-14","15-17"))
p
p <- ggplot() +
geom_col(aes(x=period,y=new,fill="#c0392b")) +
theme(legend.pos="none",axis.text.x = element_text(size=8)) +
scale_x_continuous(breaks=1:8,labels=c("80-84","85-90","91-94","95-99","00-04","05-09","10-14","15-17"))
p
p <- ggplot() +
geom_col(aes(x=period,y=new,fill="#c0392b")) +
theme(legend.pos="none",axis.text.x = element_text(size=10)) +
scale_x_continuous(breaks=1:8,labels=c("80-84","85-90","91-94","95-99","00-04","05-09","10-14","15-17"))
p
p <- ggplot() +
geom_col(aes(x=period,y=new,fill="#c0392b")) +
theme(legend.pos="none",axis.text.x = element_text(size=10)) +
scale_x_continuous("Years",breaks=1:8,labels=c("80-84","85-90","91-94","95-99","00-04","05-09","10-14","15-17")) +
p
p <- ggplot() +
geom_col(aes(x=period,y=new,fill="#c0392b")) +
theme(legend.pos="none",axis.text.x = element_text(size=10)) +
scale_x_continuous(breaks=1:8,labels=c("80-84","85-90","91-94","95-99","00-04","05-09","10-14","15-17")) +
p
p <- ggplot() +
geom_col(aes(x=period,y=new,fill="#c0392b")) +
theme(legend.pos="none",axis.text.x = element_text(size=10)) +
scale_x_continuous("Years",breaks=1:8,labels=c("80-84","85-90","91-94","95-99","00-04","05-09","10-14","15-17"))
p
p <- ggplot() +
geom_col(aes(x=period,y=new,fill="#c0392b")) +
theme(legend.pos="none",axis.text.x = element_text(size=10)) +
scale_x_continuous("Years",breaks=1:8,labels=c("80-84","85-90","91-94","95-99","00-04","05-09","10-14","15-17")) +
ylab("Number")
p
p <- ggplot() +
geom_col(aes(x=period,y=new,fill="#c0392b")) +
theme(legend.pos="none",axis.text.x = element_text(size=10)) +
scale_x_continuous("Years",breaks=1:8,
labels=c("80-84","85-90","91-94","95-99","00-04","05-09","10-14","15-17")) +
ylab("Number of New Antibiotics")
p
p <- ggplot() +
geom_col(aes(x=period,y=new,fill="#c0392b")) +
theme(legend.pos="none",axis.text.x = element_text(size=10), axis.title=element_text(size=14)) +
scale_x_continuous("Years",breaks=1:8,
labels=c("80-84","85-90","91-94","95-99","00-04","05-09","10-14","15-17")) +
ylab("Number of New Antibiotics")
p
p <- ggplot() +
geom_col(aes(x=period,y=new,fill="#c0392b")) +
theme(legend.pos="none",axis.text.x = element_text(size=10), axis.title=element_text(size=14)) +
scale_x_continuous("Years",breaks=1:5,
labels=c("95-99","00-04","05-09","10-14","15-17")) +
ylab("Number of New Antibiotics")
p
new <- c(7,1,1,6,2)
period <- 1:5
p <- ggplot() +
geom_col(aes(x=period,y=new,fill="#c0392b")) +
theme(legend.pos="none",axis.text.x = element_text(size=10), axis.title=element_text(size=14)) +
scale_x_continuous("Years",breaks=1:5,
labels=c("95-99","00-04","05-09","10-14","15-17")) +
ylab("Number of New Antibiotics")
p
?curve
hill <- function(x){
100*x / (10 + x )
}
curve(hill,from=0,to=100,log="x")
curve(hill,from=0.01,to=100,log="x")
curve(hill,from=0.01,to=1000,log="x")
curve(hill,from=0.01,to=1000,log="x",xaxt="n",ylab="% kill")
curve(hill,from=0.01,to=1000,log="x",xaxt="n",ylab="% kill",xlab="Drug Concentration")
abline(v=10)
curve(hill,from=0.01,to=1000,log="x",xaxt="n",ylab="% Kill",xlab="Drug Concentration",lwd=3,col="red")
abline(v=10,lty=3)
abline(v=10,h=50,lty=3)
new <- c(7,1,3,6,2)
period <- 1:5
p <- ggplot() +
geom_col(aes(x=period,y=new,fill="#c0392b")) +
theme(legend.pos="none",axis.text.x = element_text(size=10), axis.title=element_text(size=14)) +
scale_x_continuous("Years",breaks=1:5,
labels=c("95-99","00-04","05-09","10-14","15-17")) +
ylab("Number of New Antibiotics")
p
