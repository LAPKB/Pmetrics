# Created Objects

## 1 Objects created after a run

After a successful NPAG/NPOD run, an R datafile is saved in the /outputs
subdirectory of the newly created numerically ordered folder in the
working directory. This file is called “PMout.Rdata”. These data files
can be loaded by ensuring that the Runs folder is set as the working
directory or using the `path` argument to `$fit()`, and then using the
Pmetrics command
`` [`PM_load`](https://lapkb.github.io/Pmetrics/reference/PM_load.html) ``.

There are several Pmetrics data objects contained within the Rdata files
which are loaded, making these objects available for plotting and other
analysis.

[`PM_load()`](https://lapkb.github.io/Pmetrics_rust/reference/PM_load.md)
returns a
[`PM_result`](https://lapkb.github.io/Pmetrics/reference/PM_result.html)object.
The fields in the object are in the table below.

| Objects                   | Fields        | Methods   | Comments                                                                                                                                                                                                                                                                                                  |
|---------------------------|---------------|-----------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| \$op (class: PM_op)       | \$id          |           | Subject identification                                                                                                                                                                                                                                                                                    |
|                           | \$time        |           | Observation time in relative decimal hours                                                                                                                                                                                                                                                                |
|                           | \$obs         |           | Observation                                                                                                                                                                                                                                                                                               |
|                           | \$cens        |           | If any observation is censored (bloq, aloq) or none.                                                                                                                                                                                                                                                      |
|                           | \$pred        |           | Predicted value                                                                                                                                                                                                                                                                                           |
|                           | \$pred.type   |           | Type of prediction, i.e. based on the population parameter values or Bayesian posterior parameter values                                                                                                                                                                                                  |
|                           | \$icen        |           | Median (default) or mean of the parameter distributions used to calculate the predicted values.                                                                                                                                                                                                           |
|                           | \$outeq       |           | Output equation number                                                                                                                                                                                                                                                                                    |
|                           | \$block       |           | Dosing block, usually 1 unless data file contains EVID=4 dose reset events, in which case each such reset within a given ID will increment the dosing block by 1 for that ID                                                                                                                              |
|                           | \$obsSD       |           | Calculated standard deviation (error) of the observation based on the assay error polynomial                                                                                                                                                                                                              |
|                           | \$d           |           | Difference between pred and obs                                                                                                                                                                                                                                                                           |
|                           | \$ds          |           | Squared difference between pred and obs                                                                                                                                                                                                                                                                   |
|                           | \$wd          |           | \\d, weighted by the \\obsSD                                                                                                                                                                                                                                                                              |
|                           | \$wds         |           | \\ds, weighted by the \\obsSD                                                                                                                                                                                                                                                                             |
|                           | \$data        |           | All of the above fields as a single data frame                                                                                                                                                                                                                                                            |
|                           |               | \$plot    | See plot.PMop for details                                                                                                                                                                                                                                                                                 |
|                           |               | \$summary | See summary.PMop for details                                                                                                                                                                                                                                                                              |
|                           |               | \$auc     | See makeAUC for details                                                                                                                                                                                                                                                                                   |
| \$final (class: PM_final) | \$popPoints   |           | (NPAG only) Data frame of the final cycle joint population density of grid points with column names equal to the name of each random parameter plus \\prob for the associated probability of that point                                                                                                   |
|                           | \$popMean     |           | The final cycle mean for each random parameter distribution                                                                                                                                                                                                                                               |
|                           | \$popSD       |           | The final cycle standard deviation for each random parameter distribution                                                                                                                                                                                                                                 |
|                           | \$popCV       |           | The final cycle coefficient of variation for each random parameter distribution                                                                                                                                                                                                                           |
|                           | \$popVar      |           | The final cycle variance for each random parameter distribution                                                                                                                                                                                                                                           |
|                           | \$popCov      |           | The final cycle covariance matrix for each random parameter distribution                                                                                                                                                                                                                                  |
|                           | \$popCor      |           | The final cycle correlation matrix for each random parameter distribution                                                                                                                                                                                                                                 |
|                           | \$popMedian   |           | The final cycle median for each random parameter distribution                                                                                                                                                                                                                                             |
|                           | \$popRanFix   |           | The final cycle values for all fixed but random parameters                                                                                                                                                                                                                                                |
|                           | \$postPoints  |           | (NPAG only) Data frame of the Bayesian posterior parameter points for each of the first 100 subjects, with the following columns:                                                                                                                                                                         |
|                           |               |           | id: subject ID                                                                                                                                                                                                                                                                                            |
|                           |               |           | point: point number for that subject                                                                                                                                                                                                                                                                      |
|                           |               |           | parameters: parameters in the model                                                                                                                                                                                                                                                                       |
|                           |               |           | prob: probability of each point in the posterior for each patient                                                                                                                                                                                                                                         |
|                           | \$postMean    |           | A matrix of means of posterior distributions for each subject and parameter                                                                                                                                                                                                                               |
|                           | \$postSD      |           | A matrix of SDs of posterior distributions for each subject and parameter                                                                                                                                                                                                                                 |
|                           | \$postVar     |           | A matrix of variances of posterior distributions for each subject and parameter                                                                                                                                                                                                                           |
|                           | \$postCov     |           | An array of covariance matrices for posterior parameter values for each subject                                                                                                                                                                                                                           |
|                           | \$postCor     |           | An array of correlation matrices for posterior parameter values for each subject                                                                                                                                                                                                                          |
|                           | \$gridpts     |           | (NPAG only) The initial number of support points                                                                                                                                                                                                                                                          |
|                           | \$ab          |           | Matrix of boundaries for random parameter values. For NPAG, this is specified by the user prior to the run; for IT2B, it is calculated as a user specified multiple of the SD for the parameter value distribution                                                                                        |
|                           | \$data        |           | All of the above fields as a single list                                                                                                                                                                                                                                                                  |
|                           |               | \$plot    | See plot.PMfinal for details                                                                                                                                                                                                                                                                              |
|                           |               | \$summary | See summary.PMfinal for details                                                                                                                                                                                                                                                                           |
| \$cycle (class: PM_cycle) | \$names       |           | Vector of names of the random parameters                                                                                                                                                                                                                                                                  |
|                           | \$ll          |           | Matrix of cycle number and -2\*Log-likelihood at each cycle                                                                                                                                                                                                                                               |
|                           | \$gamlam      |           | A matrix of cycle number and gamma or lambda at each cycle (see item \#16 under NPAG Runs below for a discussion of gamma and lambda)                                                                                                                                                                     |
|                           | \$mean        |           | A matrix of cycle number and the mean of each random parameter at each cycle, normalized to initial mean                                                                                                                                                                                                  |
|                           | \$sd          |           | A matrix of cycle number and the standard deviation of each random parameter at each cycle, normalized to initial standard deviation                                                                                                                                                                      |
|                           | \$median      |           | A matrix of cycle number and the median of each random parameter at each cycle, normalized to initial standard deviation                                                                                                                                                                                  |
|                           | \$aic         |           | A matrix of cycle number and Akaike Information Criterion at each cycle                                                                                                                                                                                                                                   |
|                           | \$bic         |           | A matrix of cycle number and Bayesian (Schwartz) Information Criterion at each cycle                                                                                                                                                                                                                      |
|                           | \$data        |           | All of the above fields as a single list                                                                                                                                                                                                                                                                  |
|                           |               | \$plot    | See plot.PMcycle for details                                                                                                                                                                                                                                                                              |
| \$cov (class: PM_cov)     | \$id          |           | Subject identification                                                                                                                                                                                                                                                                                    |
|                           | \$time        |           | Time for each covariate entry                                                                                                                                                                                                                                                                             |
|                           | covariates... |           | Covariate values for each subject at each time, extracted from the raw data file                                                                                                                                                                                                                          |
|                           | parameters... |           | Mean, median, or mode of Bayesian posterior distribution for each random parameter in the model. Mode summaries are available for NPAG output only, and the default is median. Values are recycled for each row within a given subject, with the number of rows driven by the number of covariate entries |
|                           | \$icen        |           | Median (default) or mean of the covariates and parameter value distributions.                                                                                                                                                                                                                             |
|                           | \$data        |           | All of the above fields as a single list                                                                                                                                                                                                                                                                  |
|                           |               | \$plot    | See plot.PMcov for details                                                                                                                                                                                                                                                                                |
|                           |               | \$summary | See summary.PMcov for details                                                                                                                                                                                                                                                                             |
| \$pop (class: PM_pop)     | \$id          |           | Subject identification                                                                                                                                                                                                                                                                                    |
| \$post (class: PM_post)   | \$time        |           | Time of each prediction at a frequency specified in the NPrun() command, with a default of 12 minutes.                                                                                                                                                                                                    |
| (NPAG only)               | \$icen        |           | Median (default) or mean of the parameter distributions used to calculate the predicted values.                                                                                                                                                                                                           |
|                           | \$pred        |           | Population prior (PMpop) or Bayesian posterior (PMpost) predictions for each output equation                                                                                                                                                                                                              |
|                           | \$outeq       |           | Output equation for each prediction                                                                                                                                                                                                                                                                       |
|                           | \$block       |           | Same as for PMop objects above                                                                                                                                                                                                                                                                            |
|                           |               | \$auc     | See makeAUC for details                                                                                                                                                                                                                                                                                   |
|                           |               | \$nca     | See makeNCA for details                                                                                                                                                                                                                                                                                   |
| \$data (class: PM_data)   |               |           | Your original raw data object , see PM_data for details                                                                                                                                                                                                                                                   |
| \$model (class: PM_model) |               |           | Your original model object, see PM_model for details                                                                                                                                                                                                                                                      |
| \$errfile                 |               |           | Name of error file if it exists                                                                                                                                                                                                                                                                           |
| \$success                 |               |           | Boolean for successful run                                                                                                                                                                                                                                                                                |

To access the fields in a `PM_result` object, use the “\$”.

``` r
res1 <- PM_load(1)
res1$op
res1$op$time
res1$op$data # this accesses the whole observed vs. predicted raw data frame
```

Most of the fields are themselves R6 objects with methods.

``` r
res1 <- PM_load(1)
res1$op
res1$op$summary()
res1$op$plot()
```

The `PM_result` object also contains several methods. The table below
lists these methods (functions) and their descriptions.

| Methods    | Comments                                                                                                                            |
|------------|-------------------------------------------------------------------------------------------------------------------------------------|
| \$new      | This method is not called directly, but new PM_result objects are created using PM_load()                                           |
| \$plot     | Alternative method to plot objects, e.g. PM_result\$plot("op") = PM_result\$op\$plot() = plot(PM_result\$op)                        |
| \$summary  | Alternative method to summarize objects, e.g. PM_result\$summary("final") = PM_result\$final\$summary() = summary(PM_result\$final) |
| \$fit      | Fit data using the model in the PM_result object                                                                                    |
| \$auc      | Calculate auc by supplying a src, e.g. PM_result\$auc("op")                                                                         |
| \$report   | Regenerate the report                                                                                                               |
| \$sim      | Simulate using the model in the PM_result object                                                                                    |
| \$save     | Save the PM_result object                                                                                                           |
| \$validate | Validate by simuation to create VPC or NPDE as a PM_valid object                                                                    |
| \$step     | Stepwise forward/backward linear regression between covariates and model parameter values                                           |
| \$opt      | Optimal sampling to create a PM_opt object                                                                                          |
